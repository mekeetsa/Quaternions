(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    154908,       3507]
NotebookOptionsPosition[    149429,       3321]
NotebookOutlinePosition[    150142,       3349]
CellTagsIndexPosition[    150064,       3344]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Rigid Body Motion in 3D", "Title",
 CellChangeTimes->{{3.5434118480625*^9, 3.54341185275*^9}, {
  3.543413773515625*^9, 3.543413778109375*^9}, {3.5434989699375*^9, 
  3.543499005359375*^9}, {3.543501835671875*^9, 3.54350183959375*^9}, {
  3.543504440765625*^9, 3.54350444090625*^9}, {3.543549277953125*^9, 
  3.543549280203125*^9}, {3.543928224140625*^9, 3.543928248984375*^9}, {
  3.5439975569375*^9, 3.543997560421875*^9}, {3.54402426096875*^9, 
  3.54402428109375*^9}}],

Cell["\<\
Mikica B Kocic,
The Physics of Virtual Environments, 2012-04-25\
\>", "Text",
 CellChangeTimes->{{3.543871748359375*^9, 3.543871773359375*^9}, 
   3.543904564828125*^9, {3.543910645453125*^9, 3.54391067640625*^9}, {
   3.543910742640625*^9, 3.543910748265625*^9}, {3.54398828440625*^9, 
   3.543988291421875*^9}, 3.544099287734375*^9, {3.544204265328125*^9, 
   3.544204265453125*^9}, {3.54420429553125*^9, 3.544204315265625*^9}, {
   3.544371348265625*^9, 3.54437134834375*^9}, {3.570688632625*^9, 
   3.570688634953125*^9}},
 TextAlignment->Center],

Cell[CellGroupData[{

Cell["Definitions", "Section",
 CellChangeTimes->{{3.5434118480625*^9, 3.54341185275*^9}, {
  3.543413773515625*^9, 3.543413778109375*^9}, {3.54346972865625*^9, 
  3.543469756671875*^9}, {3.54349188053125*^9, 3.543491928125*^9}, {
  3.5435044021875*^9, 3.543504434765625*^9}, {3.54355566815625*^9, 
  3.543555692671875*^9}, {3.543605563375*^9, 3.543605567984375*^9}, {
  3.544028791453125*^9, 3.544028792703125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", " ", 
   RowBox[{"\"\<Quat.m\>\"", ",", 
    RowBox[{"Path", "->", 
     RowBox[{"{", " ", 
      RowBox[{"NotebookDirectory", " ", "[", "]"}], "  ", "}"}]}]}], " ", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.54354933078125*^9, 3.543549419359375*^9}, {
   3.543554802265625*^9, 3.543554832015625*^9}, 3.543555675484375*^9, {
   3.54358852940625*^9, 3.54358853284375*^9}, {3.54359526196875*^9, 
   3.54359526215625*^9}}],

Cell[CellGroupData[{

Cell["Parameters", "Subsection",
 CellChangeTimes->{{3.543578316765625*^9, 3.543578396*^9}, {
  3.543579634015625*^9, 3.54357963603125*^9}, {3.5435865389375*^9, 
  3.54358655478125*^9}, {3.543599423484375*^9, 3.543599450234375*^9}, {
  3.543605273546875*^9, 3.543605274796875*^9}, {3.54360553734375*^9, 
  3.54360553825*^9}}],

Cell["Frame of reference", "Subsubsection",
 CellChangeTimes->{{3.543578316765625*^9, 3.543578358515625*^9}, {
  3.543586560796875*^9, 3.5435865656875*^9}, {3.543605337171875*^9, 
  3.54360534621875*^9}, {3.54360707578125*^9, 3.543607080734375*^9}, {
  3.5440273645*^9, 3.5440273666875*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "The flag ",
 StyleBox["frameOfRef", "Output",
  FontWeight->"Bold"],
 " indicates whether angular velocity ",
 StyleBox["\[Omega]",
  FontWeight->"Bold"],
 ", angular momentum ",
 StyleBox["L",
  FontWeight->"Bold"],
 " and moment of inertia tensor ",
 StyleBox["\[ScriptCapitalJ]",
  FontWeight->"Bold"],
 " are given with coordinates either in ",
 StyleBox["inertial",
  FontWeight->"Bold"],
 " (also called ",
 StyleBox["space",
  FontWeight->"Bold"],
 " or ",
 StyleBox["world",
  FontWeight->"Bold"],
 ") frame of reference or in ",
 StyleBox["non-inertial",
  FontWeight->"Bold"],
 " (also called ",
 StyleBox["body-fixed",
  FontWeight->"Bold"],
 " or ",
 StyleBox["rotating",
  FontWeight->"Bold"],
 ") frame of reference."
}], "TextGroup",
 CellChangeTimes->{{3.543578316765625*^9, 3.54357838*^9}, {
   3.543580359390625*^9, 3.543580373765625*^9}, {3.543642262234375*^9, 
   3.543642316015625*^9}, 3.543928845703125*^9, {3.54392894646875*^9, 
   3.543928949546875*^9}, 3.543938692734375*^9, {3.543998757*^9, 
   3.543998783890625*^9}, {3.5440129640601554`*^9, 3.5440130414820304`*^9}, {
   3.5440155446070304`*^9, 3.5440155716382804`*^9}, {3.5440157006851554`*^9, 
   3.5440157515601554`*^9}, {3.544026953625*^9, 3.54402695828125*^9}, {
   3.544027263640625*^9, 3.544027273625*^9}, {3.5440273198125*^9, 
   3.544027323671875*^9}, 3.54405599875*^9, {3.5440782159375*^9, 
   3.544078225890625*^9}, {3.544078319734375*^9, 3.54407833509375*^9}, {
   3.544078419140625*^9, 3.544078468359375*^9}, {3.5440952468125*^9, 
   3.544095258078125*^9}, {3.54409529278125*^9, 3.544095313359375*^9}, {
   3.54409548465625*^9, 3.54409551215625*^9}, {3.544096306984375*^9, 
   3.544096311890625*^9}, {3.544096346109375*^9, 3.54409634909375*^9}, {
   3.544204435953125*^9, 3.544204569625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameOfRef", " ", ":=", " ", "BodyFixed"}], ";"}]], "Input",
 CellChangeTimes->{{3.5440133748414054`*^9, 3.5440134388101554`*^9}, {
   3.5440134826070304`*^9, 3.5440134913257804`*^9}, {3.5440139332164054`*^9, 
   3.5440139419976554`*^9}, {3.5440155359976554`*^9, 3.5440155372632804`*^9}, 
   3.5440155749039054`*^9, {3.544026797640625*^9, 3.5440268058125*^9}, {
   3.544026897453125*^9, 3.54402694828125*^9}, {3.5440270078125*^9, 
   3.544027011484375*^9}, {3.544027156890625*^9, 3.5440271629375*^9}, {
   3.544027325859375*^9, 3.544027327734375*^9}, 3.544028956296875*^9, 
   3.544056471328125*^9, 3.544085134734375*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Inertial", "   ", "=."}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"inertial", " ", 
    RowBox[{"(", 
     RowBox[{"or", " ", "world"}], ")"}], " ", "frame", " ", "of", " ", 
    "reference"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BodyFixed", " ", "=."}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"non", "-", 
    RowBox[{"inertial", " ", 
     RowBox[{"(", 
      RowBox[{"or", " ", "rotating"}], ")"}], " ", "frame", " ", "of", " ", 
     "reference"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5440133748414054`*^9, 3.5440134388101554`*^9}, {
   3.5440134826070304`*^9, 3.5440134913257804`*^9}, {3.5440139332164054`*^9, 
   3.5440139419976554`*^9}, {3.5440155359976554`*^9, 3.5440155372632804`*^9}, 
   3.5440155749039054`*^9, {3.544026797640625*^9, 3.5440268058125*^9}, {
   3.544026897453125*^9, 3.54402694828125*^9}, {3.5440270078125*^9, 
   3.544027011484375*^9}, {3.544027156890625*^9, 3.5440271629375*^9}, {
   3.544027325859375*^9, 3.544027327734375*^9}, 3.544028956296875*^9, {
   3.544085145921875*^9, 3.5440851671875*^9}, {3.5440852124375*^9, 
   3.544085271703125*^9}, {3.544085621953125*^9, 3.544085652390625*^9}, {
   3.54408570515625*^9, 3.5440857090625*^9}, {3.54420433478125*^9, 
   3.54420442659375*^9}, {3.54420458809375*^9, 3.54420463771875*^9}}],

Cell["\<\
Other physical quantities like position, velocity, forces or torque, are \
always given in inertial frame of reference.\
\>", "Text",
 CellChangeTimes->{{3.544078244953125*^9, 3.544078308234375*^9}, {
  3.544078372328125*^9, 3.54407839115625*^9}, {3.544321314140625*^9, 
  3.5443213170625*^9}}]
}, Open  ]],

Cell["Gyroscopic effects", "Subsubsection",
 CellChangeTimes->{{3.543578316765625*^9, 3.543578358515625*^9}, {
  3.543586560796875*^9, 3.5435865656875*^9}, {3.543605337171875*^9, 
  3.54360534621875*^9}, {3.54360707578125*^9, 3.543607080734375*^9}, {
  3.5440273645*^9, 3.544027379984375*^9}, {3.544028940984375*^9, 
  3.544028941828125*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "The flag ",
 StyleBox["gyroEffects", "Output",
  FontWeight->"Bold"],
 " indicates whether to ",
 StyleBox["include",
  FontSlant->"Italic"],
 " or ",
 StyleBox["ignore",
  FontSlant->"Italic"],
 " gyroscopic effect when calculating the time derivative of the angular \
momentum."
}], "TextGroup",
 CellChangeTimes->{{3.543578316765625*^9, 3.54357838*^9}, {
   3.543580359390625*^9, 3.543580373765625*^9}, {3.543642262234375*^9, 
   3.543642316015625*^9}, 3.543928845703125*^9, {3.54392894646875*^9, 
   3.543928949546875*^9}, 3.543938692734375*^9, {3.543998757*^9, 
   3.543998783890625*^9}, {3.5440129640601554`*^9, 3.5440130414820304`*^9}, {
   3.5440155446070304`*^9, 3.5440155912476554`*^9}, {3.5440156508570304`*^9, 
   3.5440156607476554`*^9}, {3.5440157024976554`*^9, 3.5440157492164054`*^9}, 
   3.544026968375*^9, {3.544026998625*^9, 3.54402699978125*^9}, {
   3.544027388703125*^9, 3.544027393*^9}, 3.544029809390625*^9, {
   3.5440953523125*^9, 3.54409536146875*^9}, {3.5440954929375*^9, 
   3.544095514953125*^9}, {3.54409631790625*^9, 3.544096325421875*^9}, {
   3.54409635728125*^9, 3.5440963620625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox["gyroEffects", "Output"], 
   StyleBox[" ", "Output"], 
   StyleBox[":=", "Output"], 
   StyleBox[" ", "Output"], "Include"}], ";"}]], "Input",
 CellChangeTimes->{{3.5440133748414054`*^9, 3.5440134388101554`*^9}, {
   3.5440134826070304`*^9, 3.5440134913257804`*^9}, {3.5440139332164054`*^9, 
   3.5440139419976554`*^9}, {3.5440155359976554`*^9, 3.5440155372632804`*^9}, 
   3.5440155749039054`*^9, {3.544026809078125*^9, 3.544026841109375*^9}, {
   3.54402697153125*^9, 3.5440269929375*^9}, {3.5440271390625*^9, 
   3.544027153796875*^9}, {3.544027395015625*^9, 3.54402739978125*^9}, 
   3.544028957796875*^9, 3.5440298090625*^9, {3.544085117046875*^9, 
   3.544085127765625*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Include", " ", "=."}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"include", " ", "gyroscopic", " ", "effects"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ignore", "   ", "=."}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"don", "'"}], "t", " ", "account", " ", "gyroscopic", " ", 
    "effects"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5440133748414054`*^9, 3.5440134388101554`*^9}, {
   3.5440134826070304`*^9, 3.5440134913257804`*^9}, {3.5440139332164054`*^9, 
   3.5440139419976554`*^9}, {3.5440155359976554`*^9, 3.5440155372632804`*^9}, 
   3.5440155749039054`*^9, {3.544026809078125*^9, 3.544026841109375*^9}, {
   3.54402697153125*^9, 3.5440269929375*^9}, {3.5440271390625*^9, 
   3.544027153796875*^9}, {3.544027395015625*^9, 3.54402739978125*^9}, 
   3.544028957796875*^9, {3.544085170453125*^9, 3.544085200359375*^9}, {
   3.54408563765625*^9, 3.544085645125*^9}, {3.544085726453125*^9, 
   3.544085731609375*^9}}]
}, Open  ]],

Cell["Physical constants", "Subsubsection",
 CellChangeTimes->{{3.543578316765625*^9, 3.543578358515625*^9}, {
   3.543586560796875*^9, 3.5435865656875*^9}, {3.543605337171875*^9, 
   3.54360534621875*^9}, {3.54360707578125*^9, 3.543607080734375*^9}, 
   3.544027415703125*^9}],

Cell[CellGroupData[{

Cell[TextData[{
 "Gravitational acceleration ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold",
     FontSlant->"Plain"], 
    StyleBox["n",
     FontSlant->"Plain"]], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"kg", " ", 
    StyleBox["m",
     FontSlant->"Plain"], " ", 
    SuperscriptBox[
     StyleBox["s",
      FontSlant->"Plain"], 
     RowBox[{"-", "2"}]]}], TraditionalForm]]],
 " "
}], "TextGroup",
 CellChangeTimes->{{3.54359933203125*^9, 3.543599346171875*^9}, {
  3.543647027921875*^9, 3.5436470684375*^9}, {3.543647137875*^9, 
  3.543647156546875*^9}, {3.54365122009375*^9, 3.543651244453125*^9}, {
  3.5440157664507804`*^9, 3.5440157885914054`*^9}, {3.544095449703125*^9, 
  3.544095462765625*^9}, {3.544095665*^9, 3.54409567346875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptG]n", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "9.81"}]}], " ", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5435711965625*^9, 3.543571311390625*^9}, {
   3.543571480046875*^9, 3.543571527765625*^9}, {3.54357160790625*^9, 
   3.543571615359375*^9}, {3.543571682921875*^9, 3.543571693625*^9}, {
   3.543571780890625*^9, 3.5435717978125*^9}, {3.543571872671875*^9, 
   3.543571893125*^9}, {3.543572116828125*^9, 3.54357212071875*^9}, {
   3.54357288971875*^9, 3.543572890390625*^9}, {3.543572922859375*^9, 
   3.543572928359375*^9}, {3.54357304321875*^9, 3.54357305146875*^9}, {
   3.543579554671875*^9, 3.543579555984375*^9}, {3.54357967378125*^9, 
   3.5435796746875*^9}, 3.543586487296875*^9, {3.543587203203125*^9, 
   3.543587204015625*^9}, 3.543589587046875*^9, {3.543596363609375*^9, 
   3.54359636565625*^9}, {3.54365099246875*^9, 3.5436509951875*^9}, 
   3.54365121146875*^9, {3.5439260869375*^9, 3.543926087515625*^9}, {
   3.5440130674507804`*^9, 3.5440131319976554`*^9}, 3.5440157655914054`*^9, {
   3.5440157973570304`*^9, 3.5440157984195304`*^9}, {3.54407818784375*^9, 
   3.544078190171875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Characteristic dimension \[ScriptL] of the system, m\
\>", "TextGroup",
 CellChangeTimes->{{3.54359933203125*^9, 3.543599346171875*^9}, {
  3.543647027921875*^9, 3.5436470684375*^9}, {3.543647137875*^9, 
  3.543647156546875*^9}, {3.54365122009375*^9, 3.54365122775*^9}, {
  3.5440158008257804`*^9, 3.5440158010914054`*^9}, {3.544095684203125*^9, 
  3.544095694015625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptL]", " ", "=", " ", "10"}], ";"}]], "Input",
 CellChangeTimes->{{3.5435711965625*^9, 3.543571311390625*^9}, {
   3.543571480046875*^9, 3.543571527765625*^9}, {3.54357160790625*^9, 
   3.543571615359375*^9}, {3.543571682921875*^9, 3.543571693625*^9}, {
   3.543571780890625*^9, 3.5435717978125*^9}, {3.543571872671875*^9, 
   3.543571893125*^9}, {3.543572116828125*^9, 3.54357212071875*^9}, {
   3.54357288971875*^9, 3.543572890390625*^9}, {3.543572922859375*^9, 
   3.543572928359375*^9}, {3.54357304321875*^9, 3.54357305146875*^9}, {
   3.543579554671875*^9, 3.543579555984375*^9}, {3.54357967378125*^9, 
   3.5435796746875*^9}, 3.543586487296875*^9, {3.543587203203125*^9, 
   3.543587204015625*^9}, 3.543589587046875*^9, {3.543596363609375*^9, 
   3.54359636565625*^9}, {3.54365099246875*^9, 3.5436509951875*^9}, 
   3.54365121146875*^9, {3.5440130923257804`*^9, 3.5440130928257804`*^9}, {
   3.5440131394664054`*^9, 3.5440131416382804`*^9}, {3.5440158037632804`*^9, 
   3.5440158050289054`*^9}, {3.54402448878125*^9, 3.544024494625*^9}}]
}, Open  ]],

Cell["Rigid body parameters", "Subsubsection",
 CellChangeTimes->{{3.543578316765625*^9, 3.543578396*^9}, {
  3.543579634015625*^9, 3.54357963603125*^9}, {3.5435865389375*^9, 
  3.54358655478125*^9}, {3.5436053205*^9, 3.54360533071875*^9}, {
  3.5436070625*^9, 3.543607065*^9}, {3.544025805953125*^9, 
  3.544025809703125*^9}, {3.5440274314375*^9, 3.544027466421875*^9}, {
  3.544201822125*^9, 3.544201844078125*^9}, {3.544203834625*^9, 
  3.54420383496875*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Rigid body is defined by its mass ",
 StyleBox["m",
  FontSlant->"Italic"],
 ", a graphics complex ",
 StyleBox["{body$v,body$i}", "Output"],
 " with centroid coordinates of the body vertices in the body-fixed frame of \
reference, and principal moment of inertia tensor ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["\[ScriptCapitalJ]",
     FontWeight->"Bold"], "0"], TraditionalForm]]],
 " and its inverse ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["\[ScriptCapitalJ]",
      FontWeight->"Bold"], 
     RowBox[{"0", ",", "inv"}]], " ", "\[Equal]", " ", 
    SuperscriptBox[
     SubscriptBox[
      StyleBox["\[ScriptCapitalJ]",
       FontWeight->"Bold"], "0"], 
     RowBox[{"-", "1"}]]}], TraditionalForm]]],
 ". \nFor more info about graphics complex, see:  ",
 ButtonBox["http://reference.wolfram.com/mathematica/ref/GraphicsComplex.\
html",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/GraphicsComplex.html"], 
    None}]
}], "TextGroup",
 CellChangeTimes->{{3.54359933203125*^9, 3.5435993334375*^9}, {
   3.543647161671875*^9, 3.543647166828125*^9}, {3.5440158619820304`*^9, 
   3.5440158623726554`*^9}, {3.544027501171875*^9, 3.544027541765625*^9}, {
   3.5440276665*^9, 3.544028120828125*^9}, 3.544095709109375*^9, {
   3.544203117015625*^9, 3.5442034085625*^9}, {3.544277749828125*^9, 
   3.5442777559375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"setupBodyShape", "[", " ", 
   RowBox[{"mass_", ",", " ", 
    RowBox[{"{", " ", 
     RowBox[{"width_", ",", " ", "height_", ",", " ", "depth_"}], " ", "}"}], 
    ",", "type_"}], " ", "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"Module", " ", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", " ", "faces", " ", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Body", " ", "mass"}], ",", " ", "kg"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"m", " ", "=", " ", "mass"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Body", " ", "dimensions"}], ",", " ", "m"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{"a", ",", "b", ",", "c"}], " ", "}"}], "=", 
      RowBox[{"{", " ", 
       RowBox[{"width", ",", "height", ",", "depth"}], " ", "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Get", " ", "graphic", " ", "complex", " ", "of", " ", "the", " ", 
       "body"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", " ", "faces", " ", "}"}], "=", 
      RowBox[{"PolyhedronData", "[", " ", 
       RowBox[{"type", ",", " ", "\"\<Faces\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Rescale", " ", "graphic", " ", "complex", " ", "according", " ", "to", 
       " ", "specified", " ", "dimensions"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"body$v", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{"#", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], ")"}], "&"}], "/@", 
       RowBox[{"faces", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"body$i", "=", 
      RowBox[{"faces", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Moment", " ", "of", " ", "inertia", " ", "and", " ", "its", " ", 
       "inverse"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalJ]0", "=", 
      RowBox[{
       RowBox[{
        FractionBox["m", "12"], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{
             SuperscriptBox["b", "2"], "+", 
             SuperscriptBox["c", "2"]}], "0", "0"},
           {"0", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             SuperscriptBox["c", "2"]}], "0"},
           {"0", "0", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             SuperscriptBox["b", "2"]}]}
          }], "\[NoBreak]", ")"}]}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalJ]0inv", "=", " ", 
      RowBox[{"Inverse", "[", " ", "\[ScriptCapitalJ]0", " ", "]"}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.544202817640625*^9, 3.54420297325*^9}, {
  3.544203008859375*^9, 3.544203009015625*^9}, {3.544203453640625*^9, 
  3.54420356275*^9}, {3.54420363525*^9, 3.54420363971875*^9}, {
  3.544203759828125*^9, 3.5442037723125*^9}, {3.544203976921875*^9, 
  3.544204015484375*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Now define initial rigid body (a cube having 1 kg mass)\
\>", "TextGroup",
 CellChangeTimes->{{3.54359933203125*^9, 3.5435993334375*^9}, {
  3.543647161671875*^9, 3.543647166828125*^9}, {3.5440158619820304`*^9, 
  3.5440158623726554`*^9}, {3.544203841671875*^9, 3.544203862140625*^9}, {
  3.544204031796875*^9, 3.54420409253125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"setupBodyShape", "[", " ", 
   RowBox[{"1", ",", 
    RowBox[{"{", " ", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", "\"\<Cuboid\>\""}], " ", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5435711965625*^9, 3.543571311390625*^9}, {
   3.543571480046875*^9, 3.543571527765625*^9}, {3.54357160790625*^9, 
   3.543571615359375*^9}, {3.543571682921875*^9, 3.543571693625*^9}, {
   3.543571780890625*^9, 3.5435717978125*^9}, {3.543571872671875*^9, 
   3.543571893125*^9}, {3.543572116828125*^9, 3.54357212071875*^9}, {
   3.54357288971875*^9, 3.543572890390625*^9}, {3.543572922859375*^9, 
   3.543572928359375*^9}, {3.54357304321875*^9, 3.54357304903125*^9}, 
   3.543599266015625*^9, {3.5440131915757804`*^9, 3.5440131963726554`*^9}, 
   3.5440158655289054`*^9, {3.54405649140625*^9, 3.544056494296875*^9}, 
   3.54420305121875*^9, {3.54420341946875*^9, 3.544203488734375*^9}, {
   3.54420356584375*^9, 3.544203622921875*^9}, {3.54420365809375*^9, 
   3.544203662796875*^9}, {3.544203694609375*^9, 3.544203712640625*^9}, {
   3.544203812296875*^9, 3.54420381571875*^9}, {3.544203870265625*^9, 
   3.544203872359375*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Initial state variables: position, orientation, linear and angular \
velocity. All variables, except angular velocity, are given in inertial \
(world) frame of reference. Angular velocity frame of reference depends on \
the ",
 StyleBox["frameOfRef", "Output"],
 " flag."
}], "TextGroup",
 CellChangeTimes->{{3.54359933203125*^9, 3.54359941125*^9}, {
  3.5436008858125*^9, 3.543600888640625*^9}, {3.5436054768125*^9, 
  3.54360547790625*^9}, {3.54364708334375*^9, 3.543647123734375*^9}, {
  3.54364717509375*^9, 3.54364717784375*^9}, {3.5440158738101554`*^9, 
  3.5440158957632804`*^9}, {3.544025928*^9, 3.54402595009375*^9}, {
  3.54402599446875*^9, 3.544026143328125*^9}, {3.544027028875*^9, 
  3.54402703471875*^9}, {3.544027328828125*^9, 3.5440273309375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"X0", "=", 
   RowBox[{"{", " ", 
    RowBox[{"0", ",", "0", ",", "0"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q0", "=", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V0", "=", 
   RowBox[{"{", " ", 
    RowBox[{"0", ",", "0", ",", "0"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]0", "=", 
   RowBox[{"{", " ", 
    RowBox[{"0", ",", "0", ",", "0"}], " ", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.543599171328125*^9, 3.543599210140625*^9}, {
   3.54359941365625*^9, 3.5435994158125*^9}, {3.543599763140625*^9, 
   3.54359976803125*^9}, {3.543599802296875*^9, 3.543599809421875*^9}, {
   3.5435998805*^9, 3.54359995446875*^9}, {3.543599993375*^9, 
   3.543599998734375*^9}, {3.543600862078125*^9, 3.543600879609375*^9}, {
   3.543604622125*^9, 3.54360462421875*^9}, {3.5436436418125*^9, 
   3.54364364640625*^9}, 3.543928869375*^9, {3.5439387175*^9, 
   3.543938717671875*^9}, {3.543995909328125*^9, 3.543995934765625*^9}, {
   3.544025951234375*^9, 3.544025991375*^9}}]
}, Open  ]],

Cell["Integration parameters", "Subsubsection",
 CellChangeTimes->{{3.543578316765625*^9, 3.543578358515625*^9}, {
  3.543586560796875*^9, 3.5435865656875*^9}, {3.543605337171875*^9, 
  3.54360534621875*^9}, {3.54360707578125*^9, 3.543607080734375*^9}, {
  3.544027415703125*^9, 3.544027425171875*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Integration method, either ",
 StyleBox["rk4$stepper", "Output",
  FontWeight->"Bold"],
 " or ",
 StyleBox["semiImplicitEuler$stepper", "Output",
  FontWeight->"Bold"]
}], "TextGroup",
 CellChangeTimes->{{3.54359933203125*^9, 3.543599346171875*^9}, {
  3.543647027921875*^9, 3.5436470684375*^9}, {3.543647137875*^9, 
  3.543647156546875*^9}, {3.54365122009375*^9, 3.54365126025*^9}, {
  3.5440157692945304`*^9, 3.5440157694664054`*^9}, {3.544082485109375*^9, 
  3.54408249371875*^9}, {3.544082563640625*^9, 3.544082591359375*^9}, {
  3.5440826261875*^9, 3.544082641875*^9}, {3.544095643203125*^9, 
  3.544095644609375*^9}, {3.5440959768125*^9, 3.54409597734375*^9}}],

Cell[BoxData[
 RowBox[{"odeIntegrator", " ", ":=", " ", "rk4$stepper"}]], "Input",
 CellChangeTimes->{{3.5435711965625*^9, 3.543571311390625*^9}, {
   3.543571480046875*^9, 3.543571527765625*^9}, {3.54357160790625*^9, 
   3.543571615359375*^9}, {3.543571682921875*^9, 3.543571693625*^9}, {
   3.543571780890625*^9, 3.5435717978125*^9}, {3.543571872671875*^9, 
   3.543571893125*^9}, {3.543572116828125*^9, 3.54357212071875*^9}, {
   3.54357288971875*^9, 3.543572890390625*^9}, {3.543572922859375*^9, 
   3.543572928359375*^9}, {3.54357304321875*^9, 3.54357305146875*^9}, {
   3.543579554671875*^9, 3.543579555984375*^9}, {3.543582365390625*^9, 
   3.54358236628125*^9}, {3.5435849876875*^9, 3.543584987875*^9}, {
   3.54358563259375*^9, 3.5435856568125*^9}, 3.543586055625*^9, {
   3.543586475796875*^9, 3.543586480078125*^9}, {3.543587166296875*^9, 
   3.543587166484375*^9}, 3.543588353703125*^9, {3.543599024328125*^9, 
   3.543599028234375*^9}, 3.543600504078125*^9, {3.5440130599195304`*^9, 
   3.5440130993414054`*^9}, {3.5440158103882804`*^9, 
   3.5440158115757804`*^9}, {3.5440824973125*^9, 3.544082552921875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Time-step length, s", "TextGroup",
 CellChangeTimes->{{3.54359933203125*^9, 3.543599346171875*^9}, {
  3.543647027921875*^9, 3.5436470684375*^9}, {3.543647137875*^9, 
  3.543647156546875*^9}, {3.54365122009375*^9, 3.54365126025*^9}, {
  3.5440157692945304`*^9, 3.5440157694664054`*^9}, {3.544095617765625*^9, 
  3.5440956243125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"h", " ", "=", " ", "0.01"}], ";"}]], "Input",
 CellChangeTimes->{{3.5435711965625*^9, 3.543571311390625*^9}, {
   3.543571480046875*^9, 3.543571527765625*^9}, {3.54357160790625*^9, 
   3.543571615359375*^9}, {3.543571682921875*^9, 3.543571693625*^9}, {
   3.543571780890625*^9, 3.5435717978125*^9}, {3.543571872671875*^9, 
   3.543571893125*^9}, {3.543572116828125*^9, 3.54357212071875*^9}, {
   3.54357288971875*^9, 3.543572890390625*^9}, {3.543572922859375*^9, 
   3.543572928359375*^9}, {3.54357304321875*^9, 3.54357305146875*^9}, {
   3.543579554671875*^9, 3.543579555984375*^9}, {3.543582365390625*^9, 
   3.54358236628125*^9}, {3.5435849876875*^9, 3.543584987875*^9}, {
   3.54358563259375*^9, 3.5435856568125*^9}, 3.543586055625*^9, {
   3.543586475796875*^9, 3.543586480078125*^9}, {3.543587166296875*^9, 
   3.543587166484375*^9}, 3.543588353703125*^9, {3.543599024328125*^9, 
   3.543599028234375*^9}, 3.543600504078125*^9, {3.5440130599195304`*^9, 
   3.5440130993414054`*^9}, {3.5440158103882804`*^9, 3.5440158115757804`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final time, s", "TextGroup",
 CellChangeTimes->{{3.54359933203125*^9, 3.543599346171875*^9}, {
  3.543647027921875*^9, 3.5436470684375*^9}, {3.543647137875*^9, 
  3.543647156546875*^9}, {3.54365122009375*^9, 3.54365126025*^9}, {
  3.5440157692945304`*^9, 3.5440157694664054`*^9}, {3.544095617765625*^9, 
  3.5440956243125*^9}, {3.54434508584375*^9, 3.544345086875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tf", " ", "=", " ", "4"}], ";"}]], "Input",
 CellChangeTimes->{{3.5435711965625*^9, 3.543571311390625*^9}, {
   3.543571480046875*^9, 3.543571527765625*^9}, {3.54357160790625*^9, 
   3.543571615359375*^9}, {3.543571682921875*^9, 3.543571693625*^9}, {
   3.543571780890625*^9, 3.5435717978125*^9}, {3.543571872671875*^9, 
   3.543571893125*^9}, {3.543572116828125*^9, 3.54357212071875*^9}, {
   3.54357288971875*^9, 3.543572890390625*^9}, {3.543572922859375*^9, 
   3.543572928359375*^9}, {3.54357304321875*^9, 3.54357305146875*^9}, {
   3.543579554671875*^9, 3.543579555984375*^9}, {3.543582365390625*^9, 
   3.54358236628125*^9}, {3.5435849876875*^9, 3.543584987875*^9}, {
   3.54358563259375*^9, 3.5435856568125*^9}, 3.543586055625*^9, {
   3.543586475796875*^9, 3.543586480078125*^9}, {3.543587166296875*^9, 
   3.543587166484375*^9}, 3.543588353703125*^9, {3.543599024328125*^9, 
   3.543599028234375*^9}, 3.543600504078125*^9, {3.5440130599195304`*^9, 
   3.5440130993414054`*^9}, {3.5440158103882804`*^9, 
   3.5440158115757804`*^9}, {3.544345089109375*^9, 3.544345090859375*^9}}]
}, Open  ]],

Cell[TextData[{
 StyleBox["Runge-Kutta 4th order method",
  FontWeight->"Bold"],
 " (",
 StyleBox["rk4$stepper", "Output"],
 ")"
}], "TextGroup",
 CellDingbat->"\[FilledSmallCircle]",
 PageBreakBelow->False,
 CellChangeTimes->{{3.543578316765625*^9, 3.543578396*^9}, {
  3.543579634015625*^9, 3.54357963603125*^9}, {3.5435865389375*^9, 
  3.54358655478125*^9}, {3.543599423484375*^9, 3.54359943925*^9}, {
  3.54402873440625*^9, 3.54402873509375*^9}, {3.54403376228125*^9, 
  3.54403377296875*^9}, {3.544042683734375*^9, 3.544042684078125*^9}, {
  3.544049526375*^9, 3.544049530578125*^9}, {3.544055497984375*^9, 
  3.54405556521875*^9}, {3.544082447078125*^9, 3.54408247159375*^9}, {
  3.544083336703125*^9, 3.544083339109375*^9}, {3.544095879796875*^9, 
  3.544095880859375*^9}, {3.544095972453125*^9, 3.54409597290625*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Classical implementation of the 4th order Runge-Kutta  integrator. See ",
 ButtonBox["http://mathworld.wolfram.com/Runge-KuttaMethod.html",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://mathworld.wolfram.com/Runge-KuttaMethod.html"], None}]
}], "TextGroup",
 PageBreakBelow->False,
 CellChangeTimes->{{3.544079432390625*^9, 3.544079483234375*^9}, {
  3.544080774265625*^9, 3.544080822109375*^9}, {3.544081049546875*^9, 
  3.544081146703125*^9}, {3.5440818483125*^9, 3.544082304171875*^9}, {
  3.5440958763125*^9, 3.544095902625*^9}, {3.544095941*^9, 
  3.54409594928125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rk4$stepper", "[", " ", 
   RowBox[{"y_", ",", " ", "h_", ",", " ", "\[Florin]_"}], " ", "]"}], " ", ":=",
   " ", 
  RowBox[{"Module", "[", " ", 
   RowBox[{
    RowBox[{"{", "k", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["k", "1"], " ", "=", " ", 
      RowBox[{"h", " ", 
       RowBox[{
        StyleBox["\[Florin]",
         FontColor->RGBColor[1, 0, 1]], "[", " ", "y", " ", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["k", "2"], " ", "=", " ", 
      RowBox[{"h", " ", 
       RowBox[{
        StyleBox["\[Florin]",
         FontColor->RGBColor[1, 0, 1]], "[", " ", 
        RowBox[{"y", "+", 
         RowBox[{
          FractionBox["1", "2"], 
          SubscriptBox["k", "1"]}]}], " ", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["k", "3"], " ", "=", " ", 
      RowBox[{"h", " ", 
       RowBox[{
        StyleBox["\[Florin]",
         FontColor->RGBColor[1, 0, 1]], "[", " ", 
        RowBox[{"y", "+", 
         RowBox[{
          FractionBox["1", "2"], 
          SubscriptBox["k", "2"]}]}], " ", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["k", "4"], " ", "=", " ", 
      RowBox[{"h", " ", 
       RowBox[{
        StyleBox["\[Florin]",
         FontColor->RGBColor[1, 0, 1]], "[", " ", 
        RowBox[{"y", "+", 
         SubscriptBox["k", "3"]}], " ", "]"}]}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y", " ", "+", 
       RowBox[{
        FractionBox["1", "6"], 
        RowBox[{"(", " ", 
         RowBox[{
          SubscriptBox["k", "1"], " ", "+", " ", 
          RowBox[{"2", 
           SubscriptBox["k", "2"]}], " ", "+", " ", 
          RowBox[{"2", 
           SubscriptBox["k", "3"]}], " ", "+", " ", 
          SubscriptBox["k", "4"]}], " ", ")"}]}]}], "  ", "//", "N"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.54403435315625*^9, 3.5440344579375*^9}, {
   3.544034564796875*^9, 3.54403460121875*^9}, {3.54403479228125*^9, 
   3.5440348780625*^9}, {3.54403500371875*^9, 3.54403500575*^9}, {
   3.544035060140625*^9, 3.54403507503125*^9}, {3.544035125796875*^9, 
   3.544035146921875*^9}, {3.5440351994375*^9, 3.544035285640625*^9}, {
   3.54403560809375*^9, 3.54403569496875*^9}, {3.5440357319375*^9, 
   3.5440357544375*^9}, {3.544035854*^9, 3.5440358665*^9}, {
   3.544036509703125*^9, 3.544036511171875*^9}, {3.54403670925*^9, 
   3.54403674215625*^9}, {3.54404204728125*^9, 3.544042081625*^9}, 
   3.544042686609375*^9, {3.544042941921875*^9, 3.544042994046875*^9}, {
   3.544043145796875*^9, 3.5440431516875*^9}, {3.544043223578125*^9, 
   3.544043235421875*^9}, {3.54404326725*^9, 3.544043358453125*^9}, {
   3.54404427696875*^9, 3.544044297484375*^9}, 3.54404462615625*^9, {
   3.544049260703125*^9, 3.544049275875*^9}, {3.544049483859375*^9, 
   3.544049516984375*^9}, {3.544049844765625*^9, 3.544049854984375*^9}, 
   3.5440499083125*^9, {3.544055524859375*^9, 3.54405552621875*^9}, {
   3.54405566284375*^9, 3.544055702828125*^9}, {3.544055792828125*^9, 
   3.544055945765625*^9}, {3.54408255509375*^9, 3.544082555265625*^9}, {
   3.544098691796875*^9, 3.54409873078125*^9}}]
}, Open  ]],

Cell[TextData[{
 StyleBox["Semi-implicit Euler method",
  FontWeight->"Bold"],
 " (",
 StyleBox["semiImplicitEuler$stepper", "Output"],
 ")"
}], "TextGroup",
 CellDingbat->"\[FilledSmallCircle]",
 PageBreakBelow->False,
 CellChangeTimes->{{3.543578316765625*^9, 3.543578396*^9}, {
  3.543579634015625*^9, 3.54357963603125*^9}, {3.5435865389375*^9, 
  3.54358655478125*^9}, {3.543599423484375*^9, 3.54359943925*^9}, {
  3.54402873440625*^9, 3.54402873509375*^9}, {3.54403376228125*^9, 
  3.54403377296875*^9}, {3.544042683734375*^9, 3.544042684078125*^9}, {
  3.544049526375*^9, 3.544049530578125*^9}, {3.544055497984375*^9, 
  3.54405556521875*^9}, {3.54407934428125*^9, 3.544079393671875*^9}, {
  3.5440814245625*^9, 3.544081425359375*^9}, {3.544082437453125*^9, 
  3.544082438953125*^9}, {3.544083342421875*^9, 3.544083347234375*^9}, {
  3.54409598046875*^9, 3.54409598096875*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "The implementation bellow is demonstrative  but very inefficient since it \
calls ODE function ",
 StyleBox["\[Florin]",
  FontWeight->"Bold"],
 " twice. The implemented algorithm also requires that the state vector ",
 StyleBox["y",
  FontWeight->"Bold"],
 " has a special structure: 1) ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "1"], TraditionalForm]]],
 " contains a time variable, 2) the time variable is followed by the ordinary \
state variables in the bottom-half and 3) the ordinary state variables are \
followed by their time derivatives in the top-half, i.e. the ",
 StyleBox["y",
  FontWeight->"Bold"],
 " should look like ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["y",
     FontWeight->"Bold",
     FontSlant->"Plain"], " ", "=", " ", 
    RowBox[{"{", " ", 
     RowBox[{"t", ",", " ", 
      StyleBox["x",
       FontWeight->"Bold",
       FontSlant->"Plain"], ",", " ", 
      StyleBox[
       OverscriptBox[
        StyleBox["x",
         FontWeight->"Bold",
         FontSlant->"Plain"], "."],
       FontWeight->"Bold",
       FontSlant->"Plain"]}], " ", "}"}]}], TraditionalForm]]],
 " and its derivative (the ODE function ",
 StyleBox["\[Florin]",
  FontWeight->"Bold"],
 ") shoold return ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox[
     OverscriptBox[
      StyleBox["y",
       FontWeight->"Bold",
       FontSlant->"Plain"], "."],
     FontWeight->"Bold",
     FontSlant->"Plain"], " ", "=", " ", 
    RowBox[{"{", " ", 
     RowBox[{"1", ",", " ", 
      StyleBox[
       OverscriptBox[
        StyleBox["x",
         FontWeight->"Bold",
         FontSlant->"Plain"], "."],
       FontWeight->"Bold",
       FontSlant->"Plain"], ",", " ", 
      StyleBox[
       OverscriptBox[
        StyleBox["x",
         FontWeight->"Bold",
         FontSlant->"Plain"], "\[DoubleDot]"],
       FontWeight->"Bold",
       FontSlant->"Plain"]}], " ", "}"}]}], TraditionalForm]]],
 " ."
}], "TextGroup",
 PageBreakBelow->False,
 CellChangeTimes->{{3.544079432390625*^9, 3.544079483234375*^9}, {
  3.544080774265625*^9, 3.544080822109375*^9}, {3.544081049546875*^9, 
  3.544081146703125*^9}, {3.5440818483125*^9, 3.544082270515625*^9}, {
  3.5440829594375*^9, 3.544083010578125*^9}, {3.544095995*^9, 
  3.54409618565625*^9}, {3.544099613609375*^9, 3.544099688828125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox["semiImplicitEuler$stepper", "Output"], "[", " ", 
   RowBox[{"y_", ",", " ", "h_", ",", " ", "\[Florin]_"}], " ", "]"}], " ", ":=",
   " ", 
  RowBox[{"Module", "[", " ", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "n", ",", "\[ScriptCapitalX]", ",", " ", "\[ScriptCapitalX]dot", ",", 
      " ", "y2"}], " ", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"Length", "[", "y", "]"}], "-", "1"}], " ", ")"}], "/", 
        "2"}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Split", " ", "y", " ", "into", " ", "bottom"}], "-", " ", 
       RowBox[{"and", " ", "top"}], "-", "halves"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalX]dot", " ", "=", " ", 
      RowBox[{"h", " ", 
       RowBox[{
        StyleBox["\[Florin]",
         FontColor->RGBColor[1, 0, 1]], "[", " ", "y", " ", "]"}]}]}], ";", 
     "   ", 
     RowBox[{"(*", " ", 
      RowBox[{"Solve", " ", "velocities", " ", "only"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalX]dot", 
       RowBox[{"\[LeftDoubleBracket]", 
        RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]], "=", "0"}], ";",
      "       ", 
     RowBox[{"(*", " ", 
      RowBox[{"disregarding", " ", "position", " ", "and", " ", "time", " ", 
       RowBox[{"solutions", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"y2", " ", "=", " ", 
      RowBox[{"y", "+", " ", "\[ScriptCapitalX]dot"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalX]", " ", "=", " ", 
      RowBox[{"h", " ", 
       RowBox[{
        StyleBox["\[Florin]",
         FontColor->RGBColor[1, 0, 1]], "[", " ", "y2", " ", "]"}]}]}], ";", 
     "       ", 
     RowBox[{"(*", " ", 
      RowBox[{"Now", ",", " ", 
       RowBox[{
       "solve", " ", "position", " ", "and", " ", "time", " ", "only"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalX]", 
       RowBox[{"\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}]], "=", 
      "0"}], ";", "           ", 
     RowBox[{"(*", " ", 
      RowBox[{"disregarding", " ", "velocity", " ", 
       RowBox[{"solution", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
     "y", " ", "+", " ", "\[ScriptCapitalX]", " ", "+", " ", 
      "\[ScriptCapitalX]dot"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.54403435315625*^9, 3.5440344579375*^9}, {
   3.544034564796875*^9, 3.54403460121875*^9}, {3.54403479228125*^9, 
   3.5440348780625*^9}, {3.54403500371875*^9, 3.54403500575*^9}, {
   3.544035060140625*^9, 3.54403507503125*^9}, {3.544035125796875*^9, 
   3.544035146921875*^9}, {3.5440351994375*^9, 3.544035285640625*^9}, {
   3.54403560809375*^9, 3.54403569496875*^9}, {3.5440357319375*^9, 
   3.5440357544375*^9}, {3.544035854*^9, 3.5440358665*^9}, {
   3.544036509703125*^9, 3.544036511171875*^9}, {3.54403670925*^9, 
   3.54403674215625*^9}, {3.54404204728125*^9, 3.544042081625*^9}, 
   3.544042686609375*^9, {3.544042941921875*^9, 3.544042994046875*^9}, {
   3.544043145796875*^9, 3.5440431516875*^9}, {3.544043223578125*^9, 
   3.544043235421875*^9}, {3.54404326725*^9, 3.544043358453125*^9}, {
   3.54404427696875*^9, 3.544044297484375*^9}, 3.54404462615625*^9, {
   3.544049260703125*^9, 3.544049275875*^9}, {3.544049483859375*^9, 
   3.544049516984375*^9}, {3.544049844765625*^9, 3.544049854984375*^9}, 
   3.5440499083125*^9, {3.544055524859375*^9, 3.54405552621875*^9}, {
   3.54405566284375*^9, 3.544055702828125*^9}, {3.544055792828125*^9, 
   3.544055945765625*^9}, {3.544079406375*^9, 3.54407942434375*^9}, {
   3.544080067890625*^9, 3.54408010040625*^9}, {3.544080165046875*^9, 
   3.544080361734375*^9}, {3.544080397046875*^9, 3.54408046653125*^9}, {
   3.544080684953125*^9, 3.54408071396875*^9}, {3.544080755984375*^9, 
   3.5440807720625*^9}, {3.544080951265625*^9, 3.54408103875*^9}, {
   3.54408118190625*^9, 3.544081274859375*^9}, {3.5440814291875*^9, 
   3.544081606890625*^9}, {3.544081645484375*^9, 3.544081749921875*^9}, {
   3.544081801875*^9, 3.544081840390625*^9}, {3.54408255796875*^9, 
   3.5440825581875*^9}, {3.544082594421875*^9, 3.544082605609375*^9}, {
   3.54408265796875*^9, 3.544082810984375*^9}, {3.5440830243125*^9, 
   3.544083103234375*^9}, {3.544083397921875*^9, 3.544083523421875*^9}, {
   3.544083652703125*^9, 3.54408366309375*^9}, {3.544083933734375*^9, 
   3.54408397209375*^9}, {3.544084026328125*^9, 3.544084027375*^9}, {
   3.544084060609375*^9, 3.544084137328125*^9}, {3.544084171234375*^9, 
   3.54408440584375*^9}, {3.544084457328125*^9, 3.5440846525625*^9}, {
   3.544096202328125*^9, 3.544096203796875*^9}, {3.54409869815625*^9, 
   3.544098720984375*^9}, {3.54409875171875*^9, 3.54409878296875*^9}, {
   3.54434591865625*^9, 3.544345978609375*^9}, {3.544346103*^9, 
   3.5443461734375*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Animation Functions", "Subsection",
 CellChangeTimes->{{3.543578316765625*^9, 3.543578396*^9}, {
  3.543579634015625*^9, 3.54357963603125*^9}, {3.5435865389375*^9, 
  3.54358655478125*^9}, {3.543599423484375*^9, 3.543599450234375*^9}, {
  3.543605273546875*^9, 3.543605274796875*^9}, {3.54360553734375*^9, 
  3.54360553825*^9}, {3.5440173752007804`*^9, 3.5440173762945304`*^9}, {
  3.5440288195625*^9, 3.544028823421875*^9}, {3.544078688046875*^9, 
  3.544078688578125*^9}}],

Cell["\<\
\[CapitalStigma]T: Transforms coordinates from body-fixed to inertial frame \
of reference\
\>", "Subsubsection",
 PageBreakBelow->False,
 CellChangeTimes->{{3.543578316765625*^9, 3.543578396*^9}, {
  3.543579634015625*^9, 3.54357963603125*^9}, {3.5435865389375*^9, 
  3.54358655478125*^9}, {3.543599423484375*^9, 3.54359942678125*^9}, {
  3.5440243999375*^9, 3.5440244008125*^9}, {3.544026417125*^9, 
  3.544026441796875*^9}, {3.544078705375*^9, 3.544078723703125*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Transformations from non-inertial body-fixed (rotational) frame to \
intertial (world) frame of reference are based on global orientation \
quaternion ",
 StyleBox["q",
  FontSlant->"Italic"],
 " (variable ",
 Cell[BoxData["Q"]],
 ") and position vector ",
 StyleBox["x",
  FontWeight->"Bold"],
 ": (variablle ",
 Cell[BoxData["X"]],
 ")"
}], "TextGroup",
 PageBreakBelow->False,
 CellChangeTimes->{{3.54407883590625*^9, 3.544078874875*^9}, {
  3.54409621575*^9, 3.544096301015625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalStigma]T", "[", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], " ", "}"}], " ", "]"}], ":=", " ", 
  RowBox[{
   StyleBox["X",
    FontColor->RGBColor[0.5, 0, 0.5]], "+", 
   RowBox[{"Im", "[", " ", 
    RowBox[{
     StyleBox["Q",
      FontColor->RGBColor[0.5, 0, 0.5]], "**", 
     RowBox[{"\[ScriptCapitalQ]", "[", 
      RowBox[{"0", ",", "x", ",", "y", ",", "z"}], "]"}], "**", 
     SuperscriptBox[
      StyleBox["Q",
       FontColor->RGBColor[0.5, 0, 0.5]], "*"]}], " ", "]"}]}]}]], "Input",
 PageBreakBelow->False,
 CellChangeTimes->{{3.54357934015625*^9, 3.543579342484375*^9}, {
   3.5435801280625*^9, 3.543580149828125*^9}, {3.543580242921875*^9, 
   3.543580346015625*^9}, {3.54358040153125*^9, 3.543580404640625*^9}, {
   3.543580554828125*^9, 3.54358067853125*^9}, {3.54359930540625*^9, 
   3.543599315875*^9}, {3.543642336375*^9, 3.543642337484375*^9}, {
   3.54364358890625*^9, 3.5436435899375*^9}, {3.543928860484375*^9, 
   3.5439288621875*^9}, {3.543929007515625*^9, 3.543929121578125*^9}, {
   3.54392923915625*^9, 3.5439292430625*^9}, {3.543929616546875*^9, 
   3.543929618140625*^9}, {3.54393869365625*^9, 3.543938694328125*^9}, {
   3.54393989103125*^9, 3.543939907609375*^9}, 3.543940196078125*^9, 
   3.543940267078125*^9, {3.543940339890625*^9, 3.543940346*^9}, {
   3.5439966191875*^9, 3.543996634359375*^9}, {3.54399669971875*^9, 
   3.5439967681875*^9}, {3.543998715546875*^9, 3.543998741546875*^9}, {
   3.54403801878125*^9, 3.5440380199375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalStigma]T", "[", " ", 
    RowBox[{"{", "}"}], " ", "]"}], " ", ":=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 PageBreakBelow->False,
 CellChangeTimes->{{3.544037847515625*^9, 3.544037850828125*^9}, {
  3.54403798509375*^9, 3.5440380028125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalStigma]T", "[", " ", 
   RowBox[{"points_", " ", "?", "MatrixQ"}], " ", "]"}], ":=", 
  RowBox[{"\[CapitalStigma]T", "/@", "points"}]}]], "Input",
 PageBreakBelow->False,
 CellChangeTimes->{{3.54357934015625*^9, 3.543579342484375*^9}, {
   3.5435801280625*^9, 3.543580149828125*^9}, {3.543580242921875*^9, 
   3.543580346015625*^9}, {3.54358040153125*^9, 3.543580404640625*^9}, {
   3.543580554828125*^9, 3.54358067853125*^9}, {3.54359930540625*^9, 
   3.543599315875*^9}, {3.543642336375*^9, 3.543642337484375*^9}, {
   3.54364358890625*^9, 3.5436435899375*^9}, {3.543928860484375*^9, 
   3.5439288621875*^9}, {3.543929007515625*^9, 3.543929121578125*^9}, {
   3.54392923915625*^9, 3.5439292430625*^9}, {3.543929616546875*^9, 
   3.543929618140625*^9}, {3.54393869365625*^9, 3.543938694328125*^9}, {
   3.54393989103125*^9, 3.543939907609375*^9}, 3.543940196078125*^9, 
   3.543940267078125*^9, {3.543940339890625*^9, 3.543940346*^9}, {
   3.543996640375*^9, 3.543996644140625*^9}, {3.5439966790625*^9, 
   3.543996713109375*^9}, {3.54399675515625*^9, 3.543996775796875*^9}, {
   3.543998116828125*^9, 3.54399811790625*^9}, {3.54399818803125*^9, 
   3.54399818959375*^9}, {3.543998252203125*^9, 3.5439982611875*^9}, {
   3.54399860803125*^9, 3.543998616203125*^9}, 3.5439986766875*^9, {
   3.5439989318125*^9, 3.543998933171875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalStigma]T", "[", " ", 
   RowBox[{"points__", " ", "?", "VectorQ"}], " ", "]"}], ":=", 
  RowBox[{"\[CapitalStigma]T", "/@", 
   RowBox[{"{", " ", 
    RowBox[{"Sequence", "[", " ", "points", " ", "]"}], " ", 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.54357934015625*^9, 3.543579342484375*^9}, {
   3.5435801280625*^9, 3.543580149828125*^9}, {3.543580242921875*^9, 
   3.543580346015625*^9}, {3.54358040153125*^9, 3.543580404640625*^9}, {
   3.543580554828125*^9, 3.54358067853125*^9}, {3.54359930540625*^9, 
   3.543599315875*^9}, {3.543642336375*^9, 3.543642337484375*^9}, {
   3.54364358890625*^9, 3.5436435899375*^9}, {3.543928860484375*^9, 
   3.5439288621875*^9}, {3.543929007515625*^9, 3.543929121578125*^9}, {
   3.54392923915625*^9, 3.5439292430625*^9}, {3.543929616546875*^9, 
   3.543929618140625*^9}, {3.54393869365625*^9, 3.543938694328125*^9}, {
   3.54393989103125*^9, 3.543939907609375*^9}, 3.543940196078125*^9, 
   3.543940267078125*^9, {3.543940339890625*^9, 3.543940346*^9}, {
   3.543996640375*^9, 3.543996644140625*^9}, {3.5439966790625*^9, 
   3.543996713109375*^9}, {3.54399675515625*^9, 3.543996775796875*^9}, {
   3.543998116828125*^9, 3.54399811790625*^9}, {3.54399818803125*^9, 
   3.54399818959375*^9}, {3.543998252203125*^9, 3.5439982611875*^9}}]
}, Open  ]],

Cell["\<\
getAnimationData: Gets coordinates of graphic primitives to be animated\
\>", "Subsubsection",
 CellChangeTimes->{{3.543578316765625*^9, 3.543578396*^9}, {
  3.543579634015625*^9, 3.54357963603125*^9}, {3.5435865389375*^9, 
  3.54358655478125*^9}, {3.5436053205*^9, 3.54360533071875*^9}, {
  3.5436070625*^9, 3.543607065*^9}, {3.5440162004351554`*^9, 
  3.5440162020914054`*^9}, {3.5440164579664054`*^9, 3.5440164593726554`*^9}, {
  3.5440173905914054`*^9, 3.5440174099351554`*^9}, {3.5440261845625*^9, 
  3.544026237734375*^9}, {3.54402814471875*^9, 3.5440281591875*^9}, {
  3.544055607359375*^9, 3.54405564865625*^9}}],

Cell[CellGroupData[{

Cell["\<\
Transforms body shape, orientation vectors and angular components into the \
inertial frame of reference\
\>", "TextGroup",
 CellChangeTimes->{{3.54359933203125*^9, 3.54359941125*^9}, {
  3.5436008858125*^9, 3.543600888640625*^9}, {3.5436054768125*^9, 
  3.54360547790625*^9}, {3.54364708334375*^9, 3.543647123734375*^9}, {
  3.54364717509375*^9, 3.54364717784375*^9}, {3.5440158738101554`*^9, 
  3.5440158957632804`*^9}, {3.5440165636226554`*^9, 3.5440166316226554`*^9}, {
  3.544026161484375*^9, 3.544026179875*^9}, {3.544026214828125*^9, 
  3.544026226015625*^9}, {3.544096383140625*^9, 3.544096383703125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getAnimationData", " ", "[", "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "1", " ", "*)"}], " ", 
   RowBox[{
    RowBox[{"\[CapitalStigma]T", "[", " ", "body$v", " ", "]"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"body", " ", "shape"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "2", " ", "*)"}], " ", "body$i", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "3", " ", "*)"}], " ", 
    RowBox[{"\[CapitalStigma]T", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "/", "2"}], ",", "0", ",", "0"}], "}"}]}], " ", "]"}], 
    ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"e1", " ", "axis"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "4", " ", "*)"}], " ", 
    RowBox[{"\[CapitalStigma]T", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"b", "/", "2"}], ",", "0"}], "}"}]}], " ", "]"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"e2", " ", "axis"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "5", " ", "*)"}], " ", 
    RowBox[{"\[CapitalStigma]T", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"c", "/", "2"}]}], "}"}]}], " ", "]"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"e3", " ", "axis"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "6", " ", "*)"}], " ", 
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}], ",", " ", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"\[Omega]", "/", "\[Omega]Scale"}]}], " ", "}"}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"else", " ", "in", " ", "body"}], "-", "fixed"}], " ", "*)"}],
       " ", 
      RowBox[{"\[CapitalStigma]T", "[", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"\[Omega]", "/", "\[Omega]Scale"}]}], " ", "]"}]}], " ", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "7", " ", "*)"}], " ", 
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}], ",", " ", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"L", "/", "LScale"}]}], " ", "}"}], ",", " ", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"else", " ", "in", " ", "body"}], "-", "fixed"}], " ", "*)"}],
       " ", 
      RowBox[{"\[CapitalStigma]T", "[", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"L", "/", "LScale"}]}], " ", "]"}]}], " ", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "8", " ", "*)"}], " ", "\[Omega]Track"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"angular", " ", "velocity", " ", "trajectory"}], " ", "*)"}], 
   "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.5440162042476554`*^9, 3.5440162284664054`*^9}, {
   3.5440163194195304`*^9, 3.5440164408726554`*^9}, {3.5440164925289054`*^9, 
   3.5440165509976554`*^9}, {3.544026389390625*^9, 3.544026408046875*^9}, {
   3.544027040109375*^9, 3.5440270500625*^9}, {3.544027287578125*^9, 
   3.544027299890625*^9}, {3.544029920234375*^9, 3.544029923625*^9}, {
   3.544037757796875*^9, 3.544037812390625*^9}, {3.544037915765625*^9, 
   3.544037930546875*^9}, {3.54403887046875*^9, 3.54403887271875*^9}, {
   3.5440389695*^9, 3.544038973609375*^9}, {3.544041187546875*^9, 
   3.544041192296875*^9}, {3.544041499234375*^9, 3.544041501828125*^9}, {
   3.544041598984375*^9, 3.544041600390625*^9}, {3.54404368575*^9, 
   3.544043734234375*^9}, {3.544046407125*^9, 3.544046432734375*^9}, 
   3.544046621*^9, {3.544047138046875*^9, 3.54404714546875*^9}, {
   3.54405079803125*^9, 3.544050800625*^9}, {3.54405505615625*^9, 
   3.544055104265625*^9}, {3.54405518303125*^9, 3.544055185296875*^9}, {
   3.544056000953125*^9, 3.544056003078125*^9}, {3.5440813990625*^9, 
   3.54408140596875*^9}, {3.544085809890625*^9, 3.544085813453125*^9}, {
   3.544278662734375*^9, 3.544278684*^9}}]
}, Open  ]],

Cell["showAnimation: Renders 3D objects from animation data", "Subsubsection",
 PageBreakBelow->False,
 CellChangeTimes->{{3.543578316765625*^9, 3.543578396*^9}, {
  3.543579634015625*^9, 3.54357963603125*^9}, {3.5435865389375*^9, 
  3.54358655478125*^9}, {3.5436053205*^9, 3.54360533071875*^9}, {
  3.5436070625*^9, 3.543607065*^9}, {3.5440162004351554`*^9, 
  3.5440162020914054`*^9}, {3.5440164579664054`*^9, 3.5440164593726554`*^9}, {
  3.5440173905914054`*^9, 3.5440174234039054`*^9}, {3.544024467671875*^9, 
  3.544024480171875*^9}, {3.54402626640625*^9, 3.544026294796875*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Displays 3D graphics dynamically retrived by ",
 StyleBox["getAnimationData", "Output"],
 " function."
}], "TextGroup",
 PageBreakBelow->False,
 CellChangeTimes->{{3.54359933203125*^9, 3.54359941125*^9}, {
  3.5436008858125*^9, 3.543600888640625*^9}, {3.5436054768125*^9, 
  3.54360547790625*^9}, {3.54364708334375*^9, 3.543647123734375*^9}, {
  3.54364717509375*^9, 3.54364717784375*^9}, {3.5440158738101554`*^9, 
  3.5440158957632804`*^9}, {3.5440165636226554`*^9, 3.5440166316226554`*^9}, {
  3.544026161484375*^9, 3.544026179875*^9}, {3.544026214828125*^9, 
  3.544026226015625*^9}, {3.544096383140625*^9, 3.544096473234375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"showAnimation", " ", "[", "]"}], ":=", 
  RowBox[{"Show", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"rigid", " ", "body"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", " ", 
      RowBox[{"Yellow", ",", 
       RowBox[{"Opacity", "[", ".2", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"GraphicsComplex", "[", " ", 
        RowBox[{
         RowBox[{"Dynamic", "[", 
          SubscriptBox["aData", 
           RowBox[{"\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]], 
          "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          SubscriptBox["aData", 
           RowBox[{"\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]], 
          "]"}]}], " ", "]"}]}], " ", "}"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["e", "^"], "1"], " ", "axis"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", " ", 
      RowBox[{"Red", ",", "Thick", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"Dynamic", "[", " ", 
         SubscriptBox["aData", 
          RowBox[{"\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]], 
         " ", "]"}], "]"}]}], " ", "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["e", "^"], "2"], " ", "axis"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", " ", 
      RowBox[{"Green", ",", "Thick", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"Dynamic", "[", " ", 
         SubscriptBox["aData", 
          RowBox[{"\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]], 
         "]"}], "]"}]}], " ", "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["e", "^"], "3"], " ", "axis"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", " ", 
      RowBox[{"Blue", ",", "Thick", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"Dynamic", "[", " ", 
         SubscriptBox["aData", 
          RowBox[{"\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]], 
         " ", "]"}], "]"}]}], " ", "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Angular", " ", "velocity", " ", "\[Omega]"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", " ", 
      RowBox[{"Black", ",", "Thick", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"Dynamic", "[", " ", 
         SubscriptBox["aData", 
          RowBox[{"\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]], 
         " ", "]"}], "]"}]}], " ", "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Angular", " ", "momentum", " ", "L"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", " ", 
      RowBox[{"Gray", ",", "Thick", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"Dynamic", "[", " ", 
         SubscriptBox["aData", 
          RowBox[{"\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]], 
         " ", "]"}], "]"}]}], " ", "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Angular", " ", "velocity", " ", "\[Omega]", " ", "trajectory"}],
      " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", " ", 
      RowBox[{"Pink", ",", "Thick", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"Dynamic", "[", " ", 
         SubscriptBox["aData", 
          RowBox[{"\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]], 
         " ", "]"}], "]"}]}], " ", "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Axes", " ", "and", " ", "plot", " ", "range"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Boxed", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", " ", 
        RowBox[{
        "\"\<\[ScriptX]\[MediumSpace]/m\>\"", ",", 
         "\"\<\[ScriptY]\[MediumSpace]/m\>\"", ",", 
         "\"\<\[ScriptZ]\[MediumSpace]/m\>\""}], " ", "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"Directive", "[", " ", 
        RowBox[{"FontSize", "\[Rule]", "12"}], " ", "]"}]}], ","}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"ViewPoint", "\[Rule]", "Front"}], ",", " ", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"Scaled", "[", " ", "0.9", " ", "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"Dynamic", "@", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[ScriptL]"}], ",", "\[ScriptL]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[ScriptL]"}], ",", "\[ScriptL]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[ScriptL]"}], ",", "\[ScriptL]"}], "}"}]}], " ", 
       "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5440172872476554`*^9, 3.5440173428101554`*^9}, {
   3.544024504796875*^9, 3.544024513734375*^9}, {3.544026261578125*^9, 
   3.54402626346875*^9}, {3.544026303953125*^9, 3.5440263809375*^9}, 
   3.54402762303125*^9, {3.54402845796875*^9, 3.544028497078125*^9}, {
   3.544028904796875*^9, 3.544028907078125*^9}, {3.54403706728125*^9, 
   3.544037067734375*^9}, {3.544037876640625*^9, 3.54403790490625*^9}, {
   3.544038215171875*^9, 3.544038219671875*^9}, {3.544039510375*^9, 
   3.544039513921875*^9}, {3.544041023203125*^9, 3.544041108625*^9}, {
   3.544041643*^9, 3.54404166390625*^9}, {3.54404174990625*^9, 
   3.54404176290625*^9}, {3.5440417978125*^9, 3.544041820390625*^9}, {
   3.54404263725*^9, 3.544042644109375*^9}, {3.54404347409375*^9, 
   3.54404350078125*^9}, {3.544050540625*^9, 3.544050548734375*^9}, {
   3.54405206453125*^9, 3.544052066875*^9}, {3.5440542629375*^9, 
   3.54405426809375*^9}, {3.54405449525*^9, 3.544054496390625*^9}, {
   3.5440551179375*^9, 3.544055129484375*^9}, 3.544055188140625*^9, 
   3.544056004203125*^9, {3.54405612321875*^9, 3.544056175234375*^9}, {
   3.544056222703125*^9, 3.54405622353125*^9}, {3.5440562795*^9, 
   3.5440562808125*^9}, {3.544096525640625*^9, 3.54409652909375*^9}}]
}, Open  ]],

Cell["snapshotVars: Gets a verbose snapshot of state variables", \
"Subsubsection",
 PageBreakBelow->False,
 CellChangeTimes->{{3.543578316765625*^9, 3.543578396*^9}, {
  3.543579634015625*^9, 3.54357963603125*^9}, {3.5435865389375*^9, 
  3.54358655478125*^9}, {3.5436053205*^9, 3.54360533071875*^9}, {
  3.5436070625*^9, 3.543607065*^9}, {3.5440162004351554`*^9, 
  3.5440162020914054`*^9}, {3.5440164579664054`*^9, 3.5440164593726554`*^9}, {
  3.5440173905914054`*^9, 3.5440174099351554`*^9}, {3.5440261845625*^9, 
  3.544026248578125*^9}, {3.544028172453125*^9, 3.544028185515625*^9}, {
  3.544055143390625*^9, 3.544055176375*^9}, {3.5440789939375*^9, 
  3.544079003671875*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Dumps all variables for debugging purposes. Usage: evaluate expression ",
 StyleBox["Dynamic@snapshotVars[]", "Output"],
 " to get real-time update."
}], "TextGroup",
 PageBreakBelow->False,
 CellChangeTimes->{{3.54359933203125*^9, 3.54359941125*^9}, {
  3.5436008858125*^9, 3.543600888640625*^9}, {3.5436054768125*^9, 
  3.54360547790625*^9}, {3.54364708334375*^9, 3.543647123734375*^9}, {
  3.54364717509375*^9, 3.54364717784375*^9}, {3.5440158738101554`*^9, 
  3.5440158957632804`*^9}, {3.5440165636226554`*^9, 3.5440166316226554`*^9}, {
  3.544026161484375*^9, 3.544026179875*^9}, {3.544026214828125*^9, 
  3.544026226015625*^9}, {3.544096383140625*^9, 3.54409660140625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"snapshotVars", " ", "[", "]"}], " ", ":=", " ", 
  RowBox[{"TableForm", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<Parameters\>\"", ",", " ", "\[SpanFromLeft]", ",", " ", 
        "\[SpanFromLeft]"}], " ", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"\"\<  Frame of Reference: \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "@", "frameOfRef"}]}], ",", " ", 
        "\[SpanFromLeft]", ",", " ", "\[SpanFromLeft]"}], " ", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"\"\<  Gyroscopic Effects: \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "@", "gyroEffects"}]}], " ", ",", " ", 
        "\[SpanFromLeft]", ",", " ", "\[SpanFromLeft]"}], " ", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Integrator\>\"", ",", " ", "\[SpanFromLeft]", ",", " ", 
        "\[SpanFromLeft]"}], " ", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"Switch", "[", " ", 
         RowBox[{
         "odeIntegrator", ",", "\[IndentingNewLine]", "rk4$stepper", ",", 
          " ", "\"\<  Runge-Kutta 4\>\"", ",", " ", "\[IndentingNewLine]", 
          StyleBox["semiImplicitEuler$stepper", "Output"], ",", " ", 
          "\"\<  Semi-Implicit Euler\>\"", ",", "\[IndentingNewLine]", "_", 
          ",", " ", "\"\<?\>\""}], " ", "]"}], " ", ",", "\[SpanFromLeft]", 
        ",", " ", "\[SpanFromLeft]"}], " ", "}"}], ",", "\[IndentingNewLine]",
       
      RowBox[{"{", " ", 
       RowBox[{"\"\<  h\>\"", ",", " ", "\"\<=\>\"", ",", " ", "h"}], " ", 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<Energy\>\"", ",", " ", "\[SpanFromLeft]", ",", " ", 
        "\[SpanFromLeft]"}], " ", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<  \!\(\*SubscriptBox[\(E\), \(k\)]\)\>\"", ",", " ", "\"\<=\>\"", 
        ",", " ", 
        RowBox[{"Ek", "//", "N"}]}], " ", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<  \!\(\*SubscriptBox[\(E\), \(p\)]\)\>\"", ",", " ", "\"\<=\>\"", 
        ",", " ", 
        RowBox[{"Ep", "//", "N"}]}], " ", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<  \!\(\*SubscriptBox[\(E\), \(tot\)]\)\>\"", ",", " ", 
        "\"\<=\>\"", ",", " ", 
        RowBox[{"Etot", "//", "N"}]}], " ", "}"}], ",", "\[IndentingNewLine]",
       
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<Linear momentum, velocity and position\>\"", ",", " ", 
        "\[SpanFromLeft]", ",", " ", "\[SpanFromLeft]"}], " ", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<  |\!\(\*OverscriptBox[\(p\), \(\[RightVector]\)]\)|\>\"", ",", 
        " ", "\"\<=\>\"", ",", " ", 
        RowBox[{
         RowBox[{"Norm", "[", "P", "]"}], "//", "N"}]}], " ", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<   \!\(\*OverscriptBox[\(p\), \(\[RightVector]\)]\)\>\"", ",", 
        " ", "\"\<=\>\"", ",", " ", 
        RowBox[{"P", "//", "N"}]}], " ", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<  |\!\(\*OverscriptBox[\(v\), \(\[RightVector]\)]\)|\>\"", ",", 
        " ", "\"\<=\>\"", ",", " ", 
        RowBox[{
         RowBox[{"Norm", "[", "V", "]"}], "//", "N"}]}], " ", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<   \!\(\*OverscriptBox[\(v\), \(\[RightVector]\)]\)\>\"", ",", 
        " ", "\"\<=\>\"", ",", " ", 
        RowBox[{"V", "//", "N"}]}], " ", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<   \!\(\*OverscriptBox[\(x\), \(\[RightVector]\)]\)\>\"", ",", 
        " ", "\"\<=\>\"", ",", " ", 
        RowBox[{"X", "//", "N"}]}], " ", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<Angular momentum, velocity and orientation\>\"", ",", 
        "\[SpanFromLeft]", ",", " ", "\[SpanFromLeft]"}], " ", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<  |\!\(\*OverscriptBox[\(L\), \(\[RightVector]\)]\)|\>\"", ",", 
        " ", "\"\<=\>\"", ",", " ", 
        RowBox[{
         RowBox[{"Norm", "[", "L", "]"}], "//", "N"}]}], " ", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<   \!\(\*OverscriptBox[\(L\), \(\[RightVector]\)]\)\>\"", ",", 
        " ", "\"\<=\>\"", ",", " ", 
        RowBox[{"L", "//", "N"}]}], " ", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<  |\!\(\*OverscriptBox[\(\[Omega]\), \(\[RightVector]\)]\)|\>\"", 
        ",", " ", "\"\<=\>\"", ",", " ", 
        RowBox[{
         RowBox[{"Norm", "[", "\[Omega]", "]"}], "//", "N"}]}], " ", "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<   \!\(\*OverscriptBox[\(\[Omega]\), \(\[RightVector]\)]\)\>\"", 
        ",", " ", "\"\<=\>\"", ",", " ", 
        RowBox[{"\[Omega]", "//", "N"}]}], " ", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{"\"\<  |q|\>\"", ",", " ", "\"\<=\>\"", ",", " ", 
        RowBox[{
         RowBox[{"Abs", "[", "Q", "]"}], "//", "N"}]}], " ", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{"\"\<   q\>\"", ",", " ", "\"\<=\>\"", ",", " ", 
        RowBox[{
         RowBox[{"Q", "//", "QForm"}], " ", "//", " ", "N"}]}], " ", "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<Moment of inertia\>\"", ",", "\[SpanFromLeft]", ",", 
        "\[SpanFromLeft]"}], " ", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<  \[LeftDoubleBracketingBar]\[ScriptCapitalJ]\
\[RightDoubleBracketingBar]\>\"", ",", " ", "\"\<=\>\"", ",", " ", 
        RowBox[{
         RowBox[{"Det", "[", "\[ScriptCapitalJ]", "]"}], "//", "N"}]}], " ", 
       "}"}]}], "\[IndentingNewLine]", "}"}], ",", " ", 
    RowBox[{"TableDepth", "\[Rule]", "2"}]}], " ", "]"}]}]], "Input",
 CellChangeTimes->{{3.5440169027164054`*^9, 3.5440170119820304`*^9}, {
  3.5440171646851554`*^9, 3.5440171650132804`*^9}, {3.5440281938125*^9, 
  3.5440282081875*^9}, {3.5440282426875*^9, 3.54402828303125*^9}, {
  3.544028986859375*^9, 3.544028999125*^9}, {3.544029050484375*^9, 
  3.544029096625*^9}, {3.544029160453125*^9, 3.54402927303125*^9}, {
  3.544029316390625*^9, 3.544029327125*^9}, {3.544041267078125*^9, 
  3.5440412945*^9}, {3.54405517840625*^9, 3.5440551789375*^9}, {
  3.5440560050625*^9, 3.544056007265625*^9}, {3.54407899009375*^9, 
  3.544079023296875*^9}, {3.544079120421875*^9, 3.5440791498125*^9}, {
  3.544087407890625*^9, 3.544087747453125*^9}, {3.544087784140625*^9, 
  3.54408787096875*^9}, {3.544087914890625*^9, 3.54408797425*^9}, {
  3.5440880295625*^9, 3.544088122671875*^9}, {3.544088163375*^9, 
  3.5440881885625*^9}, {3.544088226109375*^9, 3.544088233765625*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations of Motion", "Subsection",
 PageBreakBelow->False,
 CellChangeTimes->{{3.5434118480625*^9, 3.54341185275*^9}, {
  3.543413773515625*^9, 3.543413778109375*^9}, {3.54346520003125*^9, 
  3.543465204171875*^9}, {3.54346590540625*^9, 3.543465936734375*^9}, {
  3.543469514546875*^9, 3.54346954415625*^9}, {3.543469639625*^9, 
  3.543469646265625*^9}, {3.543470369328125*^9, 3.54347038834375*^9}, {
  3.54347059428125*^9, 3.543470594546875*^9}, {3.543490896453125*^9, 
  3.543490947890625*^9}, {3.543491820828125*^9, 3.54349182634375*^9}, {
  3.543501141046875*^9, 3.54350115759375*^9}, {3.5435018245625*^9, 
  3.54350182809375*^9}, {3.543561324640625*^9, 3.543561326609375*^9}, {
  3.543561809609375*^9, 3.54356181271875*^9}, {3.543580191046875*^9, 
  3.543580193109375*^9}}],

Cell["\<\
rigidBodyEquations: Gets time derivatives of state variables \
\>", "Subsubsection",
 PageBreakBelow->False,
 CellChangeTimes->{{3.543578316765625*^9, 3.543578396*^9}, {
   3.543579634015625*^9, 3.54357963603125*^9}, {3.5435865389375*^9, 
   3.54358655478125*^9}, {3.543599423484375*^9, 3.54359943925*^9}, {
   3.54402873440625*^9, 3.54402873509375*^9}, {3.544031005203125*^9, 
   3.54403103034375*^9}, 3.5440332405625*^9, {3.544033290125*^9, 
   3.54403329146875*^9}, {3.54403332178125*^9, 3.544033359875*^9}, {
   3.544034217921875*^9, 3.544034234609375*^9}, {3.54403536303125*^9, 
   3.54403537725*^9}, {3.54404288203125*^9, 3.54404288965625*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Equations of motion are depend on the chosen frame of reference and wheter \
gyroscopic effects are neglected or not. Thus, the moment of inertia ",
 StyleBox["\[ScriptCapitalL]",
  FontWeight->"Bold"],
 ", torque ",
 StyleBox["\[Tau]",
  FontWeight->"Bold"],
 ", angular momentum ",
 StyleBox["L",
  FontWeight->"Bold"],
 " and orientation time derivative ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["q", "."], TraditionalForm]]],
 " are given as piece-wise functions depending on  the flags ",
 StyleBox["frameOfRef", "Output"],
 " and ",
 StyleBox["gyroEffects", "Output"],
 "."
}], "TextGroup",
 PageBreakBelow->False,
 CellChangeTimes->{{3.544096615796875*^9, 3.544096794296875*^9}, {
  3.5440970188125*^9, 3.544097247421875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rigidBodyEquations", "[", 
   RowBox[{"{", " ", 
    RowBox[{
    "t_", ",", " ", "X_", ",", " ", "Q_", ",", " ", "P_", ",", " ", "L_"}], 
    " ", "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "  ", 
     RowBox[{
     "Pdot", ",", " ", "Ldot", ",", " ", "Xdot", ",", " ", "Qdot", ",", "  ", 
      "F", ",", " ", "Fext", ",", " ", "\[Tau]", ",", " ", "R", ",", " ", 
      "\[ScriptCapitalJ]inv", ",", " ", "\[Omega]"}], " ", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Calculate", " ", "total", " ", "force"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Fext", " ", "=", " ", 
      RowBox[{"m", " ", "\[ScriptG]n"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Sum", " ", "up", " ", "all", " ", "external", " ", "forces"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Calculate", " ", "linear", " ", "momentum", " ", "time", " ", 
       "derivative"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Pdot", " ", "=", " ", 
      RowBox[{"Fext", " ", "+", " ", "Fint"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Moment", " ", "of", " ", "inertia"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"R", " ", "=", " ", 
      RowBox[{"\[Piecewise]", GridBox[{
         {
          RowBox[{"RotationMatrix", "[", " ", "Q", " ", "]"}], 
          StyleBox[
           RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}],
           FontColor->GrayLevel[0.5]]}
        },
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxSpacings->{"Columns" -> {1, 1}}]}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalJ]inv", " ", "=", " ", 
      RowBox[{"\[Piecewise]", GridBox[{
         {
          RowBox[{"R", ".", "\[ScriptCapitalJ]0inv", ".", 
           SuperscriptBox["R", "\[Transpose]"]}], 
          StyleBox[
           RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}],
           FontColor->GrayLevel[0.5]]},
         {"\[ScriptCapitalJ]0inv", 
          StyleBox[
           RowBox[{"frameOfRef", " ", "===", " ", "BodyFixed"}],
           FontColor->GrayLevel[0.5]]}
        },
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxSpacings->{"Columns" -> {1, 1}}]}]}], " ", ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Derive", " ", "angular", " ", "velocity", " ", "from", " ", "angular", 
       " ", "momentum"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", " ", "=", " ", 
      RowBox[{"\[ScriptCapitalJ]inv", ".", "L"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Calculate", " ", "total", " ", "torque"}], ",", " ", 
       RowBox[{
       "depending", " ", "on", " ", "frame", " ", "of", " ", "reference"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Tau]", " ", "=", " ", 
      RowBox[{"\[Piecewise]", GridBox[{
         {"\[Tau]int", 
          StyleBox[
           RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}],
           FontColor->GrayLevel[0.5]]},
         {
          RowBox[{"Im", "[", " ", 
           RowBox[{
            SuperscriptBox["Q", "*"], " ", "**", "\[Tau]int", "**", " ", 
            "Q"}], " ", "]"}], 
          StyleBox[
           RowBox[{"frameOfRef", " ", "===", " ", "BodyFixed"}],
           FontColor->GrayLevel[0.5]]}
        },
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxSpacings->{"Columns" -> {1, 1}}]}]}], " ", ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Calculate", " ", "angular", " ", "momentum", " ", "time", " ", 
       "derivative"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Ldot", " ", "=", " ", 
      RowBox[{"\[Piecewise]", GridBox[{
         {
          RowBox[{"\[Tau]", "+", 
           RowBox[{"\[Omega]", "\[Cross]", "L"}]}], 
          StyleBox[
           RowBox[{
            RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}], " ", 
            "\[And]", " ", 
            RowBox[{"gyroEffects", " ", "===", " ", "Ignore"}]}],
           FontColor->GrayLevel[0.5]]},
         {"\[Tau]", 
          StyleBox[
           RowBox[{
            RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}], " ", 
            "\[And]", " ", 
            RowBox[{"gyroEffects", " ", "===", " ", "Include"}]}],
           FontColor->GrayLevel[0.5]]},
         {"\[Tau]", 
          StyleBox[
           RowBox[{
            RowBox[{"frameOfRef", " ", "===", " ", "BodyFixed"}], " ", 
            "\[And]", " ", 
            RowBox[{"gyroEffects", " ", "===", " ", "Ignore"}]}],
           FontColor->GrayLevel[0.5]]},
         {
          RowBox[{"\[Tau]", "-", 
           RowBox[{"\[Omega]", "\[Cross]", "L"}]}], 
          StyleBox[
           RowBox[{
            RowBox[{"frameOfRef", " ", "===", " ", "BodyFixed"}], " ", 
            "\[And]", " ", 
            RowBox[{"gyroEffects", " ", "===", " ", "Include"}]}],
           FontColor->GrayLevel[0.5]]}
        },
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxSpacings->{"Columns" -> {1, 1}}]}]}], " ", ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Calculate", " ", "position", " ", "time", " ", "derivative", " ", 
       RowBox[{"(", "velocity", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Xdot", " ", "=", " ", 
      RowBox[{
       SuperscriptBox["m", 
        RowBox[{"-", "1"}]], "P"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Calculate", " ", "orientation", " ", "time", " ", "derivative"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Qdot", "=", 
      RowBox[{"\[Piecewise]", GridBox[{
         {
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"\[Omega]", "**", "Q"}]}], 
          StyleBox[
           RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}],
           FontColor->GrayLevel[0.5]]},
         {
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"Q", "**", "\[Omega]"}]}], 
          StyleBox[
           RowBox[{"frameOfRef", " ", "===", " ", "BodyFixed"}],
           FontColor->GrayLevel[0.5]]}
        },
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxSpacings->{"Columns" -> {1, 1}}]}]}], " ", ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Return", " ", "time", " ", "derivatives", " ", "of", " ", "t"}], ",", 
       " ", "X", ",", " ", "Q", ",", " ", 
       RowBox[{"P", " ", "and", " ", "L"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{
      "1", ",", " ", "Xdot", ",", " ", "Qdot", ",", " ", "Pdot", ",", " ", 
       "Ldot"}], " ", "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 PageBreakAbove->False,
 CellChangeTimes->{{3.54403084371875*^9, 3.544030937671875*^9}, {
   3.544031034890625*^9, 3.54403103896875*^9}, {3.544031131484375*^9, 
   3.544031144703125*^9}, {3.54403124296875*^9, 3.544031252875*^9}, 
   3.54403133803125*^9, {3.544032847671875*^9, 3.544032926984375*^9}, {
   3.544032960234375*^9, 3.544033223875*^9}, 3.54403332103125*^9, {
   3.5440333754375*^9, 3.5440334061875*^9}, {3.544033498984375*^9, 
   3.544033698890625*^9}, {3.54403395428125*^9, 3.54403395659375*^9}, {
   3.544034521171875*^9, 3.544034553765625*^9}, {3.544035710046875*^9, 
   3.544035711921875*^9}, {3.544035875171875*^9, 3.544035900296875*^9}, {
   3.544036668734375*^9, 3.544036670546875*^9}, {3.544041224390625*^9, 
   3.544041240703125*^9}, 3.5440413083125*^9, {3.544041473390625*^9, 
   3.5440414859375*^9}, 3.544041617265625*^9, {3.5440450873125*^9, 
   3.544045110578125*^9}, {3.54404594121875*^9, 3.54404598671875*^9}, {
   3.544046063046875*^9, 3.544046134796875*^9}, {3.544047899890625*^9, 
   3.544047901671875*^9}, {3.54404812190625*^9, 3.544048134734375*^9}, {
   3.544048182484375*^9, 3.54404819196875*^9}, {3.544048226953125*^9, 
   3.544048585828125*^9}, {3.544056008015625*^9, 3.544056015234375*^9}, {
   3.544078552375*^9, 3.544078604015625*^9}, {3.54408058696875*^9, 
   3.5440805913125*^9}, {3.544082897265625*^9, 3.544082918078125*^9}, {
   3.544085816125*^9, 3.544085838796875*^9}, {3.544096822921875*^9, 
   3.5440969525625*^9}, {3.54409701053125*^9, 3.544097013296875*^9}, {
   3.544321098625*^9, 3.544321112546875*^9}, {3.54432119446875*^9, 
   3.544321210921875*^9}, 3.54432133190625*^9, {3.54434558571875*^9, 
   3.544345585984375*^9}, 3.54434563084375*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ODE Solver", "Subsection",
 PageBreakBelow->False,
 CellChangeTimes->{{3.5434118480625*^9, 3.54341185275*^9}, {
  3.543413773515625*^9, 3.543413778109375*^9}, {3.54346520003125*^9, 
  3.543465204171875*^9}, {3.54346590540625*^9, 3.543465936734375*^9}, {
  3.543469514546875*^9, 3.54346954415625*^9}, {3.543469639625*^9, 
  3.543469646265625*^9}, {3.543470369328125*^9, 3.54347038834375*^9}, {
  3.54347059428125*^9, 3.543470594546875*^9}, {3.543490896453125*^9, 
  3.543490947890625*^9}, {3.543491820828125*^9, 3.54349182634375*^9}, {
  3.543501141046875*^9, 3.54350115759375*^9}, {3.5435018245625*^9, 
  3.54350182809375*^9}, {3.543561324640625*^9, 3.543561326609375*^9}, {
  3.543561809609375*^9, 3.54356181271875*^9}, {3.543580191046875*^9, 
  3.543580193109375*^9}, {3.54407867375*^9, 3.544078675984375*^9}}],

Cell[CellGroupData[{

Cell["\<\
solverInit: Initializes state variables and computes derived quantities\
\>", "Subsubsection",
 PageBreakBelow->False,
 CellChangeTimes->{{3.543578316765625*^9, 3.543578396*^9}, {
  3.543579634015625*^9, 3.54357963603125*^9}, {3.5435865389375*^9, 
  3.54358655478125*^9}, {3.543599423484375*^9, 3.54359942678125*^9}, {
  3.54402872796875*^9, 3.544028729984375*^9}, {3.544035344390625*^9, 
  3.544035351046875*^9}, {3.544082327125*^9, 3.544082330828125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solverInit", " ", "[", "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"R", ",", " ", "scalef"}], " ", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Stop", " ", "any", " ", "running", " ", "simulations"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"runSimulation", " ", "=", " ", "False"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Initial", " ", "time"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"t", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Initial", " ", "position", " ", "and", " ", "orientation"}], 
       ",", " ", 
       RowBox[{"in", " ", "inertial", " ", "frame"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"X", "=", "X0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"Sign", "[", " ", "Q0", " ", "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Normalize", " ", "orientation", " ", "to", " ", "a", " ", "versor"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Moment", " ", "of", " ", "inertia"}], ",", " ", 
       RowBox[{"frame", " ", "dependent"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"R", " ", "=", " ", 
      RowBox[{"\[Piecewise]", GridBox[{
         {
          RowBox[{"RotationMatrix", "[", " ", "Q", " ", "]"}], 
          StyleBox[
           RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}],
           FontColor->GrayLevel[0.5]]}
        },
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxSpacings->{"Columns" -> {1, 1}}]}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalJ]", " ", "=", " ", 
      RowBox[{"\[Piecewise]", GridBox[{
         {
          RowBox[{"R", ".", "\[ScriptCapitalJ]0", ".", 
           SuperscriptBox["R", "\[Transpose]"]}], 
          StyleBox[
           RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}],
           FontColor->GrayLevel[0.5]]},
         {"\[ScriptCapitalJ]0", 
          StyleBox[
           RowBox[{"frameOfRef", " ", "===", " ", "BodyFixed"}],
           FontColor->GrayLevel[0.5]]}
        },
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxSpacings->{"Columns" -> {1, 1}}]}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalJ]inv", " ", "=", " ", 
      RowBox[{"\[Piecewise]", GridBox[{
         {
          RowBox[{"R", ".", "\[ScriptCapitalJ]0inv", ".", 
           SuperscriptBox["R", "\[Transpose]"]}], 
          StyleBox[
           RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}],
           FontColor->GrayLevel[0.5]]},
         {"\[ScriptCapitalJ]0inv", 
          StyleBox[
           RowBox[{"frameOfRef", " ", "===", " ", "BodyFixed"}],
           FontColor->GrayLevel[0.5]]}
        },
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxSpacings->{"Columns" -> {1, 1}}]}]}], " ", ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Velocity", " ", "and", " ", "linear", " ", "momentum"}], ",", 
       " ", 
       RowBox[{"in", " ", "inertial", " ", "frame"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"V", "=", "V0"}], ";", " ", 
     RowBox[{"(*", " ", "Velocity", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"P", "=", 
      RowBox[{"m", " ", "V"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Linear", " ", "momentum"}], " ", "*)"}], "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Initial", " ", "angular", " ", "velocity", " ", "is", " ", "always", 
        " ", "in", " ", "body"}], "-", 
       RowBox[{"fixed", " ", "frame"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"\[Omega]", " ", "=", " ", 
      RowBox[{"\[Piecewise]", GridBox[{
         {
          RowBox[{"Im", "[", " ", 
           RowBox[{"Q", "**", "\[Omega]0", "**", 
            SuperscriptBox["Q", "*"]}], " ", "]"}], 
          StyleBox[
           RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}],
           FontColor->GrayLevel[0.5]]},
         {"\[Omega]0", 
          StyleBox[
           RowBox[{"frameOfRef", " ", "===", " ", "BodyFixed"}],
           FontColor->GrayLevel[0.5]]}
        },
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxSpacings->{"Columns" -> {1, 1}}]}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Angular", " ", "momentum"}], ",", " ", 
       RowBox[{"frame", " ", "dependent"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"\[ScriptCapitalJ]", ".", "\[Omega]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Angular", " ", "momentum"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Internal", " ", "forces", " ", "and", " ", "torque"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Fint", " ", "=", " ", 
      RowBox[{"{", " ", 
       RowBox[{"0", ",", "0", ",", "0"}], " ", "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Tau]int", " ", "=", " ", 
      RowBox[{"{", " ", 
       RowBox[{"0", ",", "0", ",", "0"}], " ", "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Derived", " ", "quantities"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Ek", "=", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"P", ".", "V"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"L", ".", "\[Omega]"}]}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Kinetic", " ", "energy"}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"Ep", "=", 
      RowBox[{
       RowBox[{"-", "m"}], " ", 
       RowBox[{"\[ScriptG]n", ".", "X"}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Potential", " ", "energy"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Etot", "=", 
      RowBox[{"Ek", "+", "Ep"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Total", " ", "energy"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Keep", " ", "track", " ", "of", " ", "angular", " ", "velocity"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Omega]Track", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]",
      
     RowBox[{"(*", " ", 
      RowBox[{
      "Angular", " ", "velocity", " ", "and", " ", "angular", " ", "momentum",
        " ", "scale", " ", "factors"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"scalef", " ", "=", " ", 
      RowBox[{"0.8", " ", 
       RowBox[{"Max", "[", " ", 
        RowBox[{
         RowBox[{"Abs", "[", " ", "body$v", " ", "]"}], ",", " ", 
         RowBox[{"0.9", "\[ScriptL]"}]}], " ", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Omega]Scale", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Norm", "[", " ", "\[Omega]", " ", "]"}], "/", "scalef"}], 
       " ", "//", "N"}]}], ";", " ", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"\[Omega]Scale", " ", "\[Equal]", " ", "0"}], ",", " ", 
       RowBox[{"\[Omega]Scale", " ", "=", " ", "1"}]}], " ", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"LScale", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Norm", "[", " ", "L", " ", "]"}], "/", "scalef"}], " ", "//",
        "N"}]}], ";", " ", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"LScale", " ", "\[Equal]", " ", "0"}], ",", " ", 
       RowBox[{"LScale", " ", "=", " ", "1"}]}], " ", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Update", " ", "animation", " ", "data"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"aData", " ", "=", " ", 
      RowBox[{"getAnimationData", " ", "[", "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5435711965625*^9, 3.543571311390625*^9}, {
   3.543571480046875*^9, 3.543571527765625*^9}, {3.54357160790625*^9, 
   3.543571615359375*^9}, {3.543571682921875*^9, 3.543571693625*^9}, {
   3.543571780890625*^9, 3.5435717978125*^9}, {3.543571872671875*^9, 
   3.543571893125*^9}, {3.543572116828125*^9, 3.54357212071875*^9}, {
   3.54357288971875*^9, 3.543572890390625*^9}, {3.543572922859375*^9, 
   3.543572928359375*^9}, {3.54357304321875*^9, 3.54357305146875*^9}, {
   3.54357841909375*^9, 3.543578441*^9}, {3.543578480796875*^9, 
   3.543578490109375*^9}, 3.5435791645*^9, {3.5435794176875*^9, 
   3.543579433984375*^9}, {3.543579552875*^9, 3.543579557375*^9}, {
   3.543579618140625*^9, 3.543579619953125*^9}, {3.54358233115625*^9, 
   3.543582338546875*^9}, {3.54358611940625*^9, 3.54358614071875*^9}, {
   3.543586174640625*^9, 3.54358618634375*^9}, {3.543586221375*^9, 
   3.543586223109375*^9}, {3.543587174515625*^9, 3.5435871904375*^9}, {
   3.54358924715625*^9, 3.543589260671875*^9}, {3.54358960128125*^9, 
   3.543589607546875*^9}, {3.54359133775*^9, 3.543591339265625*^9}, {
   3.54359139740625*^9, 3.543591410546875*^9}, {3.543595388828125*^9, 
   3.54359539809375*^9}, {3.543596094109375*^9, 3.543596209140625*^9}, 
   3.54359627459375*^9, {3.543596407703125*^9, 3.543596411125*^9}, {
   3.543596562859375*^9, 3.5435965933125*^9}, {3.54359662684375*^9, 
   3.54359663221875*^9}, {3.5435967515625*^9, 3.543596753984375*^9}, {
   3.54359823871875*^9, 3.54359840675*^9}, {3.54359844640625*^9, 
   3.54359844678125*^9}, {3.543598484875*^9, 3.543598536828125*^9}, {
   3.543598579484375*^9, 3.5435986104375*^9}, 3.543598829140625*^9, 
   3.54359889878125*^9, {3.543599205640625*^9, 3.543599227671875*^9}, {
   3.54360082434375*^9, 3.543600842953125*^9}, {3.543600949578125*^9, 
   3.543600958390625*^9}, {3.543602660109375*^9, 3.54360266284375*^9}, {
   3.54360284821875*^9, 3.5436028745625*^9}, {3.543603109984375*^9, 
   3.543603114203125*^9}, {3.543604120265625*^9, 3.543604132390625*^9}, {
   3.543604431484375*^9, 3.54360445046875*^9}, 3.5436047649375*^9, 
   3.543606296234375*^9, {3.543607098953125*^9, 3.54360711928125*^9}, {
   3.54360723025*^9, 3.54360724696875*^9}, {3.543607313703125*^9, 
   3.543607381078125*^9}, {3.5436416595*^9, 3.543641684546875*^9}, {
   3.543641728875*^9, 3.543641984609375*^9}, {3.5436421036875*^9, 
   3.5436421656875*^9}, {3.54364234121875*^9, 3.543642343390625*^9}, {
   3.543642384328125*^9, 3.543642415578125*^9}, {3.54364244828125*^9, 
   3.54364245340625*^9}, 3.543642603875*^9, {3.54364290934375*^9, 
   3.543642922640625*^9}, {3.543643635734375*^9, 3.54364363790625*^9}, {
   3.543644225859375*^9, 3.543644227140625*^9}, {3.543644487765625*^9, 
   3.543644514609375*^9}, {3.54364468509375*^9, 3.5436447176875*^9}, {
   3.54364476915625*^9, 3.543644788234375*^9}, {3.543644854984375*^9, 
   3.5436448789375*^9}, 3.543645281171875*^9, {3.543645351421875*^9, 
   3.54364538134375*^9}, {3.543645421890625*^9, 3.54364543021875*^9}, {
   3.543647679328125*^9, 3.54364768225*^9}, {3.543733371296875*^9, 
   3.543733381859375*^9}, {3.543924008359375*^9, 3.543924013046875*^9}, {
   3.543928792546875*^9, 3.5439288003125*^9}, {3.543928871*^9, 
   3.543928879578125*^9}, {3.543929301703125*^9, 3.543929358203125*^9}, {
   3.543929526859375*^9, 3.5439295373125*^9}, {3.543933649953125*^9, 
   3.543933674375*^9}, {3.543934702109375*^9, 3.54393470409375*^9}, {
   3.54393499553125*^9, 3.54393499625*^9}, {3.543938098234375*^9, 
   3.543938201125*^9}, {3.543938232859375*^9, 3.5439382338125*^9}, {
   3.543938392203125*^9, 3.5439383933125*^9}, {3.543938594390625*^9, 
   3.543938601171875*^9}, {3.5439387119375*^9, 3.54393873825*^9}, {
   3.54393896828125*^9, 3.543938968453125*^9}, {3.543939718625*^9, 
   3.543939723015625*^9}, {3.543940013828125*^9, 3.543940050109375*^9}, {
   3.5439410880625*^9, 3.5439412106875*^9}, 3.54394127321875*^9, {
   3.54394132790625*^9, 3.543941330828125*^9}, 3.543941557234375*^9, 
   3.5439416655*^9, {3.543942532109375*^9, 3.543942544859375*^9}, {
   3.543992911*^9, 3.54399291409375*^9}, {3.543993291578125*^9, 
   3.543993309796875*^9}, {3.543993431546875*^9, 3.54399344415625*^9}, {
   3.54399416678125*^9, 3.543994168109375*^9}, {3.54399425571875*^9, 
   3.543994291734375*^9}, {3.5439954114375*^9, 3.54399543009375*^9}, {
   3.543995562625*^9, 3.543995569109375*^9}, {3.5439957145*^9, 
   3.54399573178125*^9}, {3.54399578371875*^9, 3.54399584146875*^9}, {
   3.54399594415625*^9, 3.54399604021875*^9}, {3.543996816765625*^9, 
   3.5439968200625*^9}, {3.54399852659375*^9, 3.543998534125*^9}, {
   3.5440000859375*^9, 3.54400010065625*^9}, 3.5440137147164054`*^9, {
   3.5440159683570304`*^9, 3.5440161831226554`*^9}, {3.5440166537320304`*^9, 
   3.5440166778414054`*^9}, {3.5440170398570304`*^9, 
   3.5440170400289054`*^9}, {3.5440174786226554`*^9, 
   3.5440174915289054`*^9}, {3.544024310859375*^9, 3.5440243475*^9}, {
   3.544026489125*^9, 3.544026636390625*^9}, 3.544027066484375*^9, {
   3.544027303546875*^9, 3.544027306484375*^9}, {3.544028547375*^9, 
   3.544028600453125*^9}, 3.54402884234375*^9, {3.54403368103125*^9, 
   3.544033729359375*^9}, {3.544036937515625*^9, 3.54403694296875*^9}, {
   3.5440376426875*^9, 3.544037657546875*^9}, {3.54403805028125*^9, 
   3.544038057703125*^9}, {3.5440382424375*^9, 3.544038250828125*^9}, {
   3.54403878375*^9, 3.54403878490625*^9}, {3.54404119928125*^9, 
   3.544041205734375*^9}, {3.54404125209375*^9, 3.544041253109375*^9}, 
   3.54404130246875*^9, {3.54404151390625*^9, 3.54404151559375*^9}, {
   3.544041609046875*^9, 3.544041611515625*^9}, {3.54404360428125*^9, 
   3.544043669265625*^9}, {3.54404379628125*^9, 3.544043914265625*^9}, {
   3.54404451840625*^9, 3.54404451878125*^9}, {3.544045449265625*^9, 
   3.544045453390625*^9}, {3.544046443546875*^9, 3.5440464455625*^9}, {
   3.54404704346875*^9, 3.544047044828125*^9}, {3.5440508074375*^9, 
   3.544050826765625*^9}, {3.544051031640625*^9, 3.544051192671875*^9}, {
   3.54405137925*^9, 3.54405139159375*^9}, {3.544055248765625*^9, 
   3.544055248953125*^9}, {3.54405601628125*^9, 3.54405602071875*^9}, 
   3.54408584371875*^9, {3.544097708234375*^9, 3.544097732015625*^9}, {
   3.544097818140625*^9, 3.54409783346875*^9}, {3.5442022399375*^9, 
   3.544202300703125*^9}, {3.544202332390625*^9, 3.544202368203125*^9}, {
   3.544202470828125*^9, 3.5442025009375*^9}, {3.544278665984375*^9, 
   3.544278694828125*^9}, {3.544321151296875*^9, 3.54432117021875*^9}, {
   3.544321220171875*^9, 3.544321242375*^9}}]
}, Open  ]],

Cell["\<\
solverStep: Solves equations and recalculates derived quantities\
\>", "Subsubsection",
 PageBreakBelow->False,
 CellChangeTimes->{{3.543578316765625*^9, 3.543578396*^9}, {
  3.543579634015625*^9, 3.54357963603125*^9}, {3.5435865389375*^9, 
  3.54358655478125*^9}, {3.543599423484375*^9, 3.54359943925*^9}, {
  3.54402873440625*^9, 3.54402873509375*^9}, {3.544042724546875*^9, 
  3.544042779921875*^9}, {3.54408233875*^9, 3.544082338796875*^9}}],

Cell[CellGroupData[{

Cell["\<\
Function calls repeatedly chosen ODE integrator, normalizes orientation \
qaternion to a versor and calculates derived quantities (like energy). (It  \
saves also head of the angular velocity vector in an array to visualize \
precession and nutation.)\
\>", "TextGroup",
 PageBreakBelow->False,
 CellChangeTimes->{{3.544096615796875*^9, 3.544096794296875*^9}, {
  3.5440970188125*^9, 3.544097383609375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solverStep", "[", " ", 
   RowBox[{"count_:", " ", "1"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", " ", "R", " ", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{"\[Not]", "runSimulation"}], ",", " ", 
          RowBox[{"Break", "[", "]"}]}], " ", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Solve", " ", "equations", " ", "using", " ", "specified", " ", 
          "integrator"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{
          "t", ",", " ", "X", ",", " ", "Q", ",", " ", "P", ",", " ", "L"}], 
          " ", "}"}], " ", "=", " ", 
         RowBox[{"odeIntegrator", "[", " ", 
          RowBox[{
           RowBox[{"{", " ", 
            RowBox[{
            "t", ",", " ", "X", ",", " ", "Q", ",", " ", "P", ",", " ", "L"}],
             " ", "}"}], ",", " ", "\[IndentingNewLine]", "\t\t", "h", ",", 
           " ", "rigidBodyEquations"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"Q", " ", "=", " ", 
         RowBox[{"Sign", "[", " ", "Q", " ", "]"}]}], ";", "  ", 
        RowBox[{"(*", " ", 
         RowBox[{"Keep", " ", "orientation", " ", "as", " ", "versor"}], " ", 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Update", " ", "moment", " ", "of", " ", "inertia"}], ",", 
          " ", 
          RowBox[{
          "but", " ", "only", " ", "if", " ", "in", " ", "inertial", " ", 
           "frame"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"R", " ", "=", " ", 
         RowBox[{"\[Piecewise]", GridBox[{
            {
             RowBox[{"RotationMatrix", "[", " ", "Q", " ", "]"}], 
             StyleBox[
              RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}],
              FontColor->GrayLevel[0.5]]}
           },
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxSpacings->{"Columns" -> {1, 1}}]}]}], " ", ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"\[ScriptCapitalJ]", " ", "=", " ", 
         RowBox[{"\[Piecewise]", GridBox[{
            {
             RowBox[{"R", ".", "\[ScriptCapitalJ]0", ".", 
              SuperscriptBox["R", "\[Transpose]"]}], 
             StyleBox[
              RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}],
              FontColor->GrayLevel[0.5]]},
            {"\[ScriptCapitalJ]0", 
             StyleBox[
              RowBox[{"frameOfRef", " ", "===", " ", "BodyFixed"}],
              FontColor->GrayLevel[0.5]]}
           },
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxSpacings->{"Columns" -> {1, 1}}]}]}], " ", ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"\[ScriptCapitalJ]inv", " ", "=", " ", 
         RowBox[{"\[Piecewise]", GridBox[{
            {
             RowBox[{"R", ".", "\[ScriptCapitalJ]0inv", ".", 
              SuperscriptBox["R", "\[Transpose]"]}], 
             StyleBox[
              RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}],
              FontColor->GrayLevel[0.5]]},
            {"\[ScriptCapitalJ]0inv", 
             StyleBox[
              RowBox[{"frameOfRef", " ", "===", " ", "BodyFixed"}],
              FontColor->GrayLevel[0.5]]}
           },
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxSpacings->{"Columns" -> {1, 1}}]}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Calculate", " ", "derived", " ", "quantities"}], " ", 
         "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"V", " ", "=", " ", 
         RowBox[{
          SuperscriptBox["m", 
           RowBox[{"-", "1"}]], "P"}]}], ";", "      ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Linear", " ", "velocity", " ", "from", " ", "linear", " ", 
          "momentum"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"\[Omega]", " ", "=", " ", 
         RowBox[{"\[ScriptCapitalJ]inv", ".", "L"}]}], ";", "  ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Angular", " ", "velocity", " ", "from", " ", "angular", " ", 
          "momentum"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"Ek", "=", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"P", ".", "V"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"L", ".", "\[Omega]"}]}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Kinetic", " ", "energy"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Ep", "=", 
         RowBox[{
          RowBox[{"-", "m"}], " ", 
          RowBox[{"\[ScriptG]n", ".", "X"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Potential", " ", "energy"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Etot", "=", 
         RowBox[{"Ek", "+", "Ep"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Total", " ", "energy"}], " ", "*)"}], "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Keep", " ", "track", " ", "of", " ", "angular", " ", "velocity"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"AppendTo", "[", " ", 
         RowBox[{"\[Omega]Track", ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"If", "[", " ", 
            RowBox[{
             RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}], ",", " ", 
             "\[Omega]", ",", " ", 
             RowBox[{"\[CapitalStigma]T", "[", " ", "\[Omega]", " ", "]"}]}], 
            " ", "]"}], " ", "/", " ", "\[Omega]Scale"}]}], 
         "\[IndentingNewLine]", "\t", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "count", "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Update", " ", "animation", " ", "data"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"aData", " ", "=", " ", 
      RowBox[{"getAnimationData", " ", "[", "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.544030218609375*^9, 3.54403028978125*^9}, {
   3.544030324171875*^9, 3.5440303415625*^9}, {3.54403043165625*^9, 
   3.544030449015625*^9}, {3.54403599103125*^9, 3.54403618053125*^9}, {
   3.544037218828125*^9, 3.544037219578125*^9}, {3.54403746725*^9, 
   3.544037473875*^9}, {3.544037708953125*^9, 3.544037737765625*^9}, {
   3.54403833821875*^9, 3.54403834534375*^9}, {3.5440383898125*^9, 
   3.544038391890625*^9}, {3.5440385071875*^9, 3.54403850771875*^9}, {
   3.54403888190625*^9, 3.544038924921875*^9}, {3.5440390965625*^9, 
   3.544039189625*^9}, {3.544041520125*^9, 3.544041520765625*^9}, 
   3.544042689484375*^9, {3.544043952546875*^9, 3.544043955359375*^9}, {
   3.544044018625*^9, 3.5440440215625*^9}, {3.544044802125*^9, 
   3.54404482259375*^9}, {3.544045165875*^9, 3.544045203765625*^9}, {
   3.544045399984375*^9, 3.544045406828125*^9}, 3.54404558365625*^9, 
   3.544045621671875*^9, {3.544046016375*^9, 3.54404605003125*^9}, {
   3.54404615109375*^9, 3.544046153171875*^9}, {3.544046204296875*^9, 
   3.5440462310625*^9}, {3.544046436328125*^9, 3.5440464385625*^9}, {
   3.5440466754375*^9, 3.54404670621875*^9}, {3.5440470876875*^9, 
   3.544047108375*^9}, {3.5440477688125*^9, 3.544047770046875*^9}, {
   3.544048737359375*^9, 3.544048739*^9}, {3.544049892203125*^9, 
   3.544049893890625*^9}, {3.544053037140625*^9, 3.54405306584375*^9}, {
   3.54405310346875*^9, 3.544053154765625*^9}, {3.544053191515625*^9, 
   3.5440533228125*^9}, {3.54405342390625*^9, 3.544053533671875*^9}, {
   3.544053569859375*^9, 3.5440536509375*^9}, {3.544055243484375*^9, 
   3.54405524378125*^9}, {3.544056021625*^9, 3.54405602375*^9}, {
   3.54407931415625*^9, 3.5440793241875*^9}, {3.54408236321875*^9, 
   3.5440823915625*^9}, {3.544082926578125*^9, 3.544082937328125*^9}, {
   3.5440858460625*^9, 3.5440858484375*^9}, {3.544278668265625*^9, 
   3.544278696359375*^9}, {3.544344708328125*^9, 3.544344711171875*^9}, {
   3.544344812046875*^9, 3.54434481346875*^9}, {3.544344844140625*^9, 
   3.544344846046875*^9}, {3.544344918671875*^9, 3.544344961171875*^9}, {
   3.54434503109375*^9, 3.544345033734375*^9}}]
}, Open  ]],

Cell["solverRun: Runs simulation until stopped", "Subsubsection",
 PageBreakBelow->False,
 CellChangeTimes->{{3.543578316765625*^9, 3.543578396*^9}, {
  3.543579634015625*^9, 3.54357963603125*^9}, {3.5435865389375*^9, 
  3.54358655478125*^9}, {3.543599423484375*^9, 3.54359943925*^9}, {
  3.54402873440625*^9, 3.54402873509375*^9}, {3.544042724546875*^9, 
  3.544042779921875*^9}, {3.5440537603125*^9, 3.54405376878125*^9}, {
  3.54407865315625*^9, 3.544078654265625*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Creates the animation cell (if it does not exist) and evaluates ",
 StyleBox["solverStep", "Output"],
 " function until ",
 StyleBox["runSimulation", "Output"],
 " flag is reset to ",
 StyleBox["False", "Output"],
 "."
}], "TextGroup",
 PageBreakBelow->False,
 CellChangeTimes->{{3.544096615796875*^9, 3.544096794296875*^9}, {
  3.5440970188125*^9, 3.5440975363125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solverRun", "[", " ", 
   RowBox[{"locateCell_:", " ", "False"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"nb", " ", "=", " ", 
       RowBox[{"EvaluationNotebook", "[", "]"}]}], ",", " ", 
      "noAnimationCell"}], " ", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Locate", " ", "and", " ", "evaulate", " ", "cell", " ", "containing", 
      " ", 
      RowBox[{"solverRun", "[", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", " ", 
      RowBox[{"locateCell", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NotebookFind", "[", " ", 
         RowBox[{
         "nb", ",", " ", "\"\<RUNSIMULATION\>\"", ",", "Next", ",", 
          "CellTags", ",", 
          RowBox[{"AutoScroll", "\[Rule]", "False"}]}], " ", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SelectionEvaluateCreateCell", "[", " ", "nb", " ", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", " ", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Recreate", " ", "animation", " ", "cell"}], ",", " ", 
       RowBox[{"if", " ", "it", " ", "does", " ", "not", " ", "exist"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"$Failed", "===", 
        RowBox[{"NotebookFind", "[", " ", 
         RowBox[{
         "nb", ",", "\"\<ANIMATION\>\"", ",", " ", "Next", ",", "CellTags", 
          ",", 
          RowBox[{"AutoScroll", "\[Rule]", "False"}]}], " ", "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"CellPrint", "[", " ", 
         RowBox[{"ExpressionCell", "[", " ", 
          RowBox[{
           RowBox[{"showAnimation", " ", "[", "]"}], ",", 
           RowBox[{"CellTags", "\[Rule]", "\"\<ANIMATION\>\""}]}], " ", "]"}],
          " ", "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"NotebookFind", "[", " ", 
         RowBox[{
         "nb", ",", "\"\<ANIMATION\>\"", ",", " ", "Next", ",", "CellTags", 
          ",", 
          RowBox[{"AutoScroll", "\[Rule]", "False"}]}], " ", "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"SetOptions", "[", " ", 
         RowBox[{
          RowBox[{"NotebookSelection", "[", " ", "nb", " ", "]"}], ",", 
          RowBox[{"CellAutoOverwrite", "\[Rule]", "False"}]}], " ", "]"}]}]}],
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"NotebookFind", "[", " ", 
      RowBox[{
      "nb", ",", " ", "\"\<RUNSIMULATION\>\"", ",", "Next", ",", "CellTags", 
       ",", 
       RowBox[{"AutoScroll", "\[Rule]", "False"}]}], " ", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionMove", "[", " ", 
      RowBox[{"nb", ",", " ", "After", ",", " ", "CellContents"}], " ", "]"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Run", " ", "simulation"}], ",", " ", 
       RowBox[{"until", " ", "cancelled"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"runSimulation", " ", "=", " ", "True"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", " ", 
      RowBox[{
       RowBox[{"runSimulation", " ", "\[And]", " ", 
        RowBox[{"t", " ", "<", " ", "tf"}]}], ",", " ", 
       RowBox[{"solverStep", " ", "[", "]"}]}], " ", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"runSimulation", " ", "=", " ", "False"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5440537729375*^9, 3.544053813703125*^9}, {
   3.5440538729375*^9, 3.54405391559375*^9}, {3.54405396109375*^9, 
   3.544053970953125*^9}, {3.5440540199375*^9, 3.544054020171875*^9}, {
   3.544054074515625*^9, 3.544054075734375*^9}, {3.544054581234375*^9, 
   3.544054583234375*^9}, {3.54405461903125*^9, 3.54405462796875*^9}, 
   3.54405558609375*^9, {3.544088535421875*^9, 3.544088541125*^9}, {
   3.54408857315625*^9, 3.544088577796875*^9}, {3.544088815546875*^9, 
   3.54408887546875*^9}, {3.5440892809375*^9, 3.54408928146875*^9}, {
   3.544089313125*^9, 3.544089313609375*^9}, {3.54408984515625*^9, 
   3.54408991596875*^9}, {3.544090010484375*^9, 3.544090011015625*^9}, {
   3.54409007434375*^9, 3.544090079328125*^9}, {3.54409019025*^9, 
   3.544090312734375*^9}, {3.544090344953125*^9, 3.5440903628125*^9}, {
   3.54409045303125*^9, 3.5440904773125*^9}, {3.544090530796875*^9, 
   3.5440905969375*^9}, {3.544090637078125*^9, 3.544090640421875*^9}, {
   3.544090728828125*^9, 3.54409073109375*^9}, {3.5440907830625*^9, 
   3.54409081003125*^9}, {3.54409084340625*^9, 3.5440908970625*^9}, {
   3.544090952046875*^9, 3.544090956734375*^9}, {3.54409103890625*^9, 
   3.544091051796875*^9}, {3.54409114528125*^9, 3.54409129609375*^9}, {
   3.544091356453125*^9, 3.54409136125*^9}, {3.544091395875*^9, 
   3.5440914241875*^9}, {3.54409147465625*^9, 3.544091519484375*^9}, {
   3.544091558046875*^9, 3.5440916321875*^9}, {3.544091692015625*^9, 
   3.544091692734375*^9}, {3.54409172896875*^9, 3.54409183678125*^9}, {
   3.544091869359375*^9, 3.54409200059375*^9}, {3.544092064875*^9, 
   3.544092105875*^9}, {3.544092163125*^9, 3.544092198359375*^9}, {
   3.544092287078125*^9, 3.544092316578125*^9}, {3.54409236409375*^9, 
   3.544092420765625*^9}, {3.544092453625*^9, 3.544092498609375*^9}, {
   3.544092550890625*^9, 3.544092566984375*^9}, {3.544092625421875*^9, 
   3.5440926275*^9}, {3.5440926794375*^9, 3.544092701734375*^9}, {
   3.544092733*^9, 3.544092801046875*^9}, {3.544092840015625*^9, 
   3.544092844109375*^9}, {3.544092886171875*^9, 3.54409291515625*^9}, {
   3.5443451110625*^9, 3.544345115546875*^9}, {3.544345145625*^9, 
   3.544345149078125*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialize Simulation", "Subsection",
 PageBreakBelow->False,
 CellChangeTimes->{{3.5434118480625*^9, 3.54341185275*^9}, {
  3.543413773515625*^9, 3.543413778109375*^9}, {3.54346520003125*^9, 
  3.543465204171875*^9}, {3.54346590540625*^9, 3.543465936734375*^9}, {
  3.543469514546875*^9, 3.54346954415625*^9}, {3.543469639625*^9, 
  3.543469646265625*^9}, {3.543470369328125*^9, 3.54347038834375*^9}, {
  3.54347059428125*^9, 3.543470594546875*^9}, {3.543490896453125*^9, 
  3.543490947890625*^9}, {3.543491820828125*^9, 3.54349182634375*^9}, {
  3.543501141046875*^9, 3.54350115759375*^9}, {3.5435018245625*^9, 
  3.54350182809375*^9}, {3.543561324640625*^9, 3.543561326609375*^9}, {
  3.543561809609375*^9, 3.54356181271875*^9}, {3.543580191046875*^9, 
  3.543580193109375*^9}, {3.544042227375*^9, 3.544042255796875*^9}}],

Cell[CellGroupData[{

Cell["\<\
Default parameters are conviniently modified here before running simulation.\
\>", "TextGroup",
 CellChangeTimes->{{3.544096615796875*^9, 3.544096794296875*^9}, {
  3.5440970188125*^9, 3.5440975700625*^9}, {3.544097610765625*^9, 
  3.54409762146875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptL]", "=", "3.5"}], ";", " ", 
   RowBox[{"\[ScriptG]n", "=", 
    RowBox[{"{", " ", 
     RowBox[{"0", ",", "0", ",", "0"}], " ", "}"}]}], ";", "  ", 
   RowBox[{"tf", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setupBodyShape", "[", " ", 
    RowBox[{"10", ",", 
     RowBox[{"{", " ", 
      RowBox[{"4", ",", "5", ",", "2"}], "}"}], ",", "\"\<Cuboid\>\""}], " ", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X0", "=", 
    RowBox[{"{", " ", 
     RowBox[{"0", ",", "0", ",", "0"}], " ", "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"in", " ", "inertial", " ", "frame"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Q0", "=", 
    RowBox[{"N", "@", 
     RowBox[{"To\[ScriptCapitalQ]$AngleAxis", "[", " ", 
      RowBox[{"0.1", ",", 
       RowBox[{"{", " ", 
        RowBox[{"1", ",", "0", ",", "0.5"}], " ", "}"}]}], " ", "]"}]}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"in", " ", "inertial", " ", "frame"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V0", "=", 
    RowBox[{"{", " ", 
     RowBox[{"0", ",", "0", ",", "0"}], " ", "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"in", " ", "inertial", " ", "frame"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]0", "=", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "3"}], ",", "2"}], " ", "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"in", " ", "body"}], "-", 
    RowBox[{"fixed", " ", 
     RowBox[{"(", "!", ")"}], " ", "frame"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solverInit", " ", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.543599171328125*^9, 3.543599210140625*^9}, {
   3.54359941365625*^9, 3.5435994158125*^9}, {3.543599763140625*^9, 
   3.54359976803125*^9}, {3.543599802296875*^9, 3.543599809421875*^9}, {
   3.5435998805*^9, 3.54359995446875*^9}, {3.543599993375*^9, 
   3.543599998734375*^9}, {3.543600136765625*^9, 3.543600178453125*^9}, {
   3.5436002800625*^9, 3.543600282234375*^9}, {3.543600391328125*^9, 
   3.5436004371875*^9}, {3.54360047615625*^9, 3.543600480203125*^9}, {
   3.543600579859375*^9, 3.543600581953125*^9}, {3.543600616234375*^9, 
   3.543600616546875*^9}, {3.543600689984375*^9, 3.543600708328125*^9}, {
   3.5436007504375*^9, 3.5436008000625*^9}, {3.5436009181875*^9, 
   3.543600921421875*^9}, {3.543600994703125*^9, 3.543601013375*^9}, {
   3.543602379484375*^9, 3.5436023864375*^9}, {3.543602460015625*^9, 
   3.543602487390625*^9}, {3.54360456328125*^9, 3.543604568390625*^9}, {
   3.5436046129375*^9, 3.54360461459375*^9}, {3.54360466290625*^9, 
   3.54360468690625*^9}, {3.5436049913125*^9, 3.543605071046875*^9}, {
   3.54360514003125*^9, 3.54360525565625*^9}, {3.5436063145*^9, 
   3.5436063198125*^9}, {3.54364365040625*^9, 3.5436436670625*^9}, {
   3.54365083525*^9, 3.543650907453125*^9}, {3.543650959515625*^9, 
   3.543650987828125*^9}, {3.543651034953125*^9, 3.5436510420625*^9}, {
   3.543651074921875*^9, 3.543651075125*^9}, {3.54365115440625*^9, 
   3.543651204796875*^9}, {3.543651330328125*^9, 3.54365134346875*^9}, {
   3.54365144546875*^9, 3.543651445875*^9}, {3.54365149225*^9, 
   3.5436515465*^9}, {3.54373378096875*^9, 3.543733835625*^9}, 
   3.543928611546875*^9, 3.5439286590625*^9, {3.54392876553125*^9, 
   3.54392877090625*^9}, 3.54392889334375*^9, {3.543932240078125*^9, 
   3.5439322461875*^9}, {3.543932359046875*^9, 3.543932366578125*^9}, {
   3.543932732*^9, 3.543932795328125*^9}, {3.543934779796875*^9, 
   3.543934793078125*^9}, {3.54393503509375*^9, 3.543935040875*^9}, {
   3.543935073609375*^9, 3.54393507696875*^9}, {3.543935209546875*^9, 
   3.543935211625*^9}, 3.54393876265625*^9, {3.5439392261875*^9, 
   3.543939322296875*^9}, {3.54393995934375*^9, 3.54393996325*^9}, {
   3.543940092359375*^9, 3.543940094*^9}, 3.543940373421875*^9, {
   3.543940672625*^9, 3.543940674640625*^9}, {3.543941687734375*^9, 
   3.543941688875*^9}, {3.54394268871875*^9, 3.5439427098125*^9}, {
   3.543992571140625*^9, 3.543992698390625*^9}, {3.54399279784375*^9, 
   3.543992837375*^9}, {3.543992930046875*^9, 3.5439929323125*^9}, 
   3.5439930185*^9, {3.543993050890625*^9, 3.543993052359375*^9}, {
   3.5439934635625*^9, 3.54399346496875*^9}, {3.543993595640625*^9, 
   3.543993685890625*^9}, {3.543994378390625*^9, 3.543994378765625*^9}, {
   3.5439944919375*^9, 3.54399452440625*^9}, {3.543995139578125*^9, 
   3.5439951578125*^9}, {3.543995195953125*^9, 3.54399520209375*^9}, {
   3.543995261765625*^9, 3.543995287125*^9}, 3.543995318765625*^9, {
   3.543995576640625*^9, 3.543995624859375*^9}, {3.543998584859375*^9, 
   3.5439985866875*^9}, {3.543999007265625*^9, 3.5439990303125*^9}, {
   3.543999404953125*^9, 3.543999458609375*^9}, {3.54399962634375*^9, 
   3.54399962771875*^9}, {3.543999843171875*^9, 3.54399985825*^9}, {
   3.543999902234375*^9, 3.543999911140625*^9}, {3.544000298109375*^9, 
   3.54400030171875*^9}, {3.544000338109375*^9, 3.544000338578125*^9}, {
   3.544000402265625*^9, 3.544000474484375*^9}, {3.54400061553125*^9, 
   3.544000648890625*^9}, {3.5440172299507804`*^9, 3.5440172432945304`*^9}, {
   3.5440175193257804`*^9, 3.5440175197632804`*^9}, {3.544024519875*^9, 
   3.544024574796875*^9}, {3.544027078015625*^9, 3.54402708315625*^9}, {
   3.5440272435625*^9, 3.544027253953125*^9}, 3.5440273164375*^9, 
   3.544028382484375*^9, {3.5440286060625*^9, 3.544028607625*^9}, {
   3.54402876821875*^9, 3.544028769421875*^9}, 3.54402980934375*^9, 
   3.544030363421875*^9, {3.5440305669375*^9, 3.5440307275625*^9}, 
   3.544036773828125*^9, {3.544036812078125*^9, 3.5440368325625*^9}, {
   3.54403691984375*^9, 3.54403693046875*^9}, {3.544037263109375*^9, 
   3.54403728965625*^9}, {3.544038831390625*^9, 3.54403883640625*^9}, {
   3.544038988984375*^9, 3.5440389911875*^9}, {3.5440392266875*^9, 
   3.5440392663125*^9}, {3.544040878515625*^9, 3.5440409154375*^9}, {
   3.544041553703125*^9, 3.544041554953125*^9}, 3.544041674765625*^9, {
   3.54404190571875*^9, 3.544041976921875*^9}, {3.54404237690625*^9, 
   3.544042378375*^9}, {3.54404303334375*^9, 3.544043035984375*^9}, {
   3.544043541984375*^9, 3.54404354353125*^9}, {3.544044046609375*^9, 
   3.544044077796875*^9}, {3.544044123703125*^9, 3.544044162140625*^9}, {
   3.544044193828125*^9, 3.544044214609375*^9}, {3.544044365953125*^9, 
   3.544044409921875*^9}, {3.54404444221875*^9, 3.54404446321875*^9}, {
   3.544044541578125*^9, 3.5440445428125*^9}, {3.54404526059375*^9, 
   3.544045266625*^9}, {3.544045337078125*^9, 3.544045343921875*^9}, {
   3.54404627565625*^9, 3.5440463379375*^9}, {3.544046564984375*^9, 
   3.54404659425*^9}, {3.544046755875*^9, 3.54404677546875*^9}, {
   3.54404685303125*^9, 3.544046897640625*^9}, {3.5440469305625*^9, 
   3.544046979421875*^9}, {3.54404721321875*^9, 3.54404725378125*^9}, {
   3.5440473528125*^9, 3.544047354796875*^9}, {3.544047404359375*^9, 
   3.544047417609375*^9}, {3.544047588203125*^9, 3.54404762125*^9}, 
   3.544047693234375*^9, 3.5440487963125*^9, {3.544049647296875*^9, 
   3.544049657953125*^9}, {3.544049729453125*^9, 3.54404981478125*^9}, {
   3.54404991921875*^9, 3.544049982390625*^9}, {3.544050682046875*^9, 
   3.544050683171875*^9}, {3.54405072178125*^9, 3.5440507768125*^9}, {
   3.5440508546875*^9, 3.5440508708125*^9}, {3.54405090440625*^9, 
   3.5440509908125*^9}, {3.544051218484375*^9, 3.544051364859375*^9}, {
   3.544051412109375*^9, 3.544051476046875*^9}, {3.5440515980625*^9, 
   3.544051853859375*^9}, 3.544054963734375*^9, {3.5440552776875*^9, 
   3.544055289734375*^9}, {3.544055325046875*^9, 3.544055376234375*^9}, {
   3.544056237046875*^9, 3.544056238890625*^9}, {3.544056635125*^9, 
   3.54405664940625*^9}, {3.54408467446875*^9, 3.544084696078125*^9}, {
   3.544084735703125*^9, 3.54408474546875*^9}, 3.544084776546875*^9, {
   3.54408540571875*^9, 3.54408542459375*^9}, 3.544085859484375*^9, {
   3.544087297109375*^9, 3.5440873108125*^9}, 3.544087340859375*^9, {
   3.544202187625*^9, 3.544202225078125*^9}, {3.544202424234375*^9, 
   3.5442024358125*^9}, {3.5442027099375*^9, 3.544202749890625*^9}, {
   3.544203878546875*^9, 3.54420389184375*^9}, {3.54420413796875*^9, 
   3.5442041591875*^9}, {3.544321257734375*^9, 3.544321268453125*^9}, {
   3.544321376546875*^9, 3.544321415265625*^9}, {3.5443214571875*^9, 
   3.544321481734375*^9}, {3.544345101609375*^9, 3.544345105265625*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulation", "Section",
 PageBreakBelow->False,
 CellChangeTimes->{{3.543578316765625*^9, 3.543578396*^9}, {
  3.543579634015625*^9, 3.54357963603125*^9}, {3.5435865389375*^9, 
  3.54358655478125*^9}, {3.543599423484375*^9, 3.543599450234375*^9}, {
  3.543605273546875*^9, 3.543605274796875*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Deploy", "@", 
  RowBox[{"Panel", "[", " ", 
   RowBox[{"Row", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Column", "@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Panel", "[", "\[IndentingNewLine]", 
          RowBox[{"Column", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Row", "@", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"\"\<Frame: \>\"", ",", "\[IndentingNewLine]", 
                 RowBox[{"PopupMenu", "[", " ", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", " ", "frameOfRef"}], ",", " ", 
                   RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"BodyFixed", "\[Rule]", "\"\<Body-fixed\>\""}], 
                    ",", " ", 
                    RowBox[{"Inertial", "\[Rule]", "\"\<Inertial\>\""}]}], 
                    " ", "}"}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
                 "\"\< ,  Gyroscopic effects: \>\"", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PopupMenu", "[", " ", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", " ", "gyroEffects"}], ",", " ", 
                   RowBox[{"{", " ", 
                    RowBox[{"Include", ",", "Ignore"}], " ", "}"}]}], " ", 
                  "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Row", "@", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<Integrator: \>\"", "\[IndentingNewLine]", 
                  RowBox[{"PopupMenu", "[", " ", 
                   RowBox[{
                    RowBox[{"Dynamic", "@", " ", "odeIntegrator"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{
                    "rk4$stepper", "\[Rule]", "\"\<Runge-Kutta 4\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "semiImplicitEuler$stepper", "\[Rule]", 
                    "\"\<Semi-Implicit Euler\>\""}]}], " ", "}"}]}], " ", 
                   "]"}]}], ",", "\[IndentingNewLine]", "\"\< ,  h = \>\"", 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"PopupMenu", "[", " ", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", " ", "h"}], ",", " ", 
                   RowBox[{"{", " ", 
                    RowBox[{
                    "0.01", ",", " ", "0.005", ",", " ", "0.002", ",", 
                    "0.001"}], "}"}]}], " ", "]"}], ",", 
                 "\[IndentingNewLine]", "\"\< s\>\""}], "\[IndentingNewLine]",
                 "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", " ", 
            RowBox[{"Spacings", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0.8"}], "}"}]}]}], "]"}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Button", "[", " ", 
             RowBox[{"\"\<  Initialize  \>\"", ",", 
              RowBox[{"solverInit", " ", "[", "]"}]}], " ", "]"}], ",", 
            "\"\<  \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"Button", "[", " ", 
             RowBox[{"\"\<  Single Step  \>\"", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"runSimulation", " ", "=", " ", "True"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"solverStep", " ", "[", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"runSimulation", "=", "False"}]}]}], " ", "]"}], ",", 
            "\"\<  \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"Button", "[", " ", 
             RowBox[{"\"\<  Run Simulation  \>\"", ",", 
              RowBox[{"solverRun", "[", "True", "]"}]}], " ", "]"}], ",", 
            "\"\<  \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"Button", "[", " ", 
             RowBox[{"\"\<  Cancel  \>\"", ",", " ", 
              RowBox[{"runSimulation", " ", "=", " ", "False"}]}], " ", 
             "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]",
         "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Style", "[", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Dynamic", "[", " ", 
             RowBox[{"If", "[", " ", 
              RowBox[{
              "runSimulation", ",", " ", "\[IndentingNewLine]", 
               "\"\< Running...\>\"", ",", " ", "\"\< Stopped.\>\"", " ", ",",
                " ", "\"\< (Uninitialized)\>\""}], "]"}], " ", "]"}], ",", 
            "Red"}], " ", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Style", "[", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Dynamic", "[", " ", 
             RowBox[{"\"\< t = \>\"", "<>", "  ", 
              RowBox[{"ToString", "@", "\[IndentingNewLine]", 
               RowBox[{"NumberForm", "[", " ", 
                RowBox[{
                 RowBox[{"N", "@", "t"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"10", ",", "3"}], "}"}], ",", 
                 RowBox[{"NumberPadding", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], " ", 
                "]"}]}], "\[IndentingNewLine]", "<>", " ", 
              "\"\< s,  \!\(\*SubscriptBox[\(E\), \(tot\)]\) = \>\"", "<>", 
              "  ", 
              RowBox[{"ToString", "@", "\[IndentingNewLine]", 
               RowBox[{"NumberForm", "[", " ", 
                RowBox[{
                 RowBox[{"N", "@", "Etot"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"10", ",", "3"}], "}"}], ",", 
                 RowBox[{"NumberPadding", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], " ", 
                "]"}]}], "\[IndentingNewLine]", "<>", " ", "\"\< J\>\""}], 
             " ", "]"}], ",", " ", "Blue", ",", " ", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Courier\>\""}]}], " ", 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Style", "[", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Dynamic", "[", " ", 
             RowBox[{
             "\"\< |\!\(\*SubscriptBox[OverscriptBox[\(\[Omega]\), \(\
\[RightVector]\)], \(\(\\\ \)\(world\)\)]\)| = \>\"", "<>", "  ", 
              RowBox[{"ToString", "@", "\[IndentingNewLine]", 
               RowBox[{"NumberForm", "[", " ", 
                RowBox[{
                 RowBox[{"N", "@", 
                  RowBox[{"If", "[", " ", 
                   RowBox[{
                    RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}], ",", 
                    " ", "\[Omega]", ",", 
                    RowBox[{"\[CapitalStigma]T", "@", "\[Omega]"}]}], " ", 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"5", ",", "1"}], "}"}], ",", 
                 RowBox[{"NumberPadding", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\< \>\"", ",", "\"\<0\>\""}], "}"}]}]}], " ", 
                "]"}]}], "\[IndentingNewLine]", "<>", " ", 
              "\"\< \!\(\*SuperscriptBox[\(s\), \(-1\)]\)\>\""}], " ", "]"}], 
            ",", " ", "Blue", ",", " ", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Courier\>\""}]}], " ", 
           "]"}], ",", "\n", "\t\t", 
          RowBox[{"Style", "[", " ", 
           RowBox[{
            RowBox[{"Dynamic", "[", " ", 
             RowBox[{
             "\"\< |\!\(\*SubscriptBox[OverscriptBox[\(L\), \
\(\[RightVector]\)], \(\(\\\ \)\(world\)\)]\)| = \>\"", "<>", "  ", 
              RowBox[{"ToString", "@", "\[IndentingNewLine]", 
               RowBox[{"NumberForm", "[", " ", 
                RowBox[{
                 RowBox[{"N", "@", 
                  RowBox[{"If", "[", " ", 
                   RowBox[{
                    RowBox[{"frameOfRef", " ", "===", " ", "Inertial"}], ",", 
                    " ", "L", ",", 
                    RowBox[{"\[CapitalStigma]T", "@", "L"}]}], " ", "]"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"5", ",", "1"}], "}"}], ",", 
                 RowBox[{"NumberPadding", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\< \>\"", ",", "\"\<0\>\""}], "}"}]}]}], " ", 
                "]"}]}], "\[IndentingNewLine]", "<>", " ", 
              "\"\< kg\[MediumSpace]\!\(\*SuperscriptBox[\(m\), \(2\)]\)\
\[MediumSpace]\!\(\*SuperscriptBox[\(s\), \(-1\)]\)\>\""}], " ", "]"}], ",", 
            " ", "Blue", ",", " ", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Courier\>\""}]}], " ", 
           "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
        " ", 
        RowBox[{"Spacings", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1", ",", " ", 
             RowBox[{"{", "0.5", "}"}]}], "}"}]}], "}"}]}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.54358603975*^9, 3.543586070078125*^9}, {
   3.543586198546875*^9, 3.543586199015625*^9}, {3.543586245921875*^9, 
   3.543586266359375*^9}, {3.543586495640625*^9, 3.54358649671875*^9}, {
   3.54358671259375*^9, 3.543586736375*^9}, {3.54358714584375*^9, 
   3.543587158328125*^9}, {3.543587218265625*^9, 3.543587218796875*^9}, {
   3.54358851803125*^9, 3.543588527125*^9}, {3.54358962184375*^9, 
   3.543589622515625*^9}, {3.54359040134375*^9, 3.543590506*^9}, {
   3.54359057521875*^9, 3.543590579265625*^9}, {3.543590617171875*^9, 
   3.543590665953125*^9}, {3.54359895946875*^9, 3.543598985*^9}, {
   3.54359903675*^9, 3.543599046703125*^9}, {3.54360004015625*^9, 
   3.543600046609375*^9}, {3.54360130125*^9, 3.54360130303125*^9}, 
   3.54360150665625*^9, {3.54360224290625*^9, 3.543602265734375*^9}, {
   3.54360233040625*^9, 3.543602355296875*^9}, {3.543604597734375*^9, 
   3.543604598046875*^9}, {3.5436048019375*^9, 3.54360482784375*^9}, {
   3.54402868725*^9, 3.54402868834375*^9}, {3.5440369115*^9, 
   3.544036915171875*^9}, {3.544036975109375*^9, 3.544036977625*^9}, {
   3.5440370431875*^9, 3.544037044015625*^9}, {3.54403708596875*^9, 
   3.544037189984375*^9}, {3.544039853375*^9, 3.54403989434375*^9}, {
   3.544039925515625*^9, 3.54404000590625*^9}, {3.544040103953125*^9, 
   3.544040129125*^9}, {3.544040165171875*^9, 3.544040171390625*^9}, {
   3.544040358140625*^9, 3.5440403650625*^9}, {3.544040474609375*^9, 
   3.544040507046875*^9}, {3.544040555671875*^9, 3.544040579265625*^9}, {
   3.54404211515625*^9, 3.544042145078125*^9}, {3.54404231565625*^9, 
   3.54404235359375*^9}, {3.544042386*^9, 3.5440423991875*^9}, {
   3.54405002415625*^9, 3.54405019025*^9}, {3.544050618328125*^9, 
   3.544050630328125*^9}, {3.544052072109375*^9, 3.544052074859375*^9}, 
   3.544053833296875*^9, {3.54405403025*^9, 3.544054038328125*^9}, {
   3.544054764703125*^9, 3.54405477446875*^9}, 3.54408549115625*^9, {
   3.54408556340625*^9, 3.544085614171875*^9}, {3.544085949625*^9, 
   3.54408622921875*^9}, {3.54408627590625*^9, 3.544086440625*^9}, {
   3.544086476296875*^9, 3.54408656228125*^9}, {3.544086592890625*^9, 
   3.544086758828125*^9}, {3.544086848375*^9, 3.54408702396875*^9}, {
   3.5440871210625*^9, 3.54408713896875*^9}, {3.544087180953125*^9, 
   3.5440872794375*^9}, {3.544089056078125*^9, 3.54408912734375*^9}, {
   3.544089214921875*^9, 3.544089228578125*^9}, {3.54408928296875*^9, 
   3.544089309625*^9}, 3.544089426453125*^9, {3.54408948928125*^9, 
   3.54408949128125*^9}, {3.544089720578125*^9, 3.544089732453125*^9}, {
   3.544089807578125*^9, 3.544089831125*^9}, {3.544089951171875*^9, 
   3.544089952328125*^9}, {3.544093037*^9, 3.544093269796875*^9}, {
   3.544093750515625*^9, 3.54409375153125*^9}, {3.544093850765625*^9, 
   3.544093927265625*^9}, {3.544097661515625*^9, 3.544097663828125*^9}, {
   3.544097958328125*^9, 3.544098152765625*^9}, {3.5440981914375*^9, 
   3.5440982960625*^9}, {3.544098406640625*^9, 3.54409858815625*^9}, {
   3.544204838453125*^9, 3.544204850828125*^9}}],

Cell[BoxData[
 StyleBox[
  PanelBox[
   InterpretationBox[
    RowBox[{
     TagBox[GridBox[{
        {
         PanelBox[
          TagBox[GridBox[{
             {
              InterpretationBox[
               RowBox[{"\<\"Frame: \"\>", "\[InvisibleSpace]", 
                
                PopupMenuBox[
                 Dynamic[$CellContext`frameOfRef], {$CellContext`BodyFixed->"\
\<\"Body-fixed\"\>", $CellContext`Inertial->"\<\"Inertial\"\>"}], 
                "\[InvisibleSpace]", "\<\" ,  Gyroscopic effects: \"\>", 
                "\[InvisibleSpace]", 
                
                PopupMenuBox[
                 Dynamic[$CellContext`gyroEffects], {$CellContext`Include->
                 "Include", $CellContext`Ignore->"Ignore"}]}],
               Row[{"Frame: ", 
                 PopupMenu[
                  
                  Dynamic[$CellContext`frameOfRef], {$CellContext`BodyFixed -> 
                   "Body-fixed", $CellContext`Inertial -> "Inertial"}], 
                 " ,  Gyroscopic effects: ", 
                 PopupMenu[
                  
                  Dynamic[$CellContext`gyroEffects], {$CellContext`Include, \
$CellContext`Ignore}]}]]},
             {
              InterpretationBox[
               RowBox[{
                RowBox[{"\<\"Integrator: \"\>", " ", 
                 
                 PopupMenuBox[
                  Dynamic[$CellContext`odeIntegrator], \
{$CellContext`rk4$stepper->"\<\"Runge-Kutta 4\"\>", \
$CellContext`semiImplicitEuler$stepper->"\<\"Semi-Implicit Euler\"\>"}]}], 
                "\[InvisibleSpace]", "\<\" ,  h = \"\>", "\[InvisibleSpace]", 
                
                
                PopupMenuBox[Dynamic[$CellContext`h], {0.01->"0.01`", 0.005->
                 "0.005`", 0.002->"0.002`", 0.001->"0.001`"}], 
                "\[InvisibleSpace]", "\<\" s\"\>"}],
               Row[{"Integrator: " PopupMenu[
                   
                   Dynamic[$CellContext`odeIntegrator], \
{$CellContext`rk4$stepper -> 
                    "Runge-Kutta 4", $CellContext`semiImplicitEuler$stepper -> 
                    "Semi-Implicit Euler"}], " ,  h = ", 
                 PopupMenu[
                  Dynamic[$CellContext`h], {0.01, 0.005, 0.002, 0.001}], 
                 " s"}]]}
            },
            ColumnsEqual->False,
            GridBoxAlignment->{"Columns" -> {{Left}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {{1}}, "Rows" -> {{0.8}}},
            RowsEqual->False],
           "Column"]]},
        {
         InterpretationBox[
          RowBox[{
           ButtonBox["\<\"  Initialize  \"\>",
            Appearance->Automatic,
            ButtonFrame->"DialogBox",
            ButtonFunction:>$CellContext`solverInit[],
            Evaluator->Automatic,
            Method->"Preemptive"], "\[InvisibleSpace]", "\<\"  \"\>", 
           "\[InvisibleSpace]", 
           ButtonBox["\<\"  Single Step  \"\>",
            Appearance->Automatic,
            ButtonFrame->"DialogBox",
            
            ButtonFunction:>($CellContext`runSimulation = 
              True; $CellContext`solverStep[]; $CellContext`runSimulation = 
              False),
            Evaluator->Automatic,
            Method->"Preemptive"], "\[InvisibleSpace]", "\<\"  \"\>", 
           "\[InvisibleSpace]", 
           ButtonBox["\<\"  Run Simulation  \"\>",
            Appearance->Automatic,
            ButtonFrame->"DialogBox",
            ButtonFunction:>$CellContext`solverRun[True],
            Evaluator->Automatic,
            Method->"Preemptive"], "\[InvisibleSpace]", "\<\"  \"\>", 
           "\[InvisibleSpace]", 
           ButtonBox["\<\"  Cancel  \"\>",
            Appearance->Automatic,
            ButtonFrame->"DialogBox",
            ButtonFunction:>($CellContext`runSimulation = False),
            Evaluator->Automatic,
            Method->"Preemptive"]}],
          Row[{
            Button["  Initialize  ", 
             $CellContext`solverInit[]], "  ", 
            Button[
            "  Single Step  ", $CellContext`runSimulation = 
              True; $CellContext`solverStep[]; $CellContext`runSimulation = 
              False], "  ", 
            Button["  Run Simulation  ", 
             $CellContext`solverRun[True]], "  ", 
            Button["  Cancel  ", $CellContext`runSimulation = False]}]]}
       },
       ColumnsEqual->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       
       RowsEqual->False],
      "Column"], "\[InvisibleSpace]", 
     TagBox[GridBox[{
        {
         StyleBox[
          DynamicBox[ToBoxes[
            
            If[$CellContext`runSimulation, " Running...", " Stopped.", 
             " (Uninitialized)"], StandardForm],
           ImageSizeCache->{74., {2., 10.}}],
          StripOnInput->False,
          FrontFaceColor->RGBColor[1, 0, 0],
          BackFaceColor->RGBColor[1, 0, 0],
          GraphicsColor->RGBColor[1, 0, 0],
          FontColor->RGBColor[1, 0, 0]]},
        {
         StyleBox[
          DynamicBox[ToBoxes[
            StringJoin[" t = ", 
             ToString[
              NumberForm[
               N[$CellContext`t], {10, 3}, NumberPadding -> {"", "0"}]], 
             " s,  \!\(\*SubscriptBox[\(E\), \(tot\)]\) = ", 
             ToString[
              NumberForm[
               N[$CellContext`Etot], {10, 3}, NumberPadding -> {"", "0"}]], 
             " J"], StandardForm],
           ImageSizeCache->{168.5, {3., 8.}}],
          StripOnInput->False,
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontFamily->"Courier",
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          DynamicBox[ToBoxes[
            StringJoin[
            " |\!\(\*SubscriptBox[OverscriptBox[\(\[Omega]\), \
\(\[RightVector]\)], \(\(\\ \)\(world\)\)]\)| = ", 
             ToString[
              NumberForm[
               N[
                
                If[$CellContext`frameOfRef === $CellContext`Inertial, \
$CellContext`\[Omega], 
                 $CellContext`\[CapitalStigma]T[$CellContext`\[Omega]]]], {5, 
               1}, NumberPadding -> {" ", "0"}]], 
             " \!\(\*SuperscriptBox[\(s\), \(-1\)]\)"], StandardForm],
           ImageSizeCache->{151., {4.25, 12.75}}],
          StripOnInput->False,
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontFamily->"Courier",
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          DynamicBox[ToBoxes[
            StringJoin[
            " |\!\(\*SubscriptBox[OverscriptBox[\(L\), \(\[RightVector]\)], \
\(\(\\ \)\(world\)\)]\)| = ", 
             ToString[
              NumberForm[
               N[
                
                If[$CellContext`frameOfRef === $CellContext`Inertial, \
$CellContext`L, 
                 $CellContext`\[CapitalStigma]T[$CellContext`L]]], {5, 1}, 
               NumberPadding -> {" ", "0"}]], 
             " kg\[MediumSpace]\!\(\*SuperscriptBox[\(m\), \(2\)]\)\
\[MediumSpace]\!\(\*SuperscriptBox[\(s\), \(-1\)]\)"], StandardForm],
           ImageSizeCache->{186.125, {4.25, 13.}}],
          StripOnInput->False,
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontFamily->"Courier",
          FontColor->RGBColor[0, 0, 1]]}
       },
       ColumnsEqual->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       
       GridBoxSpacings->{"Columns" -> {{1}}, "Rows" -> {0, 1, {0.5}}},
       RowsEqual->False],
      "Column"]}],
    Row[{
      Column[{
        Panel[
         Column[{
           Row[{"Frame: ", 
             PopupMenu[
              
              Dynamic[$CellContext`frameOfRef], {$CellContext`BodyFixed -> 
               "Body-fixed", $CellContext`Inertial -> "Inertial"}], 
             " ,  Gyroscopic effects: ", 
             PopupMenu[
              
              Dynamic[$CellContext`gyroEffects], {$CellContext`Include, \
$CellContext`Ignore}]}], 
           Row[{"Integrator: " PopupMenu[
               
               Dynamic[$CellContext`odeIntegrator], {$CellContext`rk4$stepper -> 
                "Runge-Kutta 4", $CellContext`semiImplicitEuler$stepper -> 
                "Semi-Implicit Euler"}], " ,  h = ", 
             PopupMenu[
              Dynamic[$CellContext`h], {0.01, 0.005, 0.002, 0.001}], " s"}]}, 
          Spacings -> {1, 0.8}]], 
        Row[{
          Button["  Initialize  ", 
           $CellContext`solverInit[]], "  ", 
          Button[
          "  Single Step  ", $CellContext`runSimulation = 
            True; $CellContext`solverStep[]; $CellContext`runSimulation = 
            False], "  ", 
          Button["  Run Simulation  ", 
           $CellContext`solverRun[True]], "  ", 
          Button["  Cancel  ", $CellContext`runSimulation = False]}]}], 
      Column[{
        Style[
         Dynamic[
          
          If[$CellContext`runSimulation, " Running...", " Stopped.", 
           " (Uninitialized)"]], 
         RGBColor[1, 0, 0]], 
        Style[
         Dynamic[
          StringJoin[" t = ", 
           ToString[
            NumberForm[
             N[$CellContext`t], {10, 3}, NumberPadding -> {"", "0"}]], 
           " s,  \!\(\*SubscriptBox[\(E\), \(tot\)]\) = ", 
           ToString[
            NumberForm[
             N[$CellContext`Etot], {10, 3}, NumberPadding -> {"", "0"}]], 
           " J"]], 
         RGBColor[0, 0, 1], FontFamily -> "Courier"], 
        Style[
         Dynamic[
          StringJoin[
          " |\!\(\*SubscriptBox[OverscriptBox[\(\[Omega]\), \
\(\[RightVector]\)], \(\(\\ \)\(world\)\)]\)| = ", 
           ToString[
            NumberForm[
             N[
              
              If[$CellContext`frameOfRef === $CellContext`Inertial, \
$CellContext`\[Omega], 
               $CellContext`\[CapitalStigma]T[$CellContext`\[Omega]]]], {5, 
             1}, NumberPadding -> {" ", "0"}]], 
           " \!\(\*SuperscriptBox[\(s\), \(-1\)]\)"]], 
         RGBColor[0, 0, 1], FontFamily -> "Courier"], 
        Style[
         Dynamic[
          StringJoin[
          " |\!\(\*SubscriptBox[OverscriptBox[\(L\), \(\[RightVector]\)], \
\(\(\\ \)\(world\)\)]\)| = ", 
           ToString[
            NumberForm[
             N[
              
              If[$CellContext`frameOfRef === $CellContext`Inertial, \
$CellContext`L, 
               $CellContext`\[CapitalStigma]T[$CellContext`L]]], {5, 1}, 
             NumberPadding -> {" ", "0"}]], 
           " kg\[MediumSpace]\!\(\*SuperscriptBox[\(m\), \(2\)]\)\
\[MediumSpace]\!\(\*SuperscriptBox[\(s\), \(-1\)]\)"]], 
         RGBColor[0, 0, 1], FontFamily -> "Courier"]}, 
       Spacings -> {1, {0, 1, {0.5}}}]}]]],
  Deployed->True,
  StripOnInput->False]], "Output",
 CellLabelAutoDelete->True,
 CellChangeTimes->{3.54420485403125*^9}]
}, {2}]],

Cell[BoxData[
 RowBox[{"solverRun", " ", "[", "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.54360219603125*^9, 3.543602203984375*^9}, {
   3.54360225303125*^9, 3.54360228553125*^9}, {3.543602360140625*^9, 
   3.5436023603125*^9}, {3.543604419875*^9, 3.543604422*^9}, {
   3.543604543984375*^9, 3.5436045616875*^9}, {3.543605088828125*^9, 
   3.543605135921875*^9}, {3.544027606171875*^9, 3.5440276113125*^9}, {
   3.54402868309375*^9, 3.544028683125*^9}, {3.5440303653125*^9, 
   3.544030419515625*^9}, {3.544036777546875*^9, 3.544036779703125*^9}, {
   3.544036837515625*^9, 3.544036837625*^9}, {3.544036953484375*^9, 
   3.54403695746875*^9}, {3.544037029375*^9, 3.54403703265625*^9}, {
   3.544037286015625*^9, 3.54403728684375*^9}, 3.544037353125*^9, {
   3.5440373913125*^9, 3.54403741271875*^9}, 3.544040389203125*^9, {
   3.544042506390625*^9, 3.54404257396875*^9}, {3.544043415*^9, 
   3.5440434381875*^9}, 3.544043522921875*^9, 3.544045302734375*^9, {
   3.544045758921875*^9, 3.544045769265625*^9}, {3.5440530878125*^9, 
   3.54405309090625*^9}, 3.544053301171875*^9, {3.544053344375*^9, 
   3.544053364796875*^9}, {3.544053678546875*^9, 3.5440536851875*^9}, {
   3.54405373484375*^9, 3.54405374425*^9}, {3.54405409078125*^9, 
   3.544054091375*^9}, {3.544054306140625*^9, 3.544054312765625*^9}, {
   3.544055032078125*^9, 3.54405503265625*^9}, {3.54409259871875*^9, 
   3.544092599515625*^9}},
 CellTags->"RUNSIMULATION"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
ScreenStyleEnvironment->"Presentation",
WindowSize->{909, 1076},
WindowMargins->{{Automatic, 371}, {Automatic, -1}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"PrintingMargins"->{{56.6875, 56.6875}, {28.375, \
56.6875}}},
ShowSelection->True,
FrontEndVersion->"6.0 for Microsoft Windows (32-bit) (May 21, 2008)",
StyleDefinitions->"UCM-Stylesheet.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "RUNSIMULATION"->{
  Cell[147958, 3294, 1443, 23, 29, "Input",
   CellTags->"RUNSIMULATION"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"RUNSIMULATION", 149965, 3338}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[590, 23, 478, 7, 67, "Title"],
Cell[1071, 32, 560, 11, 57, "Text"],
Cell[CellGroupData[{
Cell[1656, 47, 416, 6, 63, "Section"],
Cell[2075, 55, 472, 11, 29, "Input"],
Cell[CellGroupData[{
Cell[2572, 70, 325, 5, 45, "Subsection"],
Cell[2900, 77, 291, 4, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[3216, 85, 1801, 47, 77, "TextGroup"],
Cell[5020, 134, 656, 10, 29, "Input"],
Cell[5679, 146, 1333, 26, 50, "Input"],
Cell[7015, 174, 304, 6, 33, "Text"]
}, Open  ]],
Cell[7334, 183, 342, 5, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[7701, 192, 1137, 24, 53, "TextGroup"],
Cell[8841, 218, 728, 14, 29, "Input"],
Cell[9572, 234, 999, 20, 50, "Input"]
}, Open  ]],
Cell[10586, 257, 277, 4, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[10888, 265, 812, 26, 29, "TextGroup"],
Cell[11703, 293, 1202, 20, 29, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12942, 318, 382, 7, 33, "TextGroup"],
Cell[13327, 327, 1084, 16, 29, "Input"]
}, Open  ]],
Cell[14426, 346, 462, 7, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[14913, 357, 1435, 39, 80, "TextGroup"],
Cell[16351, 398, 3419, 85, 504, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19807, 488, 343, 6, 33, "TextGroup"],
Cell[20153, 496, 1163, 20, 29, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21353, 521, 781, 14, 57, "TextGroup"],
Cell[22137, 537, 1195, 28, 90, "Input"]
}, Open  ]],
Cell[23347, 568, 302, 4, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[23674, 576, 684, 14, 29, "TextGroup"],
Cell[24361, 592, 1123, 16, 29, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25521, 613, 339, 5, 33, "TextGroup"],
Cell[25863, 620, 1073, 16, 29, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26973, 641, 375, 5, 33, "TextGroup"],
Cell[27351, 648, 1121, 17, 29, "Input"]
}, Open  ]],
Cell[28487, 668, 825, 17, 33, "TextGroup",
 PageBreakBelow->False],
Cell[CellGroupData[{
Cell[29337, 689, 605, 12, 29, "TextGroup",
 PageBreakBelow->False],
Cell[29945, 703, 3305, 79, 268, "Input"]
}, Open  ]],
Cell[33265, 785, 883, 18, 33, "TextGroup",
 PageBreakBelow->False],
Cell[CellGroupData[{
Cell[34173, 807, 2330, 73, 101, "TextGroup",
 PageBreakBelow->False],
Cell[36506, 882, 5200, 105, 282, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41755, 993, 480, 7, 45, "Subsection"],
Cell[42238, 1002, 480, 9, 35, "Subsubsection",
 PageBreakBelow->False],
Cell[CellGroupData[{
Cell[42743, 1015, 504, 17, 53, "TextGroup",
 PageBreakBelow->False],
Cell[43250, 1034, 1546, 31, 29, "Input",
 PageBreakBelow->False],
Cell[44799, 1067, 308, 8, 29, "Input",
 PageBreakBelow->False],
Cell[45110, 1077, 1378, 22, 29, "Input",
 PageBreakBelow->False],
Cell[46491, 1101, 1324, 22, 29, "Input"]
}, Open  ]],
Cell[47830, 1126, 630, 10, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[48485, 1140, 623, 10, 29, "TextGroup"],
Cell[49111, 1152, 4564, 102, 250, "Input"]
}, Open  ]],
Cell[53690, 1257, 584, 8, 35, "Subsubsection",
 PageBreakBelow->False],
Cell[CellGroupData[{
Cell[54299, 1269, 651, 12, 29, "TextGroup",
 PageBreakBelow->False],
Cell[54953, 1283, 6507, 147, 507, "Input"]
}, Open  ]],
Cell[61475, 1433, 681, 11, 35, "Subsubsection",
 PageBreakBelow->False],
Cell[CellGroupData[{
Cell[62181, 1448, 697, 12, 29, "TextGroup",
 PageBreakBelow->False],
Cell[62881, 1462, 7250, 159, 629, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[70180, 1627, 785, 12, 45, "Subsection",
 PageBreakBelow->False],
Cell[70968, 1641, 660, 11, 35, "Subsubsection",
 PageBreakBelow->False],
Cell[CellGroupData[{
Cell[71653, 1656, 755, 23, 77, "TextGroup",
 PageBreakBelow->False],
Cell[72411, 1681, 8850, 202, 824, "Input",
 PageBreakAbove->False]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81310, 1889, 818, 12, 45, "Subsection",
 PageBreakBelow->False],
Cell[CellGroupData[{
Cell[82153, 1905, 467, 8, 35, "Subsubsection",
 PageBreakBelow->False],
Cell[82623, 1915, 14873, 300, 1067, "Input"]
}, Open  ]],
Cell[97511, 2218, 455, 8, 35, "Subsubsection",
 PageBreakBelow->False],
Cell[CellGroupData[{
Cell[97991, 2230, 417, 8, 53, "TextGroup",
 PageBreakBelow->False],
Cell[98411, 2240, 8693, 181, 791, "Input"]
}, Open  ]],
Cell[107119, 2424, 472, 7, 35, "Subsubsection",
 PageBreakBelow->False],
Cell[CellGroupData[{
Cell[107616, 2435, 388, 11, 29, "TextGroup",
 PageBreakBelow->False],
Cell[108007, 2448, 5973, 119, 510, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[114029, 2573, 830, 12, 45, "Subsection",
 PageBreakBelow->False],
Cell[CellGroupData[{
Cell[114884, 2589, 264, 5, 33, "TextGroup"],
Cell[115151, 2596, 8621, 154, 210, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[123833, 2757, 302, 5, 63, "Section",
 PageBreakBelow->False],
Cell[CellGroupData[{
Cell[124160, 2766, 12544, 237, 1144, "Input"],
Cell[136707, 3005, 11239, 286, 139, "Output"]
}, {2}]],
Cell[147958, 3294, 1443, 23, 29, "Input",
 CellTags->"RUNSIMULATION"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
