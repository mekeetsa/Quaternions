(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    121742,       2846]
NotebookOptionsPosition[    114583,       2622]
NotebookOutlinePosition[    115111,       2640]
CellTagsIndexPosition[    115068,       2637]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Quaternions \[MathematicaIcon]", "Title",
 CellChangeTimes->{{3.543548740015625*^9, 3.543548742328125*^9}, {
  3.543813987515625*^9, 3.543814005765625*^9}}],

Cell["Package for symbolic calculations with quaternions", "Subtitle",
 CellChangeTimes->{{3.5435489135*^9, 3.54354891884375*^9}, {3.543555725375*^9,
   3.543555727171875*^9}, {3.543813998015625*^9, 3.5438140225625*^9}, {
  3.5438588446875*^9, 3.543858864609375*^9}, {3.543858902984375*^9, 
  3.543858915328125*^9}, {3.543858947890625*^9, 3.543858949515625*^9}, {
  3.543859234328125*^9, 3.543859324953125*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"\n", 
     StyleBox["   ", "Comment"], 
     StyleBox[
      RowBox[{
      "Quaternions", " ", "package", " ", "implements", " ", "Hamilton"}], 
      "Comment"], 
     StyleBox["\[CloseCurlyQuote]", "Comment"]}], 
    StyleBox["s", "Comment"], 
    StyleBox[" ", "Comment"], 
    StyleBox["quaternion", "Comment"], 
    StyleBox[" ", "Comment"], 
    StyleBox[
     RowBox[{"algebra", ".", "\n", "   ", "This"}], "Comment"], 
    StyleBox[" ", "Comment"], 
    StyleBox["package", "Comment"], 
    StyleBox[" ", "Comment"], 
    StyleBox["mimics", "Comment"], 
    StyleBox[" ", "Comment"], 
    StyleBox["original", "Comment"], 
    StyleBox[" ", "Comment"], 
    StyleBox["Mathematica", "Comment"], 
    StyleBox[" ", "Comment"], 
    StyleBox[
     RowBox[{"Quaternions", ".", "m"}], "Comment"]}], 
   StyleBox[",", "Comment"], 
   StyleBox[" ", "Comment"], 
   StyleBox["however", "Comment"], 
   StyleBox[",", "Comment"], 
   StyleBox[" ", "Comment"], 
   StyleBox["\n", "Comment"], 
   StyleBox["   ", "Comment"], 
   StyleBox[
    RowBox[{
     RowBox[{
     "it", " ", "fixes", " ", "various", " ", "bugs", " ", "and", " ", "also",
       " ", "allows", " ", "symbolic", " ", "transformations"}], "\n", "   ", 
     RowBox[{
     "of", " ", "quaternions", " ", "to", " ", "more", " ", "extent", " ", 
      "than", " ", 
      RowBox[{"Mathematica", "'"}], "s", " ", 
      RowBox[{"original", ".", "\n", "   ", 
       RowBox[{"Author", ":", "  ", 
        RowBox[{"Mikica", " ", "B", " ", "Kocic"}]}]}]}], "\n", "   ", 
     RowBox[{"Version", ":", " ", "0.4"}]}], "Comment"], 
   StyleBox[",", "Comment"], 
   StyleBox[" ", "Comment"], 
   StyleBox[
    RowBox[{"2012", "-", "04", "-", "22"}], "Comment"]}], 
  StyleBox["\n", "Comment"], "*)"}]], "Code",
 CellChangeTimes->{{3.543548868578125*^9, 3.543548942078125*^9}, 
   3.5435557193125*^9, {3.543858823390625*^9, 3.54385882696875*^9}, {
   3.5438588700625*^9, 3.54385889934375*^9}, {3.543858956046875*^9, 
   3.543858988171875*^9}, {3.543859020078125*^9, 3.543859057921875*^9}, {
   3.543859135234375*^9, 3.54385922803125*^9}, {3.543859334671875*^9, 
   3.543859342703125*^9}, {3.543916503453125*^9, 3.543916554671875*^9}, {
   3.543996929453125*^9, 3.543996959828125*^9}, {3.5441193488125*^9, 
   3.5441193593125*^9}}],

Cell[CellGroupData[{

Cell["Begin Package", "Section"],

Cell[BoxData[
 RowBox[{"$Pre", " ", "=."}]], "Code"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", " ", "\"\<Quat`\>\"", " ", "]"}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.5435487485625*^9, 3.543548753375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unprotect", "[", " ", "Quat`\[ScriptCapitalQ]", " ", "]"}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.54354875590625*^9, 3.54354876540625*^9}, {
  3.543549298625*^9, 3.5435493226875*^9}, {3.543549467734375*^9, 
  3.54354949578125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", " ", "\"\<Quat`Private`*\>\"", " ", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", " ", "\"\<Quat`*\>\"", " ", "]"}], ";"}]}], "Code",
 CellChangeTimes->{{3.54354875590625*^9, 3.54354876540625*^9}, {
  3.543549298625*^9, 3.5435493226875*^9}, {3.54354947040625*^9, 
  3.543549478015625*^9}}],

Cell[CellGroupData[{

Cell["Exported Symbols", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalQ]", "::", "usage"}], " ", "=", " ", 
   "\"\<\[ScriptCapitalQ][w,x,y,z] represents the quaternion with real part w \
\\\n(also called scalar part) and imaginary part {x,y,z} (also called vector \
part)\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.543554486015625*^9}, {3.54355586803125*^9, 
   3.543556222953125*^9}, {3.543556253953125*^9, 3.5435563483125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalQ]Q", "::", "usage"}], " ", "=", " ", 
   "\"\<\[ScriptCapitalQ]Q[q] gives True if q is a quaternion, \\\nand False \
otherwise.\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.543554486015625*^9}, {3.54355586803125*^9, 
   3.543556222953125*^9}, {3.543556253953125*^9, 3.54355634921875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"To\[ScriptCapitalQ]", "::", "usage"}], " ", "=", " ", 
   "\"\<To\[ScriptCapitalQ][expr] transforms expr into a quaternion object if \
at all possible.\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.543554486015625*^9}, {3.54355586803125*^9, 
   3.543556222953125*^9}, {3.543556253953125*^9, 3.54355635003125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ScalarQ", "::", "usage"}], " ", "=", " ", 
   "\"\<ScalarQ[q] gives True if q is a scalar, and False otherwise.\>\""}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.543554486015625*^9}, {3.54355586803125*^9, 
   3.543556222953125*^9}, {3.543556253953125*^9, 3.543556350796875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ToList", "::", "usage"}], " ", "=", " ", 
   "\"\<ToList[q] gives components of q in a list\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.543554486015625*^9}, {3.54355586803125*^9, 
   3.543556222953125*^9}, {3.543556253953125*^9, 3.543556351875*^9}, {
   3.54356236125*^9, 3.543562364515625*^9}, 3.543562396765625*^9, {
   3.543909261078125*^9, 3.543909288390625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ToVector", "::", "usage"}], " ", "=", " ", 
   "\"\<ToVector[q] gives q as column vector matrix\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.543554486015625*^9}, {3.54355586803125*^9, 
   3.543556222953125*^9}, {3.543556253953125*^9, 3.543556351875*^9}, {
   3.54356236125*^9, 3.543562364515625*^9}, 3.543562396765625*^9, {
   3.543909261078125*^9, 3.543909303453125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ToMatrix", "::", "usage"}], " ", "=", " ", 
   "\"\<ToMatrix[q] gives matrix representation of quaternion q\>\""}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.543554486015625*^9}, {3.54355586803125*^9, 
   3.543556222953125*^9}, {3.543556253953125*^9, 3.543556351875*^9}, {
   3.54356236125*^9, 3.543562364515625*^9}, 3.543562396765625*^9, 
   3.543909261078125*^9, {3.543909305125*^9, 3.543909336421875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Abs$Im", "::", "usage"}], " ", "=", " ", 
   "\"\<Abs$Im[q] gives the absolute value of the vector quaternion part of \
q.\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.543554486015625*^9}, {3.54355586803125*^9, 
   3.543556222953125*^9}, {3.543556253953125*^9, 3.5435563526875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AdjustedSign$Im", "::", "usage"}], " ", "=", " ", 
   "\"\<AdjustedSign$Im[q] gives the Sign of the vector part of q, \\\n\
adjusted so its first non-zero part is positive.\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.543554486015625*^9}, {3.54355586803125*^9, 
   3.543556222953125*^9}, {3.543556253953125*^9, 3.5435563534375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NonCommutativeMultiply", "::", "usage"}], " ", "=", " ", 
   "\"\<Implements non-commuatative quaternion multiplication.\>\""}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.543554486015625*^9}, {3.54355586803125*^9, 
   3.543556222953125*^9}, {3.543556253953125*^9, 3.5435563534375*^9}, {
   3.543557527359375*^9, 3.5435575313125*^9}, {3.543576642421875*^9, 
   3.543576642921875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"To\[ScriptCapitalQ]$AngleAxis", "::", "usage"}], " ", "=", " ", 
   "\"\<To\[ScriptCapitalQ]$AngleAxis[\[Theta],{ux,uy,uz}] transforms axis \!\
\(\*
StyleBox[\"u\",
FontWeight->\"Bold\"]\) and angle \[Theta] into quaternion\>\""}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.543554486015625*^9}, {3.54355586803125*^9, 
   3.543556222953125*^9}, {3.543556253953125*^9, 3.5435563534375*^9}, {
   3.543557527359375*^9, 3.5435575313125*^9}, {3.543576642421875*^9, 
   3.543576663390625*^9}, {3.543576693515625*^9, 3.54357672278125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"To\[ScriptCapitalQ]", "::", "invargs"}], " ", "=", " ", 
  "\"\<To\[ScriptCapitalQ]: failed to construct \[ScriptCapitalQ] from \
argument:\\n args \[Equal] `1`\>\""}]], "Code",
 CellChangeTimes->{{3.543582541375*^9, 3.543582584140625*^9}, {
  3.54381678215625*^9, 3.543816787078125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RotationMatrix4", "::", "usage"}], " ", "=", " ", 
  "\"\<RotationMatrix4[q] gives the 4\[Cross]4 rotation matrix for a \\\n\
counterclockwise 3D rotation around the quaterion q\>\""}]], "Code",
 CellChangeTimes->{{3.543582541375*^9, 3.543582584140625*^9}, {
  3.54381678215625*^9, 3.543816787078125*^9}, {3.543817169421875*^9, 
  3.543817208765625*^9}, {3.5438594978125*^9, 3.543859502890625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"QForm", "::", "usage"}], " ", "=", " ", 
  "\"\<QForm[q] prints with the elements of matrix or quaternion \\\narranged \
in a regular array.\>\""}]], "Code",
 CellChangeTimes->{{3.543582541375*^9, 3.543582584140625*^9}, {
  3.54381678215625*^9, 3.543816787078125*^9}, {3.543817169421875*^9, 
  3.543817208765625*^9}, {3.5438594978125*^9, 3.543859576828125*^9}, {
  3.543859611671875*^9, 3.543859612265625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Assert", "::", "usage"}], " ", "=", " ", 
  "\"\<QForm[q] prints with the elements of matrix or quaternion \\\narranged \
in a regular array.\>\""}]], "Code",
 CellChangeTimes->{{3.543582541375*^9, 3.543582584140625*^9}, {
  3.54381678215625*^9, 3.543816787078125*^9}, {3.543817169421875*^9, 
  3.543817208765625*^9}, {3.5438594978125*^9, 3.543859576828125*^9}, {
  3.543859611671875*^9, 3.543859612265625*^9}, {3.543859767703125*^9, 
  3.543859770171875*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Private Section", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", " ", "\"\<Quat`Private`\>\"", " ", "]"}], 
  ";"}]], "Code",
 CellChangeTimes->{3.543548824828125*^9}],

Cell[CellGroupData[{

Cell["Operators", "Subsection",
 CellChangeTimes->{{3.5435546385*^9, 3.543554640109375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Subscript", "[", " ", 
   RowBox[{
    RowBox[{"q_", " ", "?", "\[ScriptCapitalQ]Q"}], ",", " ", 
    RowBox[{"n_Integer", " ", "/;", " ", 
     RowBox[{
     "1", " ", "\[LessEqual]", " ", "n", " ", "\[LessEqual]", " ", "4"}]}]}], 
   " ", "]"}], " ", ":=", " ", 
  RowBox[{"q", "[", 
   RowBox[{"[", "n", "]"}], "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.543554528109375*^9}, {3.54355494028125*^9, 
   3.54355497740625*^9}, {3.54355655859375*^9, 3.543556570625*^9}, {
   3.543561473453125*^9, 3.543561480125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AngleBracket", "[", " ", 
   RowBox[{"q_", " ", "?", "\[ScriptCapitalQ]Q"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"Re", "[", "q", "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.54355453290625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OverVector", "[", " ", 
   RowBox[{"q_", " ", "?", "\[ScriptCapitalQ]Q"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"q", "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", "4"}], "]"}], "]"}], " ", "/.", " ", 
   RowBox[{"\[ScriptCapitalQ]", " ", "\[Rule]", " ", "List"}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.543554539015625*^9}, {3.5435545833125*^9, 
   3.543554610578125*^9}, {3.543561484390625*^9, 3.543561491328125*^9}, {
   3.543576395484375*^9, 3.543576396671875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OverHat", "[", " ", 
   RowBox[{"q_", " ", "?", "\[ScriptCapitalQ]Q"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"q", " ", "/", " ", 
   RowBox[{"Abs", "[", " ", "q", " ", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.543554578859375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SuperStar", "[", " ", 
   RowBox[{"q_", " ", "?", "\[ScriptCapitalQ]Q"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"Conjugate", "[", " ", "q", " ", "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.543554563703125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BracketingBar", "[", " ", 
   RowBox[{"q_", " ", "?", "\[ScriptCapitalQ]Q"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"Abs", "[", " ", "q", " ", "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355431221875*^9}, {
   3.54355448503125*^9, 3.5435545570625*^9}, {3.5440122183101554`*^9, 
   3.5440122194664054`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utility Functions", "Subsection"],

Cell[CellGroupData[{

Cell["Strip Output Label of Form Info", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetAttributes", "[", " ", 
   RowBox[{"TimeIt", ",", " ", "HoldAll"}], " ", "]"}], ";"}]], "Code"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TimeIt", "[", " ", "expr_", " ", "]"}], " ", ":=", "\n", 
   RowBox[{"Module", "[", " ", "\n", "  ", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"result", " ", "=", " ", "expr"}], ",", " ", "out", ",", " ", 
       "form"}], " ", "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"TrueQ", "[", " ", 
         RowBox[{"MemberQ", "[", " ", 
          RowBox[{"$OutputForms", ",", " ", 
           RowBox[{"Head", "[", "result", "]"}]}], " ", "]"}], " ", "]"}], 
        ",", "\n", "    ", 
        RowBox[{"(*", " ", "Then", " ", "*)"}], " ", 
        RowBox[{
         RowBox[{"out", " ", "=", " ", 
          RowBox[{"First", "[", "result", "]"}]}], ";", " ", 
         RowBox[{"form", " ", "=", " ", 
          RowBox[{"\"\<//\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", " ", 
            RowBox[{"Head", "[", "result", "]"}], " ", "]"}]}]}]}], ",", " ", 
        "\n", "    ", 
        RowBox[{"(*", " ", "Else", " ", "*)"}], " ", 
        RowBox[{
         RowBox[{"out", " ", "=", " ", "result"}], ";", " ", 
         RowBox[{"form", " ", "=", " ", "\"\<\>\""}]}]}], "\n", "  ", "]"}], 
      ";", "\n", "  ", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"out", " ", "=!=", " ", "Null"}], ",", "\n", "    ", 
        RowBox[{
         RowBox[{"CellPrint", "[", "\n", "      ", 
          RowBox[{"ExpressionCell", "[", " ", 
           RowBox[{
           "result", ",", " ", "\"\<Output\>\"", ",", " ", "\n", "        ", 
            RowBox[{"CellLabelAutoDelete", " ", "\[Rule]", " ", "True"}], ",",
             "\n", "        ", 
            RowBox[{"CellLabel", " ", "\[Rule]", " ", 
             RowBox[{"StringJoin", "[", " ", 
              RowBox[{"\"\<Out[\>\"", ",", " ", 
               RowBox[{"ToString", "[", "$Line", "]"}], ",", " ", 
               "\"\<]:=\>\""}], "]"}]}]}], "\n", "      ", "]"}], "\n", 
          "    ", "]"}], ";", "\n", "    ", 
         RowBox[{"Unprotect", "[", " ", "Out", " ", "]"}], ";", "\n", "    ", 
         RowBox[{
          RowBox[{"Out", "[", " ", "$Line", " ", "]"}], " ", "=", " ", 
          "out"}], ";", "\n", "    ", 
         RowBox[{"Protect", "[", " ", "Out", " ", "]"}], ";", "\n", "    ", 
         "out"}]}], " ", 
       RowBox[{"(*", " ", 
        RowBox[{"needed", " ", "for", " ", "%"}], " ", "*)"}], "\n", "  ", 
       "]"}], ";"}]}], "\n", "]"}]}], ";"}]], "Code"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Assert truth of a logical statement (i.e. prove a theorem)", \
"Subsubsection",
 CellChangeTimes->{{3.543859820046875*^9, 3.543859860484375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Assert", "[", " ", 
   RowBox[{"statement_", ",", " ", 
    RowBox[{"params__:", " ", "Null"}]}], " ", "]"}], " ", ":=", " ", "\n", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"{", " ", "result", " ", "}"}], ",", "\n", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Try", " ", "to", " ", "proove", " ", "the", " ", "statement"}],
       "..."}], " ", "*)"}], "\[IndentingNewLine]", "  ", 
    RowBox[{
     RowBox[{"result", " ", "=", " ", "statement"}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"If", "[", " ", 
      RowBox[{"result", ",", " ", "\[IndentingNewLine]", "    ", 
       RowBox[{"(*", " ", 
        RowBox[{"is", " ", "true"}], " ", "*)"}], "  ", 
       RowBox[{"Return", "@", " ", 
        RowBox[{"Style", "[", " ", 
         RowBox[{
         "\"\<\[RightTee] True \[FilledRectangle]\>\"", ",", " ", "Blue"}], 
         " ", "]"}]}], ",", "\[IndentingNewLine]", "    ", 
       RowBox[{"(*", " ", 
        RowBox[{"is", " ", "false"}], " ", "*)"}], " ", 
       RowBox[{"Return", "@", " ", 
        RowBox[{"Style", "[", " ", 
         RowBox[{
         "\"\<False \[SadSmiley]\>\"", ",", " ", "Red", ",", " ", "Large", 
          ",", " ", "Bold"}], " ", "]"}]}], ",", "\[IndentingNewLine]", 
       "    ", 
       RowBox[{"(*", " ", 
        RowBox[{"is", " ", "neither", " ", "true", " ", "or", " ", "false"}], 
        " ", "*)"}], " ", "Null"}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{"continue", "..."}], " ", "*)"}], "\[IndentingNewLine]", "  ", 
      "]"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"...", " ", "now"}], ",", " ", 
       RowBox[{
       "try", " ", "even", " ", "harder", " ", "to", " ", "proove", " ", 
        "the", " ", "statement"}]}], " ", "*)"}], "\[IndentingNewLine]", "  ", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"Simplify", "[", " ", 
       RowBox[{"statement", ",", "params"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"If", "[", " ", 
      RowBox[{"result", ",", " ", "\[IndentingNewLine]", "    ", 
       RowBox[{"(*", " ", 
        RowBox[{"is", " ", "true"}], " ", "*)"}], "  ", 
       RowBox[{"Return", "@", " ", 
        RowBox[{"Style", "[", " ", 
         RowBox[{
         "\"\<\[RightTee] True (after Simplify) \[FilledRectangle]\>\"", ",", 
          " ", "Blue"}], " ", "]"}]}], ",", "\[IndentingNewLine]", "    ", 
       RowBox[{"(*", " ", 
        RowBox[{"is", " ", "false"}], " ", "*)"}], " ", 
       RowBox[{"Return", "@", " ", 
        RowBox[{"Style", "[", " ", 
         RowBox[{
         "\"\<False (after Simplify) \[SadSmiley]\>\"", ",", " ", "Red", ",", 
          " ", "Large", ",", " ", "Bold"}], " ", "]"}]}], ",", 
       "\[IndentingNewLine]", "    ", 
       RowBox[{"(*", " ", 
        RowBox[{"is", " ", "neither", " ", "true", " ", "or", " ", "false"}], 
        " ", "*)"}], " ", "Null"}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{"continue", "..."}], " ", "*)"}], "\[IndentingNewLine]", "  ", 
      "]"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"...", " ", "now"}], ",", " ", 
       RowBox[{
       "try", " ", "even", " ", "harder", " ", "to", " ", "proove", " ", 
        "the", " ", "statement"}]}], " ", "*)"}], "\[IndentingNewLine]", "  ", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"FullSimplify", "[", " ", 
       RowBox[{"statement", ",", " ", "params"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"If", "[", " ", 
      RowBox[{"result", ",", "\[IndentingNewLine]", "    ", 
       RowBox[{"(*", " ", 
        RowBox[{"is", " ", "true"}], " ", "*)"}], "  ", 
       RowBox[{"Style", "[", " ", 
        RowBox[{
        "\"\<\[RightTee] True (after FullSimplify) \[FilledRectangle]\>\"", 
         ",", " ", "Blue"}], " ", "]"}], ",", "\[IndentingNewLine]", "    ", 
       RowBox[{"(*", " ", 
        RowBox[{"is", " ", "false"}], " ", "*)"}], " ", 
       RowBox[{"Style", "[", " ", 
        RowBox[{
        "\"\<False (after FullSimplify) \[SadSmiley]\>\"", ",", " ", "Red", 
         ",", " ", "Large", ",", " ", "Bold"}], " ", "]"}], ",", 
       "\[IndentingNewLine]", "    ", 
       RowBox[{"(*", " ", 
        RowBox[{"is", " ", "neither", " ", "true", " ", "or", " ", "false"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t    ", 
       RowBox[{"Style", "[", " ", 
        RowBox[{"\"\<Indeterminate \[FreakedSmiley]\>\"", ",", " ", 
         RowBox[{"Darker", "[", "Red", "]"}], ",", " ", "Large", ",", " ", 
         "Bold"}], " ", "]"}]}], "\[IndentingNewLine]", "  ", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.54385987359375*^9, 3.543859989*^9}, {
  3.5440125721539054`*^9, 3.5440125828882804`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transformation Rules", "Subsection",
 CellChangeTimes->{{3.543551761140625*^9, 3.5435517690625*^9}, 
   3.543554646953125*^9}],

Cell[CellGroupData[{

Cell["Scalar test", "Subsubsection",
 CellChangeTimes->{{3.5435495699375*^9, 3.5435495721875*^9}, {
   3.54355037371875*^9, 3.543550375203125*^9}, {3.54355174671875*^9, 
   3.543551748640625*^9}, 3.54355178290625*^9, {3.543556413921875*^9, 
   3.54355643084375*^9}, {3.5435564945*^9, 3.543556496640625*^9}, {
   3.543576036953125*^9, 3.543576037078125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ScalarQ", "[", " ", "x_", " ", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"AtomQ", "[", " ", "x", " ", "]"}], " ", "\[Or]", " ", 
   RowBox[{
    RowBox[{"Length", "[", " ", "x", " ", "]"}], " ", "===", " ", "0"}], " ", 
   "\[Or]", "\n", "  ", 
   RowBox[{"(", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", " ", "x", " ", "]"}], " ", "=!=", " ", "0"}], 
     " ", "\[And]", " ", 
     RowBox[{"\[Not]", 
      RowBox[{"ListQ", "[", " ", "x", " ", "]"}]}], " ", "\[And]", " ", 
     RowBox[{
      RowBox[{"Head", "[", " ", "x", " ", "]"}], " ", "=!=", " ", 
      "\[ScriptCapitalQ]"}], " ", "\[And]", " ", 
     RowBox[{
      RowBox[{"Head", "[", " ", "x", " ", "]"}], " ", "=!=", " ", 
      "Complex"}]}], " ", ")"}], "  "}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.54354902965625*^9}, {3.5435491630625*^9, 
   3.5435491695625*^9}, {3.543550204734375*^9, 3.5435502380625*^9}, {
   3.54355515296875*^9, 3.54355520765625*^9}, {3.543555239796875*^9, 
   3.54355527790625*^9}, {3.54355532678125*^9, 3.543555368953125*^9}, {
   3.543555557515625*^9, 3.543555583015625*^9}, 3.54355638825*^9, {
   3.543577701171875*^9, 3.543577722109375*^9}, {3.543577808234375*^9, 
   3.543577808875*^9}, {3.543814147875*^9, 3.54381415340625*^9}, {
   3.543814284109375*^9, 3.54381428596875*^9}, {3.54381614259375*^9, 
   3.543816171859375*^9}, {3.54392570365625*^9, 3.5439257356875*^9}, {
   3.54392584790625*^9, 3.54392586859375*^9}, {3.543925932546875*^9, 
   3.54392597634375*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quaternion test", "Subsubsection",
 CellChangeTimes->{{3.5435495699375*^9, 3.5435495721875*^9}, {
   3.54355037371875*^9, 3.543550375203125*^9}, {3.54355174671875*^9, 
   3.543551748640625*^9}, 3.54355178290625*^9, {3.543556413921875*^9, 
   3.54355643084375*^9}, {3.5435564945*^9, 3.543556501875*^9}, {
   3.54357603978125*^9, 3.543576039921875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalQ]Q", "[", " ", "q_", " ", "]"}], " ", ":=", " ", 
  "\n", "  ", 
  RowBox[{
   RowBox[{
    RowBox[{"Head", "[", " ", "q", " ", "]"}], " ", "===", " ", 
    "\[ScriptCapitalQ]"}], " ", "\[And]", " ", 
   RowBox[{
    RowBox[{"Length", "[", " ", "q", " ", "]"}], " ", "===", " ", "4"}], " ", 
   "\[And]", "\n", "  ", 
   RowBox[{"And", " ", "@@", " ", 
    RowBox[{"(", " ", 
     RowBox[{"ScalarQ", " ", "/@", " ", "q"}], " ", ")"}]}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543550240859375*^9, 3.543550254375*^9}, {
  3.5435546886875*^9, 3.543554739421875*^9}, {3.54355536246875*^9, 
  3.543555362609375*^9}, {3.54355559021875*^9, 3.543555593203125*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Transform expressions into \[ScriptCapitalQ] objects\
\>", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354970815625*^9}, 
   3.543549861953125*^9, 3.543550067828125*^9, {3.54355110209375*^9, 
   3.543551104859375*^9}, {3.54355122759375*^9, 3.543551256*^9}, {
   3.543551883546875*^9, 3.543551886515625*^9}, 3.5435543220625*^9, {
   3.543826248484375*^9, 3.5438262495625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"To\[ScriptCapitalQ]", "[", " ", 
   RowBox[{
    RowBox[{"w_", " ", "?", "ScalarQ"}], ",", " ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"x_", " ", "?", "ScalarQ"}], ",", " ", 
      RowBox[{"y_", " ", "?", "ScalarQ"}], ",", " ", 
      RowBox[{"z_", " ", "?", "ScalarQ"}]}], " ", "}"}]}], " ", "]"}], " ", ":=",
   " ", "\n", "    ", 
  RowBox[{"\[ScriptCapitalQ]", "[", " ", 
   RowBox[{"w", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], " ", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.54355434459375*^9}, {
   3.54355443609375*^9, 3.54355445525*^9}, {3.5435572069375*^9, 
   3.543557208890625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"To\[ScriptCapitalQ]", "[", " ", "q_", " ", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"q", " ", "/.", " ", 
    RowBox[{"{", "\n", "    ", 
     RowBox[{
      RowBox[{
       RowBox[{"\[ScriptCapitalQ]", "[", " ", 
        RowBox[{"w_", ",", " ", "x_", ",", " ", "y_", ",", " ", "z_"}], " ", 
        "]"}], " ", "\[RuleDelayed]", " ", 
       RowBox[{"\[ScriptCapitalQ]", "[", " ", 
        RowBox[{"w", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], " ", 
        "]"}]}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"x_", " ", "?", "ScalarQ"}], ",", " ", 
         RowBox[{"y_", " ", "?", "ScalarQ"}], ",", " ", 
         RowBox[{"z_", " ", "?", "ScalarQ"}]}], " ", "}"}], "  ", 
       "\[RuleDelayed]", " ", 
       RowBox[{"\[ScriptCapitalQ]", "[", " ", 
        RowBox[{"0", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], " ", 
        "]"}]}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"w_", " ", "?", "ScalarQ"}], ",", " ", 
         RowBox[{"x_", " ", "?", "ScalarQ"}], ",", " ", 
         RowBox[{"y_", " ", "?", "ScalarQ"}], ",", " ", 
         RowBox[{"z_", " ", "?", "ScalarQ"}]}], " ", "}"}], " ", 
       "\[RuleDelayed]", " ", 
       RowBox[{"\[ScriptCapitalQ]", "[", " ", 
        RowBox[{"w", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], " ", 
        "]"}]}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"w_", " ", "?", "ScalarQ"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"x_", " ", "?", "ScalarQ"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"y_", " ", "?", "ScalarQ"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"z_", " ", "?", "ScalarQ"}], "}"}]}], " ", "}"}], " ", 
       "\[RuleDelayed]", " ", 
       RowBox[{"\[ScriptCapitalQ]", "[", " ", 
        RowBox[{"w", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], " ", 
        "]"}]}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"Complex", "[", " ", 
        RowBox[{"x_", ",", " ", "y_"}], " ", "]"}], " ", "\[RuleDelayed]", 
       " ", 
       RowBox[{"\[ScriptCapitalQ]", "[", " ", 
        RowBox[{"x", ",", " ", "y", ",", " ", "0", ",", " ", "0"}], " ", 
        "]"}]}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"Plus", "[", " ", 
        RowBox[{"x_", ",", " ", 
         RowBox[{"Times", "[", " ", 
          RowBox[{
           RowBox[{"Complex", "[", " ", 
            RowBox[{"0", ",", " ", "1"}], " ", "]"}], ",", " ", "y_"}], " ", 
          "]"}]}], " ", "]"}], " ", "\[RuleDelayed]", " ", 
       RowBox[{"\[ScriptCapitalQ]", "[", " ", 
        RowBox[{"x", ",", " ", "y", ",", " ", "0", ",", " ", "0"}], " ", 
        "]"}]}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"Times", "[", " ", 
        RowBox[{
         RowBox[{"Complex", "[", " ", 
          RowBox[{"0", ",", " ", "1"}], " ", "]"}], ",", " ", "x_"}], " ", 
        "]"}], " ", "\[RuleDelayed]", " ", 
       RowBox[{"\[ScriptCapitalQ]", "[", " ", 
        RowBox[{"0", ",", " ", "x", ",", " ", "0", ",", "  ", "0"}], " ", 
        "]"}]}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"Times", "[", " ", 
        RowBox[{
         RowBox[{"Complex", "[", " ", 
          RowBox[{"0", ",", " ", "x_"}], " ", "]"}], ",", " ", "y_"}], " ", 
        "]"}], " ", "\[RuleDelayed]", " ", 
       RowBox[{"\[ScriptCapitalQ]", "[", " ", 
        RowBox[{"0", ",", " ", 
         RowBox[{"x", " ", "y"}], ",", " ", "0", ",", " ", "0"}], " ", 
        "]"}]}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"x_", " ", "?", "ScalarQ"}], " ", "\[RuleDelayed]", " ", 
       RowBox[{"\[ScriptCapitalQ]", "[", " ", 
        RowBox[{"x", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], "]"}]}], 
      ",", "\n", "    ", 
      RowBox[{"(*", " ", 
       RowBox[{"unknown", " ", "list"}], " ", "*)"}], "\n", "    ", 
      RowBox[{"list_", " ", "\[RuleDelayed]", " ", 
       RowBox[{"Module", "[", " ", 
        RowBox[{
         RowBox[{"{", "}"}], ",", " ", 
         RowBox[{
          RowBox[{"Message", "[", " ", 
           RowBox[{
            RowBox[{"To\[ScriptCapitalQ]", "::", "invargs"}], ",", " ", 
            "list"}], " ", "]"}], ";", " ", 
          RowBox[{"Abort", "[", "]"}]}]}], " ", "]"}]}]}], "\n", "}"}]}], " ",
    "//", " ", "\[ScriptCapitalQ]Simplify"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.543549719140625*^9}, 
   3.54354986815625*^9, {3.5435499335*^9, 3.54354994265625*^9}, {
   3.5435512029375*^9, 3.54355121634375*^9}, {3.5435543220625*^9, 
   3.543554330484375*^9}, {3.54355437840625*^9, 3.543554417421875*^9}, {
   3.543557204296875*^9, 3.543557205140625*^9}, {3.543577445390625*^9, 
   3.5435774489375*^9}, 3.543577507078125*^9, {3.543924491421875*^9, 
   3.543924504265625*^9}, {3.54392663715625*^9, 3.5439266540625*^9}, {
   3.543926689609375*^9, 3.543926699921875*^9}, {3.54392674590625*^9, 
   3.54392684325*^9}, {3.543926895125*^9, 3.543926899921875*^9}, 
   3.543926973203125*^9, {3.543927051484375*^9, 3.543927083265625*^9}, {
   3.5439271875625*^9, 3.543927190328125*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Axis and angle into \[ScriptCapitalQ] object", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354970815625*^9}, 
   3.543549861953125*^9, 3.543550067828125*^9, {3.54355110209375*^9, 
   3.543551104859375*^9}, {3.54355122759375*^9, 3.543551256*^9}, {
   3.543551319578125*^9, 3.543551320453125*^9}, {3.543554126875*^9, 
   3.543554131453125*^9}, {3.543575515046875*^9, 3.543575516625*^9}, {
   3.543575624828125*^9, 3.5435756478125*^9}, {3.543927250171875*^9, 
   3.543927295859375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"To\[ScriptCapitalQ]$AngleAxis", "[", " ", 
   RowBox[{"\[Theta]_", ",", " ", 
    RowBox[{"{", " ", 
     RowBox[{"ux_", ",", " ", "uy_", ",", " ", "uz_"}], " ", "}"}]}], " ", 
   "]"}], " ", ":=", " ", 
  RowBox[{"\[ScriptCapitalQ]", "[", "\[IndentingNewLine]", "    ", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"\[Theta]", "/", "2"}], "]"}], ",", " ", 
    RowBox[{"ux", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "/", "2"}], "]"}]}], ",", " ", 
    RowBox[{"uy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "/", "2"}], "]"}]}], ",", " ", 
    RowBox[{"uz", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "/", "2"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.5435543220625*^9}, {
   3.5435623743125*^9, 3.543562384984375*^9}, 3.543562434015625*^9, {
   3.543562467390625*^9, 3.543562476890625*^9}, {3.543562583984375*^9, 
   3.543562599125*^9}, {3.543562639078125*^9, 3.543562639765625*^9}, {
   3.54356313184375*^9, 3.54356319646875*^9}, 3.543563247578125*^9, {
   3.543575436953125*^9, 3.543575469046875*^9}, {3.543575505171875*^9, 
   3.54357553065625*^9}, {3.5435755623125*^9, 3.543575606546875*^9}, {
   3.543575655875*^9, 3.543575674453125*^9}, {3.543927279515625*^9, 
   3.543927282328125*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["To list", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354970815625*^9}, 
   3.543549861953125*^9, 3.543550067828125*^9, {3.54355110209375*^9, 
   3.543551104859375*^9}, {3.54355122759375*^9, 3.543551256*^9}, {
   3.543551883546875*^9, 3.543551886515625*^9}, 3.5435543220625*^9, {
   3.543575903578125*^9, 3.543575970203125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToList", "[", " ", 
   RowBox[{"q_", " ", "?", "\[ScriptCapitalQ]Q"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"(", " ", 
   RowBox[{"q", " ", "/.", " ", 
    RowBox[{"\[ScriptCapitalQ]", "\[Rule]", " ", "List"}]}], " ", 
   ")"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.5435543220625*^9}, {
   3.543562455609375*^9, 3.543562465828125*^9}, 3.54356259134375*^9, {
   3.543564477703125*^9, 3.543564480625*^9}, {3.543564539859375*^9, 
   3.543564543296875*^9}, 3.543924466984375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354970815625*^9}, 
   3.543549861953125*^9, 3.543550067828125*^9, {3.54355110209375*^9, 
   3.543551104859375*^9}, {3.54355122759375*^9, 3.543551256*^9}, {
   3.543551883546875*^9, 3.543551886515625*^9}, 3.5435543220625*^9, {
   3.543575903578125*^9, 3.543575970203125*^9}, {3.54390903696875*^9, 
   3.54390905175*^9}, {3.543909190203125*^9, 3.54390920584375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToVector", "[", " ", 
   RowBox[{"q_", " ", "?", "\[ScriptCapitalQ]Q"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"Transpose", "@", 
   RowBox[{"{", " ", 
    RowBox[{"q", " ", "/.", " ", 
     RowBox[{"\[ScriptCapitalQ]", "\[Rule]", " ", "List"}]}], " ", 
    "}"}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.5435543220625*^9}, {
   3.543562455609375*^9, 3.543562465828125*^9}, 3.54356259134375*^9, {
   3.543564477703125*^9, 3.543564480625*^9}, {3.543564539859375*^9, 
   3.543564543296875*^9}, {3.54390905671875*^9, 3.54390912190625*^9}, {
   3.543909178796875*^9, 3.54390918325*^9}, {3.5439092300625*^9, 
   3.5439092490625*^9}, {3.54390935625*^9, 3.543909385546875*^9}, 
   3.543924469109375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["To matrix representation", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354970815625*^9}, 
   3.543549861953125*^9, 3.543550067828125*^9, {3.54355110209375*^9, 
   3.543551104859375*^9}, {3.54355122759375*^9, 3.543551256*^9}, {
   3.543551883546875*^9, 3.543551886515625*^9}, 3.5435543220625*^9, {
   3.543575903578125*^9, 3.543575950109375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToMatrix", "[", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"w_", ",", " ", "x_", ",", " ", "y_", ",", " ", "z_"}], " ", 
    "]"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"{", "\n", "   ", 
   RowBox[{
    RowBox[{"{", "  ", 
     RowBox[{"w", ",", "  ", "x", ",", "  ", "y", ",", "  ", "z"}], " ", 
     "}"}], ",", "\n", "   ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"-", "x"}], ",", "  ", "w", ",", " ", 
      RowBox[{"-", "z"}], ",", "  ", "y"}], " ", "}"}], ",", "\n", "   ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"-", "y"}], ",", "  ", "z", ",", "  ", "w", ",", " ", 
      RowBox[{"-", "x"}]}], " ", "}"}], ",", "\n", "   ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"-", "z"}], ",", " ", 
      RowBox[{"-", "y"}], ",", "  ", "x", ",", "  ", "w"}], " ", "}"}]}], 
   "\n", "}"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.5435543220625*^9}, {
   3.5435623743125*^9, 3.543562384984375*^9}, 3.543562434015625*^9, {
   3.543562467390625*^9, 3.543562476890625*^9}, {3.543562583984375*^9, 
   3.543562599125*^9}, {3.543562639078125*^9, 3.543562639765625*^9}, {
   3.54356313184375*^9, 3.54356319646875*^9}, 3.543563247578125*^9, {
   3.543575436953125*^9, 3.543575437984375*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["To matrix form", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354970815625*^9}, 
   3.543549861953125*^9, 3.543550067828125*^9, {3.54355110209375*^9, 
   3.543551104859375*^9}, {3.54355122759375*^9, 3.543551256*^9}, {
   3.543551883546875*^9, 3.543551886515625*^9}, 3.5435543220625*^9, {
   3.543575903578125*^9, 3.543575938*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"MatrixForm", "[", " ", 
   RowBox[{"q", ":", " ", 
    RowBox[{"\[ScriptCapitalQ]", "[", " ", 
     RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], " ", "]"}], " ", ":=",
   " ", 
  RowBox[{"MatrixForm", "@", " ", 
   RowBox[{"ToList", "@", " ", "q"}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.5435543220625*^9}, {
   3.543562455609375*^9, 3.543562465828125*^9}, 3.54356259134375*^9, {
   3.543564477703125*^9, 3.543564480625*^9}, {3.543564539859375*^9, 
   3.54356458478125*^9}, {3.54384168209375*^9, 3.54384186821875*^9}, {
   3.54384190390625*^9, 3.543841910140625*^9}, {3.543859617640625*^9, 
   3.54385962003125*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["To paritioned matrix form (with divider lines)", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354970815625*^9}, 
   3.543549861953125*^9, 3.543550067828125*^9, {3.54355110209375*^9, 
   3.543551104859375*^9}, {3.54355122759375*^9, 3.543551256*^9}, {
   3.543551883546875*^9, 3.543551886515625*^9}, 3.5435543220625*^9, {
   3.543575903578125*^9, 3.543575938*^9}, 3.543859659484375*^9, {
   3.543927321625*^9, 3.5439273575625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"QForm", "[", " ", 
   RowBox[{"Q_", " ", "?", "MatrixQ"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"DisplayForm", "@", "\[IndentingNewLine]", "  ", 
   RowBox[{"RowBox", "[", 
    RowBox[{"{", "\[IndentingNewLine]", "    ", 
     RowBox[{
     "\"\<(\>\"", ",", " ", "\"\<\[NoBreak]\>\"", ",", "\[IndentingNewLine]", 
      "    ", 
      RowBox[{"GridBox", "[", " ", 
       RowBox[{
        RowBox[{"Release", "[", " ", "Q", " ", "]"}], ",", 
        "\[IndentingNewLine]", "      ", 
        RowBox[{"RowSpacings", " ", "\[Rule]", " ", "1"}], ",", " ", 
        RowBox[{"ColumnSpacings", " ", "\[Rule]", " ", "1"}], ",", 
        "\[IndentingNewLine]", "      ", 
        RowBox[{"RowAlignments", " ", "\[Rule]", " ", "Baseline"}], ",", "\n",
         "      ", 
        RowBox[{"ColumnAlignments", " ", "\[Rule]", " ", "Center"}], ",", 
        "\[IndentingNewLine]", "      ", 
        RowBox[{"GridBoxDividers", " ", "\[Rule]", " ", 
         RowBox[{"{", "\[IndentingNewLine]", "        ", 
          RowBox[{
           RowBox[{"\"\<Columns\>\"", " ", "\[Rule]", " ", 
            RowBox[{"{", " ", 
             RowBox[{"False", ",", " ", 
              RowBox[{"GrayLevel", "[", "0.84", "]"}]}], " ", "}"}]}], ",", 
           "\[IndentingNewLine]", "        ", 
           RowBox[{"\"\<Rows\>\"", " ", "\[Rule]", " ", 
            RowBox[{"{", " ", 
             RowBox[{"False", ",", " ", 
              RowBox[{"GrayLevel", "[", "0.84", "]"}]}], " ", "}"}]}]}], 
          "\[IndentingNewLine]", "      ", "}"}]}]}], "\[IndentingNewLine]", 
       "   ", "]"}], ",", "\[IndentingNewLine]", "   ", "\"\<\[NoBreak]\>\"", 
      ",", " ", "\"\<)\>\""}], "\[IndentingNewLine]", " ", "}"}], 
    "]"}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.5435543220625*^9}, {
   3.543562455609375*^9, 3.543562465828125*^9}, 3.54356259134375*^9, {
   3.543564477703125*^9, 3.543564480625*^9}, {3.543564539859375*^9, 
   3.54356458478125*^9}, {3.54384168209375*^9, 3.54384186821875*^9}, {
   3.54384190390625*^9, 3.543841910140625*^9}, {3.543859617640625*^9, 
   3.54385962003125*^9}, {3.54385966759375*^9, 3.5438597435*^9}, {
   3.54392742721875*^9, 3.54392742896875*^9}, {3.5439278378125*^9, 
   3.5439278951875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"QForm", "[", " ", 
   RowBox[{"q_", " ", "?", "\[ScriptCapitalQ]Q"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"QForm", "[", " ", 
   RowBox[{"{", " ", 
    RowBox[{"Release", "[", " ", 
     RowBox[{"ToList", "@", " ", "q"}], " ", "]"}], " ", "}"}], " ", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.5435543220625*^9}, {
   3.543562455609375*^9, 3.543562465828125*^9}, 3.54356259134375*^9, {
   3.543564477703125*^9, 3.543564480625*^9}, {3.543564539859375*^9, 
   3.54356458478125*^9}, {3.54384168209375*^9, 3.54384186821875*^9}, {
   3.54384190390625*^9, 3.543841910140625*^9}, {3.543859617640625*^9, 
   3.54385962003125*^9}, {3.54385966759375*^9, 3.5438597435*^9}, {
   3.54392737753125*^9, 3.54392742534375*^9}, {3.543927456125*^9, 
   3.543927458546875*^9}, {3.543927519203125*^9, 3.543927528015625*^9}, {
   3.543927675359375*^9, 3.54392782528125*^9}, {3.543927860015625*^9, 
   3.54392797178125*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["To rotation matrix, Shoemake's form", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354970815625*^9}, 
   3.543549861953125*^9, 3.543550067828125*^9, {3.54355110209375*^9, 
   3.543551104859375*^9}, {3.54355122759375*^9, 3.543551256*^9}, {
   3.543551319578125*^9, 3.543551320453125*^9}, {3.543554126875*^9, 
   3.543554131453125*^9}, {3.543575515046875*^9, 3.543575516625*^9}, {
   3.543575911453125*^9, 3.54357593490625*^9}, {3.54392721371875*^9, 
   3.543927221359375*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"RotationMatrix", "[", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"w_", ",", " ", "x_", ",", " ", "y_", ",", " ", "z_"}], " ", 
    "]"}], " ", "]"}], " ", ":=", "\n", 
  RowBox[{"{", "\n", "   ", 
   RowBox[{
    RowBox[{"{", "  ", 
     RowBox[{
      RowBox[{"1", " ", "-", " ", 
       RowBox[{"2", 
        RowBox[{"(", " ", 
         RowBox[{
          SuperscriptBox["y", "2"], " ", "+", " ", 
          SuperscriptBox["z", "2"]}], " ", ")"}]}]}], ",", "   ", 
      RowBox[{
       RowBox[{"2", " ", "x", " ", "y"}], " ", "-", " ", 
       RowBox[{"2", " ", "w", " ", "z"}]}], ",", "     ", 
      RowBox[{
       RowBox[{"2", " ", "x", " ", "z"}], " ", "+", " ", 
       RowBox[{"2", " ", "w", " ", "y"}]}]}], "  ", "}"}], ",", "\n", "   ", 
    RowBox[{"{", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", "x", " ", "y"}], " ", "+", " ", 
       RowBox[{"2", " ", "w", " ", "z"}]}], ",", "     ", 
      RowBox[{"1", " ", "-", " ", 
       RowBox[{"2", 
        RowBox[{"(", " ", 
         RowBox[{
          SuperscriptBox["x", "2"], " ", "+", " ", 
          SuperscriptBox["z", "2"]}], " ", ")"}]}]}], ",", "  ", 
      RowBox[{
       RowBox[{"2", " ", "y", " ", "z"}], " ", "-", " ", 
       RowBox[{"2", " ", "w", " ", "x"}]}]}], "   ", "}"}], ",", "\n", "   ", 
    RowBox[{"{", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", "x", " ", "z"}], " ", "-", " ", 
       RowBox[{"2", " ", "w", " ", "y"}]}], " ", ",", "    ", 
      RowBox[{
       RowBox[{"2", " ", "w", " ", "x"}], "+", 
       RowBox[{"2", " ", "y", " ", "z"}]}], ",", "      ", 
      RowBox[{"1", " ", "-", " ", 
       RowBox[{"2", 
        RowBox[{"(", " ", 
         RowBox[{
          SuperscriptBox["x", "2"], " ", "+", " ", 
          SuperscriptBox["y", "2"]}], " ", ")"}]}]}]}], " ", "}"}]}], "\n", 
   "}"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.5435543220625*^9}, {
   3.5435623743125*^9, 3.543562384984375*^9}, 3.543562434015625*^9, {
   3.543562467390625*^9, 3.543562476890625*^9}, {3.543562583984375*^9, 
   3.543562599125*^9}, {3.543562639078125*^9, 3.543562639765625*^9}, {
   3.54356313184375*^9, 3.54356319646875*^9}, 3.543563247578125*^9, {
   3.543575436953125*^9, 3.543575469046875*^9}, {3.543575505171875*^9, 
   3.54357553065625*^9}, {3.5435755623125*^9, 3.543575606546875*^9}, {
   3.54357570440625*^9, 3.543575835296875*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"RotationMatrix4", "[", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"w_", ",", " ", "x_", ",", " ", "y_", ",", " ", "z_"}], " ", 
    "]"}], " ", "]"}], " ", ":=", "\n", 
  RowBox[{"{", "\n", "   ", 
   RowBox[{
    RowBox[{"{", "  ", 
     RowBox[{
     "1", ",", "  ", "0", ",", "                  ", "0", ",", 
      "                 ", "0"}], "                ", "}"}], ",", "\n", "   ", 
    RowBox[{"{", "  ", 
     RowBox[{"0", ",", "  ", 
      RowBox[{"1", " ", "-", " ", 
       RowBox[{"2", 
        RowBox[{"(", " ", 
         RowBox[{
          SuperscriptBox["y", "2"], " ", "+", " ", 
          SuperscriptBox["z", "2"]}], " ", ")"}]}]}], ",", "   ", 
      RowBox[{
       RowBox[{"2", " ", "x", " ", "y"}], " ", "-", " ", 
       RowBox[{"2", " ", "w", " ", "z"}]}], ",", "    ", 
      RowBox[{
       RowBox[{"2", " ", "x", " ", "z"}], " ", "+", " ", 
       RowBox[{"2", " ", "w", " ", "y"}]}]}], "   ", "}"}], ",", "\n", "   ", 
    RowBox[{"{", "  ", 
     RowBox[{"0", ",", "  ", 
      RowBox[{
       RowBox[{"2", " ", "x", " ", "y"}], " ", "+", " ", 
       RowBox[{"2", " ", "w", " ", "z"}]}], ",", "     ", 
      RowBox[{"1", " ", "-", " ", 
       RowBox[{"2", 
        RowBox[{"(", " ", 
         RowBox[{
          SuperscriptBox["x", "2"], " ", "+", " ", 
          SuperscriptBox["z", "2"]}], " ", ")"}]}]}], ",", "  ", 
      RowBox[{
       RowBox[{"2", " ", "y", " ", "z"}], " ", "-", " ", 
       RowBox[{"2", " ", "w", " ", "x"}]}]}], "   ", "}"}], ",", "\n", "   ", 
    RowBox[{"{", "  ", 
     RowBox[{"0", ",", "  ", 
      RowBox[{
       RowBox[{"2", " ", "x", " ", "z"}], " ", "-", " ", 
       RowBox[{"2", " ", "w", " ", "y"}]}], " ", ",", "    ", 
      RowBox[{
       RowBox[{"2", " ", "w", " ", "x"}], " ", "+", " ", 
       RowBox[{"2", " ", "y", " ", "z"}]}], ",", "    ", 
      RowBox[{"1", " ", "-", " ", 
       RowBox[{"2", 
        RowBox[{"(", " ", 
         RowBox[{
          SuperscriptBox["x", "2"], " ", "+", " ", 
          SuperscriptBox["y", "2"]}], " ", ")"}]}]}]}], " ", "}"}]}], "\n", 
   "}"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549210328125*^9, 3.543549220609375*^9}, 
   3.543549254953125*^9, {3.54355427990625*^9, 3.5435543220625*^9}, {
   3.5435623743125*^9, 3.543562384984375*^9}, 3.543562434015625*^9, {
   3.543562467390625*^9, 3.543562476890625*^9}, {3.543562583984375*^9, 
   3.543562599125*^9}, {3.543562639078125*^9, 3.543562639765625*^9}, {
   3.54356313184375*^9, 3.54356319646875*^9}, 3.543563247578125*^9, {
   3.543575436953125*^9, 3.543575469046875*^9}, {3.543575505171875*^9, 
   3.54357553065625*^9}, {3.5435755623125*^9, 3.543575606546875*^9}, {
   3.54357570440625*^9, 3.543575835296875*^9}, {3.543814834640625*^9, 
   3.543815029765625*^9}, {3.54381724425*^9, 3.543817249765625*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conjugate", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549677921875*^9}, {
  3.543550791078125*^9, 3.543550796828125*^9}, {3.54355185859375*^9, 
  3.54355186125*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Conjugate", "[", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"w_", ",", " ", "x_", ",", " ", "y_", ",", " ", "z_"}], " ", 
    "]"}], " ", "]"}], ":=", "\n", "    ", 
  RowBox[{"\[ScriptCapitalQ]", "[", " ", 
   RowBox[{"w", ",", " ", 
    RowBox[{"-", "x"}], ",", " ", 
    RowBox[{"-", "y"}], ",", " ", 
    RowBox[{"-", "z"}]}], " ", "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549678765625*^9}, {
  3.543549836859375*^9, 3.5435498379375*^9}, {3.543550799421875*^9, 
  3.543550817765625*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Squared Norm", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549677921875*^9}, {
  3.543550791078125*^9, 3.543550796828125*^9}, {3.54355185859375*^9, 
  3.5435518709375*^9}, {3.543816294296875*^9, 3.543816299125*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"SqNorm", "[", " ", 
   RowBox[{"q", ":", "  ", 
    RowBox[{"\[ScriptCapitalQ]", "[", " ", 
     RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], " ", "]"}], " ", ":=",
   " ", "\n", "    ", 
  RowBox[{"Plus", " ", "@@", " ", 
   RowBox[{"(", " ", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{"List", " ", "@@", " ", "q"}], " ", ")"}], "^", "2"}], " ", 
    ")"}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.543549680390625*^9}, {
   3.543549839265625*^9, 3.543549839671875*^9}, {3.543550883546875*^9, 
   3.543550902421875*^9}, {3.543557183390625*^9, 3.54355718409375*^9}, 
   3.543814800578125*^9, {3.54381626128125*^9, 3.54381626290625*^9}, {
   3.543816301203125*^9, 3.543816305953125*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Norm", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549677921875*^9}, {
  3.543550791078125*^9, 3.543550796828125*^9}, {3.54355185859375*^9, 
  3.543551865390625*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Norm", "[", " ", 
   RowBox[{"q", ":", " ", 
    RowBox[{"\[ScriptCapitalQ]", "[", " ", 
     RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], " ", "]"}], ":=", 
  "\n", "    ", 
  RowBox[{"Sqrt", "[", " ", 
   RowBox[{"SqNorm", "[", " ", "q", " ", "]"}], " ", "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354967953125*^9}, {
   3.54354983834375*^9, 3.54354983884375*^9}, {3.54355082040625*^9, 
   3.54355086846875*^9}, {3.543555451125*^9, 3.543555495046875*^9}, {
   3.543814803703125*^9, 3.543814809453125*^9}, 3.543816320109375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Abs", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549677921875*^9}, {
  3.543550791078125*^9, 3.543550796828125*^9}, {3.54355185859375*^9, 
  3.5435518709375*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Abs", "[", " ", 
   RowBox[{"q", ":", "  ", 
    RowBox[{"\[ScriptCapitalQ]", "[", " ", 
     RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], " ", "]"}], " ", ":=",
   " ", "\n", "    ", 
  RowBox[{"Sqrt", "[", " ", 
   RowBox[{"SqNorm", "[", " ", "q", " ", "]"}], " ", "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.543549680390625*^9}, {
   3.543549839265625*^9, 3.543549839671875*^9}, {3.543550883546875*^9, 
   3.543550902421875*^9}, {3.543557183390625*^9, 3.54355718409375*^9}, 
   3.543814800578125*^9, {3.54381626128125*^9, 3.54381626290625*^9}, {
   3.543816310203125*^9, 3.543816312328125*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Round", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549677921875*^9}, {
  3.543550791078125*^9, 3.543550796828125*^9}, {3.54355185859375*^9, 
  3.543551877359375*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Round", "[", " ", 
   RowBox[{"q", ":", " ", 
    RowBox[{"\[ScriptCapitalQ]", "[", " ", 
     RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], " ", "]"}], ":=", 
  "\n", 
  RowBox[{"Module", "[", "\n", "  ", 
   RowBox[{
    RowBox[{"{", " ", "\n", "    ", 
     RowBox[{
      RowBox[{"cent", " ", "=", " ", 
       RowBox[{"Round", " ", "/@", " ", "q"}]}], ";", "\n", "    ", 
      RowBox[{"mid", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{"Floor", " ", "/@", " ", "q"}], " ", ")"}], " ", "+", " ", 
        RowBox[{"\[ScriptCapitalQ]", "[", " ", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", " ", 
          RowBox[{"1", "/", "2"}], ",", " ", 
          RowBox[{"1", "/", "2"}], ",", " ", 
          RowBox[{"1", "/", "2"}]}], " ", "]"}]}]}], ";"}], "\n", "  ", "}"}],
     ",", "\n", "  ", 
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"SqNorm", "[", " ", 
        RowBox[{"q", " ", "-", " ", "cent"}], " ", "]"}], " ", "<=", " ", 
       RowBox[{"SqNorm", "[", " ", 
        RowBox[{"q", " ", "-", " ", "mid"}], " ", "]"}]}], ",", " ", "cent", 
      ",", " ", "mid"}], " ", "]"}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354968553125*^9}, {
   3.5435498430625*^9, 3.543549844171875*^9}, {3.54355092528125*^9, 
   3.543551045328125*^9}, {3.543553843171875*^9, 3.5435538984375*^9}, {
   3.543557184796875*^9, 3.54355720084375*^9}, 3.54356176165625*^9, {
   3.54381632759375*^9, 3.543816331953125*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Real Part", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354970815625*^9}, 
   3.543549861953125*^9, 3.543550067828125*^9, {3.54355110209375*^9, 
   3.543551104859375*^9}, {3.54355122759375*^9, 3.543551256*^9}, {
   3.543551319578125*^9, 3.543551320453125*^9}, {3.543554126875*^9, 
   3.543554131453125*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Re", "[", " ", 
   RowBox[{"q", ":", " ", 
    RowBox[{"\[ScriptCapitalQ]", "[", " ", 
     RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], " ", "]"}], " ", ":=",
   "\n", "    ", 
  RowBox[{"q", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549739796875*^9}, {
  3.54354987709375*^9, 3.5435498780625*^9}, {3.54355135525*^9, 
  3.543551356640625*^9}, {3.543552731984375*^9, 3.5435528288125*^9}, {
  3.54355286390625*^9, 3.54355286503125*^9}, {3.543552899984375*^9, 
  3.543552975984375*^9}, {3.54355721009375*^9, 3.543557210625*^9}, {
  3.543561495578125*^9, 3.543561497796875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sign (returns Versor)", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354970815625*^9}, 
   3.543549861953125*^9, 3.543550067828125*^9, {3.54355110209375*^9, 
   3.543551104859375*^9}, {3.54355122759375*^9, 3.543551256*^9}, {
   3.543551319578125*^9, 3.543551320453125*^9}, {3.543554126875*^9, 
   3.543554146296875*^9}, {3.543576565015625*^9, 3.543576569203125*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Sign", "[", " ", 
   RowBox[{"q", ":", " ", 
    RowBox[{"\[ScriptCapitalQ]", "[", " ", 
     RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], " ", "]"}], " ", ":=",
   " ", "\n", "    ", 
  RowBox[{
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"1", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], " ", "]"}], 
   " ", "/;", " ", 
   RowBox[{
    RowBox[{"Abs", "[", " ", "q", " ", "]"}], " ", "\[Equal]", " ", 
    "0"}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549739796875*^9}, {
  3.54354987709375*^9, 3.5435498780625*^9}, {3.54355135525*^9, 
  3.543551356640625*^9}, {3.543552731984375*^9, 3.5435528288125*^9}, {
  3.54355286390625*^9, 3.54355286503125*^9}, {3.543552899984375*^9, 
  3.5435529189375*^9}, {3.54355295721875*^9, 3.543552977375*^9}, {
  3.5435540288125*^9, 3.54355402975*^9}, {3.543557211234375*^9, 
  3.543557211796875*^9}, {3.54399709803125*^9, 3.54399710015625*^9}, {
  3.543997393484375*^9, 3.543997450140625*^9}, {3.543998322421875*^9, 
  3.543998325578125*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Sign", "[", " ", 
   RowBox[{"q", ":", " ", 
    RowBox[{"\[ScriptCapitalQ]", "[", " ", 
     RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], " ", "]"}], " ", ":=",
   "\n", "    ", 
  RowBox[{"q", " ", "/", " ", 
   RowBox[{"Abs", "[", " ", "q", " ", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549739796875*^9}, {
  3.54354987709375*^9, 3.5435498780625*^9}, {3.54355135525*^9, 
  3.543551356640625*^9}, {3.543552731984375*^9, 3.5435528288125*^9}, {
  3.54355286390625*^9, 3.54355286503125*^9}, {3.543552899984375*^9, 
  3.5435529189375*^9}, {3.54355295721875*^9, 3.543552977375*^9}, {
  3.5435540288125*^9, 3.54355402975*^9}, {3.543557211234375*^9, 
  3.543557211796875*^9}, {3.54399709803125*^9, 3.54399710015625*^9}, {
  3.543997393484375*^9, 3.543997394140625*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Imaginary Part", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354970815625*^9}, 
   3.543549861953125*^9, 3.543550067828125*^9, {3.54355110209375*^9, 
   3.543551104859375*^9}, {3.54355122759375*^9, 3.543551256*^9}, {
   3.543551319578125*^9, 3.543551320453125*^9}, {3.543554126875*^9, 
   3.54355415478125*^9}, {3.543575859453125*^9, 3.54357585978125*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Im", "[", " ", 
   RowBox[{"q", ":", " ", 
    RowBox[{"\[ScriptCapitalQ]", "[", " ", 
     RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], " ", "]"}], " ", ":=",
   "\n", "    ", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{"q", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
    RowBox[{"q", "[", 
     RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
    RowBox[{"q", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}], " ", "}"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549739796875*^9}, {
  3.54354987709375*^9, 3.5435498780625*^9}, {3.54355135525*^9, 
  3.543551356640625*^9}, {3.543552731984375*^9, 3.5435528288125*^9}, {
  3.54355286390625*^9, 3.54355286503125*^9}, {3.543552899984375*^9, 
  3.543552975984375*^9}, {3.54355721009375*^9, 3.543557210625*^9}, {
  3.543561495578125*^9, 3.543561497796875*^9}, {3.543566443953125*^9, 
  3.54356645621875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AdjustedSign$Im", "[", " ", 
   RowBox[{"q_Complex", " ", "|", " ", 
    RowBox[{"q_", " ", "?", "ScalarQ"}]}], " ", "]"}], " ", ":=", " ", 
  "\[ImaginaryI]"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.543549739796875*^9}, {
   3.54354987709375*^9, 3.5435498780625*^9}, {3.54355135525*^9, 
   3.543551356640625*^9}, {3.543552731984375*^9, 3.5435528288125*^9}, {
   3.54355286390625*^9, 3.54355286503125*^9}, {3.543552899984375*^9, 
   3.543552905234375*^9}, {3.543552982328125*^9, 3.543553008578125*^9}, 
   3.543553475390625*^9, {3.54355420071875*^9, 3.54355420215625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AdjustedSign$Im", "[", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{
     RowBox[{"w_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"x_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"y_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"z_", " ", "?", "ScalarQ"}]}], " ", "]"}], " ", "]"}], " ", ":=",
   "\n", 
  RowBox[{"Which", "[", "\n", "    ", 
   RowBox[{
    RowBox[{"x", " ", "!=", " ", "0"}], ",", "\n", "        ", 
    RowBox[{
     RowBox[{"Sign", "[", " ", "x", " ", "]"}], " ", "*", " ", 
     RowBox[{"Sign", "[", " ", 
      RowBox[{"\[ScriptCapitalQ]", "[", " ", 
       RowBox[{"0", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], " ", "]"}],
       " ", "]"}]}], ",", "\n", "    ", 
    RowBox[{"y", " ", "!=", " ", "0"}], ",", "\n", "        ", 
    RowBox[{
     RowBox[{"Sign", "[", " ", "y", " ", "]"}], " ", "*", " ", 
     RowBox[{"Sign", "[", " ", 
      RowBox[{"\[ScriptCapitalQ]", "[", " ", 
       RowBox[{"0", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], " ", "]"}],
       " ", "]"}]}], ",", "\n", "    ", 
    RowBox[{"z", " ", "!=", " ", "0"}], ",", "\n", "        ", 
    RowBox[{
     RowBox[{"Sign", "[", " ", "z", " ", "]"}], " ", "*", " ", 
     RowBox[{"Sign", "[", " ", 
      RowBox[{"\[ScriptCapitalQ]", "[", " ", 
       RowBox[{"0", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], " ", "]"}],
       " ", "]"}]}], ",", "\n", "    ", "True", ",", "\n", "        ", 
    "\[ImaginaryI]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"?", 
     RowBox[{"abort", "?"}]}], " ", "*)"}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.543549739796875*^9}, {
   3.54354987709375*^9, 3.5435498780625*^9}, {3.54355135525*^9, 
   3.543551356640625*^9}, {3.543552731984375*^9, 3.5435528288125*^9}, {
   3.54355286390625*^9, 3.54355286503125*^9}, {3.543552899984375*^9, 
   3.5435529225*^9}, {3.543553143046875*^9, 3.543553347671875*^9}, 
   3.54355347728125*^9, {3.54355420309375*^9, 3.543554203625*^9}, {
   3.543557212484375*^9, 3.5435572254375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Abs$Im", "[", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{
     RowBox[{"w_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"x_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"y_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"z_", " ", "?", "ScalarQ"}]}], " ", "]"}], " ", "]"}], ":=", 
  "\n", "    ", 
  SqrtBox[
   RowBox[{
    SuperscriptBox["x", "2"], " ", "+", " ", 
    SuperscriptBox["y", "2"], " ", "+", " ", 
    SuperscriptBox["z", "2"]}]]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549739796875*^9}, {
  3.54354987709375*^9, 3.5435498780625*^9}, {3.54355135525*^9, 
  3.543551356640625*^9}, {3.543552731984375*^9, 3.5435528288125*^9}, {
  3.54355286390625*^9, 3.54355286503125*^9}, {3.543552899984375*^9, 
  3.543552901609375*^9}, {3.5435541795*^9, 3.543554181046875*^9}, {
  3.543557226265625*^9, 3.543557226953125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Abs$Im", "[", " ", 
   RowBox[{"x_", " ", "?", " ", "NumericQ"}], " ", "]"}], " ", ":=", " ", 
  "\n", "    ", 
  RowBox[{"Im", "[", " ", "x", " ", "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549739796875*^9}, {
  3.54354987709375*^9, 3.5435498780625*^9}, {3.54355135525*^9, 
  3.543551356640625*^9}, {3.543552731984375*^9, 3.543552734859375*^9}, {
  3.543552834671875*^9, 3.543552841015625*^9}, {3.54355305796875*^9, 
  3.543553058296875*^9}, {3.543554182078125*^9, 3.543554183234375*^9}, {
  3.54355722759375*^9, 3.54355722815625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sign$Im", "[", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{
     RowBox[{"w_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"x_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"y_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"z_", " ", "?", "ScalarQ"}]}], " ", "]"}], " ", "]"}], " ", ":=",
   "\n", "    ", 
  RowBox[{"Sign", "[", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"0", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], " ", "]"}], 
   " ", "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549739796875*^9}, {
  3.54354987709375*^9, 3.5435498780625*^9}, {3.54355135525*^9, 
  3.543551356640625*^9}, {3.543552731984375*^9, 3.543552733765625*^9}, {
  3.543552845125*^9, 3.543552869203125*^9}, {3.54355306540625*^9, 
  3.5435530675625*^9}, {3.543554204859375*^9, 3.543554205375*^9}, {
  3.54355722871875*^9, 3.543557229296875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Addition ", "Subsubsection",
 CellChangeTimes->{{3.5435495699375*^9, 3.5435495721875*^9}, {
   3.54355037371875*^9, 3.543550375203125*^9}, 3.543551781375*^9}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"w1_", ",", " ", "x1_", ",", " ", "y1_", ",", " ", "z1_"}], " ", 
    "]"}], " ", "+", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"w2_", ",", " ", "x2_", ",", " ", "y2_", ",", " ", "z2_"}], " ", 
    "]"}]}], " ", ":=", "\n", "    ", 
  RowBox[{
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{
     RowBox[{"w1", " ", "+", " ", "w2"}], ",", " ", 
     RowBox[{"x1", " ", "+", " ", "x2"}], ",", " ", 
     RowBox[{"y1", " ", "+", " ", "y2"}], ",", " ", 
     RowBox[{"z1", " ", "+", " ", "z2"}]}], " ", "]"}], " ", "//", " ", 
   "\[ScriptCapitalQ]Simplify"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.543549658234375*^9}, {
   3.5435498239375*^9, 3.543549825609375*^9}, 3.543549951171875*^9, {
   3.543550416125*^9, 3.543550419671875*^9}, {3.543550571375*^9, 
   3.543550605421875*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{
   RowBox[{"Complex", "[", " ", 
    RowBox[{"re_", ",", " ", "im_"}], " ", "]"}], " ", "+", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"w_", ",", " ", "x_", ",", " ", "y_", ",", " ", "z_"}], " ", 
    "]"}]}], " ", ":=", "\n", "    ", 
  RowBox[{
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{
     RowBox[{"w", " ", "+", " ", "re"}], ",", " ", 
     RowBox[{"x", " ", "+", " ", "im"}], ",", " ", "y", ",", " ", "z"}], " ", 
    "]"}], " ", "//", " ", "\[ScriptCapitalQ]Simplify"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354965990625*^9}, {
   3.54354982653125*^9, 3.54354982775*^9}, 3.54354995234375*^9, {
   3.54355042175*^9, 3.5435504258125*^9}, {3.543550612828125*^9, 
   3.54355064315625*^9}, {3.543557171984375*^9, 3.543557175296875*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{
   RowBox[{"\[Lambda]_", " ", "?", "ScalarQ"}], " ", "+", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"w_", ",", " ", "x_", ",", " ", "y_", ",", " ", "z_"}], " ", 
    "]"}]}], " ", ":=", " ", "\n", "    ", 
  RowBox[{"\[ScriptCapitalQ]", "[", " ", 
   RowBox[{
    RowBox[{"w", " ", "+", " ", "\[Lambda]"}], ",", " ", "x", ",", " ", "y", 
    ",", " ", "z"}], " ", "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.543549661*^9}, {
   3.543549828515625*^9, 3.5435498298125*^9}, {3.543550429578125*^9, 
   3.5435504351875*^9}, {3.54355054046875*^9, 3.5435505634375*^9}, 
   3.543550672578125*^9, {3.543557169796875*^9, 3.543557176640625*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multiplication ", "Subsubsection",
 CellChangeTimes->{{3.5435495699375*^9, 3.5435495721875*^9}, {
   3.54355037371875*^9, 3.5435503958125*^9}, 3.543551779265625*^9}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{
   RowBox[{"\[Lambda]_", " ", "?", "ScalarQ"}], " ", "*", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"w_", ",", " ", "x_", ",", " ", "y_", ",", " ", "z_"}], " ", 
    "]"}]}], ":=", " ", "\n", "    ", 
  RowBox[{"\[ScriptCapitalQ]", "[", " ", 
   RowBox[{
    RowBox[{"\[Lambda]", " ", "w"}], ",", " ", 
    RowBox[{"\[Lambda]", " ", "x"}], ",", " ", 
    RowBox[{"\[Lambda]", " ", "y"}], ",", " ", 
    RowBox[{"\[Lambda]", " ", "z"}]}], " ", "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549664296875*^9}, {
  3.543549833328125*^9, 3.54354983425*^9}, {3.543550450359375*^9, 
  3.54355049275*^9}, {3.543550665484375*^9, 3.543550669578125*^9}, {
  3.543557181890625*^9, 3.54355718259375*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Non-commutative multiplication", "Subsubsection",
 CellChangeTimes->{{3.5435495699375*^9, 3.5435495721875*^9}, {
  3.54355037371875*^9, 3.543550382046875*^9}, {3.5435507631875*^9, 
  3.54355076596875*^9}, {3.543576071359375*^9, 3.543576072984375*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"w1_", ",", " ", "x1_", ",", " ", "y1_", ",", " ", "z1_"}], " ", 
    "]"}], " ", "**", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"w2_", ",", " ", "x2_", ",", " ", "y2_", ",", " ", "z2_"}], " ", 
    "]"}]}], ":=", "\n", "    ", 
  RowBox[{
   RowBox[{"\[ScriptCapitalQ]", "[", "\n", "        ", 
    RowBox[{
     RowBox[{
      RowBox[{"w1", " ", "w2"}], " ", "-", " ", 
      RowBox[{"x1", " ", "x2"}], " ", "-", " ", 
      RowBox[{"y1", " ", "y2"}], " ", "-", " ", 
      RowBox[{"z1", " ", "z2"}]}], ",", "\n", "        ", 
     RowBox[{
      RowBox[{"w1", " ", "x2"}], " ", "+", " ", 
      RowBox[{"x1", " ", "w2"}], " ", "+", " ", 
      RowBox[{"y1", " ", "z2"}], " ", "-", " ", 
      RowBox[{"z1", " ", "y2"}]}], ",", "\n", "        ", 
     RowBox[{
      RowBox[{"w1", " ", "y2"}], " ", "-", " ", 
      RowBox[{"x1", " ", "z2"}], " ", "+", " ", 
      RowBox[{"y1", " ", "w2"}], " ", "+", " ", 
      RowBox[{"z1", " ", "x2"}]}], ",", "\n", "        ", 
     RowBox[{
      RowBox[{"w1", " ", "z2"}], " ", "+", " ", 
      RowBox[{"x1", " ", "y2"}], " ", "-", " ", 
      RowBox[{"y1", " ", "x2"}], " ", "+", " ", 
      RowBox[{"z1", " ", "w2"}]}]}], "\n", "    ", "]"}], " ", "//", " ", 
   "\[ScriptCapitalQ]Simplify"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354966909375*^9}, {
   3.543549834734375*^9, 3.543549836265625*^9}, 3.5435499536875*^9, 
   3.543550403578125*^9, {3.5435506776875*^9, 3.54355068640625*^9}, 
   3.54355073853125*^9, {3.543553583203125*^9, 3.54355363190625*^9}, {
   3.543925313921875*^9, 3.54392531575*^9}, {3.543926214296875*^9, 
   3.5439262155*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Non-commutative multiplication with complex numbers", "Subsubsection",
 CellChangeTimes->{{3.5435495699375*^9, 3.5435495721875*^9}, {
  3.54355037371875*^9, 3.543550382046875*^9}, {3.5435507631875*^9, 
  3.543550779*^9}, {3.5435518105625*^9, 3.54355181878125*^9}, {
  3.54355377425*^9, 3.543553781578125*^9}, {3.5435760619375*^9, 
  3.543576069140625*^9}}],

Cell[BoxData[{
 RowBox[{"Unprotect", "[", " ", "NonCommutativeMultiply", " ", "]"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"SetAttributes", "[", " ", 
    RowBox[{"NonCommutativeMultiply", ",", " ", "Listable"}], " ", "]"}], 
   "*)"}]}]}], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549669921875*^9}, {
  3.54355070425*^9, 3.5435507130625*^9}, {3.543572563890625*^9, 
  3.543572566359375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a_", " ", "?", "ScalarQ"}], " ", "**", " ", 
   RowBox[{"b_", " ", "?", "\[ScriptCapitalQ]Q"}]}], " ", ":=", " ", 
  RowBox[{"a", " ", "*", " ", "b"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549674421875*^9}, {
  3.5435534704375*^9, 3.543553471171875*^9}, {3.5435536879375*^9, 
  3.54355374778125*^9}, {3.543572392828125*^9, 3.5435724855*^9}, {
  3.54382436234375*^9, 3.54382443875*^9}, {3.543824594734375*^9, 
  3.543824618171875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a_", " ", "?", "\[ScriptCapitalQ]Q"}], " ", "**", " ", 
   RowBox[{"b_", " ", "?", "ScalarQ"}]}], " ", ":=", " ", 
  RowBox[{"a", " ", "*", " ", "b"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549674421875*^9}, {
  3.5435534704375*^9, 3.543553471171875*^9}, {3.5435536879375*^9, 
  3.54355374778125*^9}, {3.543572392828125*^9, 3.5435724855*^9}, {
  3.54382436234375*^9, 3.54382443875*^9}, {3.543824592*^9, 
  3.543824621265625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"x_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"y_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"z_", " ", "?", "ScalarQ"}]}], " ", "}"}], " ", "**", " ", 
   RowBox[{"q_", " ", "?", "\[ScriptCapitalQ]Q"}]}], " ", ":=", " ", "\n", 
  "    ", 
  RowBox[{
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"0", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], " ", "]"}], 
   " ", "**", " ", "q"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549674421875*^9}, {
  3.5435534704375*^9, 3.543553471171875*^9}, {3.5435536879375*^9, 
  3.54355374778125*^9}, {3.543572392828125*^9, 3.54357251625*^9}, {
  3.543824458296875*^9, 3.543824461875*^9}, {3.543926294703125*^9, 
  3.543926298578125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q_", " ", "?", "\[ScriptCapitalQ]Q"}], " ", "**", " ", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"x_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"y_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"z_", " ", "?", "ScalarQ"}]}], " ", "}"}]}], " ", ":=", " ", 
  "\n", "    ", 
  RowBox[{"q", " ", "**", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"0", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], " ", 
    "]"}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549674421875*^9}, {
  3.5435534704375*^9, 3.543553471171875*^9}, {3.5435536879375*^9, 
  3.54355374778125*^9}, {3.543572392828125*^9, 3.5435725206875*^9}, {
  3.543824463828125*^9, 3.54382446753125*^9}, {3.54392629171875*^9, 
  3.54392629965625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"w_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"x_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"y_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"z_", " ", "?", "ScalarQ"}]}], " ", "}"}], " ", "**", " ", 
   RowBox[{"q_", " ", "?", "\[ScriptCapitalQ]Q"}]}], " ", ":=", " ", "\n", 
  "    ", 
  RowBox[{
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"w", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], " ", "]"}], 
   " ", "**", " ", "q"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549674421875*^9}, {
  3.5435534704375*^9, 3.543553471171875*^9}, {3.5435536879375*^9, 
  3.54355374778125*^9}, {3.543572392828125*^9, 3.54357251625*^9}, {
  3.543824458296875*^9, 3.543824461875*^9}, {3.543926227*^9, 
  3.5439262336875*^9}, {3.543926288515625*^9, 3.543926300515625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q_", " ", "?", "\[ScriptCapitalQ]Q"}], " ", "**", " ", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"w_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"x_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"y_", " ", "?", "ScalarQ"}], ",", " ", 
     RowBox[{"z_", " ", "?", "ScalarQ"}]}], " ", "}"}]}], " ", ":=", " ", 
  "\n", "    ", 
  RowBox[{"q", " ", "**", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"w", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], " ", 
    "]"}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549674421875*^9}, {
  3.5435534704375*^9, 3.543553471171875*^9}, {3.5435536879375*^9, 
  3.54355374778125*^9}, {3.543572392828125*^9, 3.5435725206875*^9}, {
  3.543824463828125*^9, 3.54382446753125*^9}, {3.543926237328125*^9, 
  3.543926243265625*^9}, {3.543926284671875*^9, 3.543926302328125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w_", " ", "?", "ScalarQ"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x_", " ", "?", "ScalarQ"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"y_", " ", "?", "ScalarQ"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"z_", " ", "?", "ScalarQ"}], "}"}]}], " ", "}"}], " ", "**", 
   " ", 
   RowBox[{"q_", " ", "?", "\[ScriptCapitalQ]Q"}]}], " ", ":=", "\n", "    ", 
  RowBox[{
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"w", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], " ", "]"}], 
   " ", "**", " ", "q"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549674421875*^9}, {
  3.5435534704375*^9, 3.543553471171875*^9}, {3.5435536879375*^9, 
  3.54355374778125*^9}, {3.543572392828125*^9, 3.54357251625*^9}, {
  3.543824458296875*^9, 3.543824461875*^9}, {3.543926227*^9, 
  3.54392630334375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q_", " ", "?", "\[ScriptCapitalQ]Q"}], " ", "**", " ", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w_", " ", "?", "ScalarQ"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x_", " ", "?", "ScalarQ"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"y_", " ", "?", "ScalarQ"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"z_", " ", "?", "ScalarQ"}], "}"}]}], " ", "}"}]}], " ", ":=", 
  " ", "\n", "    ", 
  RowBox[{"q", " ", "**", " ", 
   RowBox[{"\[ScriptCapitalQ]", "[", " ", 
    RowBox[{"w", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], " ", 
    "]"}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549674421875*^9}, {
  3.5435534704375*^9, 3.543553471171875*^9}, {3.5435536879375*^9, 
  3.54355374778125*^9}, {3.543572392828125*^9, 3.5435725206875*^9}, {
  3.543824463828125*^9, 3.54382446753125*^9}, {3.543926237328125*^9, 
  3.543926243265625*^9}, {3.543926314453125*^9, 3.543926325921875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", " ", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{"a_:", " ", "1"}], " ", ")"}], " ", "*", " ", 
     RowBox[{"Complex", "[", " ", 
      RowBox[{"b_", ",", " ", "c_"}], " ", "]"}]}], " ", ")"}], " ", "**", 
   " ", 
   RowBox[{"(", " ", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{"x_:", " ", "1"}], " ", ")"}], " ", "*", " ", 
     RowBox[{"Complex", "[", " ", 
      RowBox[{"y_", ",", " ", "z_"}], " ", "]"}]}], " ", ")"}]}], " ", ":=", 
  "\n", "    ", 
  RowBox[{
   RowBox[{"a", " ", "b", " ", "x", " ", "y"}], " ", "-", " ", 
   RowBox[{"a", " ", "c", " ", "x", " ", "z"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"a", " ", "c", " ", "x", " ", "y"}], " ", "+", " ", 
      RowBox[{"a", " ", "b", " ", "x", " ", "z"}]}], " ", ")"}], " ", 
    "\[ImaginaryI]"}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.543549672234375*^9}, 
   3.54355344653125*^9, {3.543553637171875*^9, 3.54355368309375*^9}, {
   3.54355379375*^9, 3.543553810359375*^9}, {3.543926307234375*^9, 
   3.543926307734375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", " ", 
    RowBox[{"x_", " ", "+", " ", "y_"}], " ", ")"}], " ", "**", " ", "a_"}], 
  " ", ":=", " ", 
  RowBox[{
   RowBox[{"(", " ", 
    RowBox[{"x", " ", "**", " ", "a"}], " ", ")"}], " ", "+", " ", 
   RowBox[{"(", " ", 
    RowBox[{"y", " ", "**", " ", "a"}], " ", ")"}]}]}], "\n", 
 RowBox[{
  RowBox[{"a_", " ", "**", " ", 
   RowBox[{"(", 
    RowBox[{"x_", " ", "+", " ", "y_"}], ")"}]}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"(", " ", 
    RowBox[{"a", " ", "**", " ", "x"}], " ", ")"}], " ", "+", " ", 
   RowBox[{"(", " ", 
    RowBox[{"a", " ", "**", " ", "y"}], " ", ")"}]}]}]}], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549674421875*^9}, {
  3.5435534704375*^9, 3.543553471171875*^9}, {3.5435536879375*^9, 
  3.54355374778125*^9}, {3.543572392828125*^9, 3.5435724855*^9}, {
  3.54382436234375*^9, 3.543824435609375*^9}}],

Cell[BoxData[
 RowBox[{"Protect", "[", " ", "NonCommutativeMultiply", " ", "]"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.54354967528125*^9}, {
  3.543553762265625*^9, 3.543553763296875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Math Functions", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354970815625*^9}, 
   3.543549861953125*^9, 3.543550067828125*^9, {3.54355110209375*^9, 
   3.543551104859375*^9}, {3.54355122759375*^9, 3.543551256*^9}, {
   3.543551319578125*^9, 3.543551320453125*^9}, {3.5435541044375*^9, 
   3.543554117609375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"extfunc", "[", " ", 
   RowBox[{"func_", ",", " ", "a_", ",", " ", "b_"}], " ", "]"}], " ", ":=", 
  "\n", "    ", 
  RowBox[{
   RowBox[{"Re", "[", "b", "]"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"Abs$Im", "[", "b", "]"}], " ", "*", " ", 
    RowBox[{"AdjustedSign$Im", "[", "a", "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549744515625*^9}, {
  3.543551372921875*^9, 3.543551377484375*^9}, {3.543554188203125*^9, 
  3.54355420990625*^9}}],

Cell[BoxData[
 RowBox[{"Block", "[", "\n", "    ", 
  RowBox[{
   RowBox[{"{", " ", 
    RowBox[{"extend", ",", " ", 
     RowBox[{"$Output", " ", "=", " ", 
      RowBox[{"{", "}"}]}]}], " ", "}"}], ",", "\n", "\n", "    ", 
   RowBox[{
    RowBox[{
     RowBox[{"extend", "[", " ", "foo_", " ", "]"}], ":=", " ", 
     RowBox[{"(", "\n", "        ", 
      RowBox[{
       RowBox[{"Unprotect", "[", " ", "foo", " ", "]"}], ";", "\n", 
       "        ", 
       RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
        RowBox[{"foo", "[", " ", 
         RowBox[{"a", ":", " ", 
          RowBox[{"\[ScriptCapitalQ]", "[", " ", 
           RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], " ", "]"}], " ",
         ":=", "\n", "           ", 
        RowBox[{"extfunc", "[", " ", 
         RowBox[{"foo", ",", " ", "a", ",", " ", 
          RowBox[{"foo", "[", " ", 
           RowBox[{
            RowBox[{"Re", "[", "a", "]"}], " ", "+", " ", 
            RowBox[{
             RowBox[{"Abs$Im", "[", "a", "]"}], " ", "*", " ", 
             "\[ImaginaryI]"}]}], " ", "]"}]}], " ", "]"}]}], ";", "\n", 
       "        ", 
       RowBox[{"Protect", "[", " ", "foo", " ", "]"}], ";"}], "\n", "    ", 
      ")"}]}], ";", "\n", "\n", "    ", 
    RowBox[{"extend", " ", "/@", " ", 
     RowBox[{"{", "\n", "        ", 
      RowBox[{
      "Log", ",", "\n", "        ", "Cos", ",", " ", "Sin", ",", " ", "Tan", 
       ",", " ", "Sec", ",", " ", "Csc", ",", " ", "Cot", ",", "\n", 
       "        ", "ArcCos", ",", " ", "ArcSin", ",", " ", "ArcTan", ",", " ",
        "ArcSec", ",", " ", "ArcCsc", ",", " ", "ArcCot", ",", "\n", 
       "        ", "Cosh", ",", " ", "Sinh", ",", " ", "Tanh", ",", " ", 
       "Sech", ",", " ", "Csch", ",", " ", "Coth", ",", "\n", "        ", 
       "ArcCosh", ",", " ", "ArcSinh", ",", " ", "ArcTanh", ",", " ", 
       "ArcSech", ",", " ", "ArcCsch", ",", " ", "ArcCoth"}], "\n", "    ", 
      "}"}]}], ";"}]}], "\n", "]"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.543549746734375*^9}, {
   3.543549881890625*^9, 3.543549882484375*^9}, {3.543551381015625*^9, 
   3.543551489421875*^9}, 3.543553031640625*^9, 3.543553484984375*^9, {
   3.543554046265625*^9, 3.543554047203125*^9}, {3.543554190140625*^9, 
   3.54355419128125*^9}, {3.54355711284375*^9, 3.543557136453125*^9}, {
   3.543557230171875*^9, 3.543557245140625*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exp e^q", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354970815625*^9}, 
   3.543549861953125*^9, 3.543550067828125*^9, {3.54355110209375*^9, 
   3.543551104859375*^9}, {3.54355122759375*^9, 3.543551256*^9}, {
   3.543551319578125*^9, 3.543551320453125*^9}, {3.5435541044375*^9, 
   3.54355410490625*^9}, {3.54357614275*^9, 3.543576144265625*^9}, {
   3.543576182703125*^9, 3.543576183796875*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Exp", "[", " ", 
   RowBox[{"q", ":", " ", 
    RowBox[{"\[ScriptCapitalQ]", "[", " ", 
     RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], " ", "]"}], " ", ":=",
   "\n", "    ", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", " ", 
     RowBox[{"Re", "[", " ", "q", "]"}], " ", "]"}], " ", "*", " ", "\n", 
    "    ", 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"Cos", "[", " ", 
       RowBox[{"Abs$Im", "[", " ", "q", " ", "]"}], " ", "]"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"Sin", "[", " ", 
        RowBox[{"Abs$Im", "[", " ", "q", " ", "]"}], " ", "]"}], " ", "*", 
       " ", 
       RowBox[{"Sign$Im", "[", " ", "q", "]"}]}]}], " ", ")"}]}], " ", "//", 
   " ", "\[ScriptCapitalQ]Simplify"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.543549741328125*^9}, {
   3.543549880890625*^9, 3.543549881421875*^9}, 3.543549946109375*^9, {
   3.543553068953125*^9, 3.54355311196875*^9}, {3.54355418425*^9, 
   3.543554208265625*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Power", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.543549751578125*^9}, 
   3.54354988303125*^9, {3.543551519078125*^9, 3.543551521046875*^9}, 
   3.543551897171875*^9}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Power", "[", " ", 
   RowBox[{
    RowBox[{"q", ":", " ", 
     RowBox[{"\[ScriptCapitalQ]", "[", " ", 
      RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], ",", " ", "0"}], " ",
    "]"}], " ", ":=", "\n", "    ", "1"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549754859375*^9}, {
  3.543549883765625*^9, 3.54354988425*^9}, {3.54355150740625*^9, 
  3.543551547390625*^9}, {3.543557246703125*^9, 3.54355724728125*^9}, {
  3.5435617630625*^9, 3.543561773875*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Power", "[", " ", 
   RowBox[{
    RowBox[{"q", ":", " ", 
     RowBox[{"\[ScriptCapitalQ]", "[", " ", 
      RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], ",", " ", "1"}], " ",
    "]"}], " ", ":=", "\n", "    ", "q"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.543549754859375*^9}, {
  3.543549883765625*^9, 3.54354988425*^9}, {3.54355150740625*^9, 
  3.543551547390625*^9}, {3.543557246703125*^9, 3.54355724728125*^9}, {
  3.543559457453125*^9, 3.543559460109375*^9}, {3.543561764078125*^9, 
  3.5435617775*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Power", "[", " ", 
   RowBox[{
    RowBox[{"q", ":", " ", 
     RowBox[{"\[ScriptCapitalQ]", "[", " ", 
      RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], ",", " ", 
    RowBox[{"-", "1"}]}], " ", "]"}], " ", ":=", "\n", "    ", 
  RowBox[{
   RowBox[{"Conjugate", "[", "q", "]"}], " ", "**", " ", 
   RowBox[{"(", " ", 
    RowBox[{"1", " ", "/", " ", 
     RowBox[{"SqNorm", "[", "q", "]"}]}], " ", ")"}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354975640625*^9}, {
   3.54354988553125*^9, 3.543549885953125*^9}, {3.543551564890625*^9, 
   3.543551583203125*^9}, {3.543554077546875*^9, 3.54355408284375*^9}, {
   3.5435572488125*^9, 3.543557249421875*^9}, 3.5435617650625*^9, {
   3.543816336828125*^9, 3.543816337578125*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Power", "[", " ", 
   RowBox[{
    RowBox[{"q", ":", " ", 
     RowBox[{"\[ScriptCapitalQ]", "[", " ", 
      RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], ",", " ", "n_"}], 
   " ", "]"}], " ", ":=", "\n", "    ", 
  RowBox[{
   RowBox[{"q", " ", "**", " ", 
    RowBox[{"Power", "[", " ", 
     RowBox[{"q", ",", " ", 
      RowBox[{"n", " ", "-", " ", "1"}]}], " ", "]"}]}], " ", "/;", " ", 
   RowBox[{
    RowBox[{"n", " ", ">", " ", "1"}], " ", "\[And]", " ", 
    RowBox[{"n", " ", "\[Element]", " ", "Integers"}]}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.5435497555625*^9}, {
   3.54354988471875*^9, 3.543549885125*^9}, {3.5435515344375*^9, 
   3.543551561*^9}, {3.543557247796875*^9, 3.54355724834375*^9}, 
   3.543557431875*^9, 3.543561766078125*^9, {3.543684874671875*^9, 
   3.543684917296875*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Power", "[", " ", 
   RowBox[{
    RowBox[{"q", ":", " ", 
     RowBox[{"\[ScriptCapitalQ]", "[", " ", 
      RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], ",", " ", "n_"}], 
   " ", "]"}], " ", ":=", "\n", "    ", 
  RowBox[{
   RowBox[{"Power", "[", " ", 
    RowBox[{
     RowBox[{"1", "/", "q"}], ",", " ", 
     RowBox[{"-", "n"}]}], " ", "]"}], " ", "/;", " ", 
   RowBox[{
    RowBox[{"n", " ", "<", " ", "0"}], " ", "\[And]", " ", 
    RowBox[{"n", " ", "!=", " ", 
     RowBox[{"-", "1"}]}]}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.5435497555625*^9}, {
   3.54354988471875*^9, 3.543549885125*^9}, {3.5435515344375*^9, 
   3.543551561*^9}, {3.543557247796875*^9, 3.54355724834375*^9}, 
   3.543557431875*^9, 3.543561766078125*^9}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Power", "[", " ", 
   RowBox[{
    RowBox[{"q", ":", " ", 
     RowBox[{"\[ScriptCapitalQ]", "[", " ", 
      RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], ",", " ", "n_"}], 
   " ", "]"}], " ", ":=", "\n", 
  RowBox[{
   RowBox[{"Module", "[", "\n", "  ", 
    RowBox[{
     RowBox[{"{", "\n", "    ", 
      RowBox[{
       RowBox[{"\[Mu]", " ", "=", " ", 
        RowBox[{"Abs", "[", " ", "q", " ", "]"}]}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"modulus", " ", "of", " ", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["q", "1"], ",", 
           SubscriptBox["q", "2"], ",", 
           SubscriptBox["q", "3"], ",", 
           SubscriptBox["q", "4"]}], "}"}]}], " ", "*)"}], "\n", "    ", 
       RowBox[{"re", " ", "=", " ", 
        RowBox[{"Re", "[", " ", "q", " ", "]"}]}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"scalar", " ", "part", " ", "re"}], " ", "=", " ", 
         RowBox[{"{", 
          SubscriptBox["q", "1"], "}"}]}], " ", "*)"}], "\n", "    ", 
       RowBox[{"im", " ", "=", " ", 
        RowBox[{"Abs$Im", "[", " ", "q", " ", "]"}]}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "modulus", " ", "of", " ", "vector", " ", "part", " ", "im"}], " ", 
         "=", " ", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["q", "2"], ",", 
           SubscriptBox["q", "3"], ",", 
           SubscriptBox["q", "4"]}], "}"}]}], " ", "*)"}], "\n", "    ", 
       "\[Theta]", ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Angle", " ", "between", " ", "vector", " ", "im", " ", "and", " ", 
         "scalar", " ", "re"}], " ", "*)"}], "\n", "    ", 
       RowBox[{"\[Phi]", " ", "=", " ", "0"}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Angle", " ", "between", " ", 
         SubscriptBox["q", "2"], " ", "and", " ", "vector", " ", "part", " ", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["q", "2"], ",", 
           SubscriptBox["q", "3"], ",", 
           SubscriptBox["q", "4"]}], "}"}]}], " ", "*)"}], "\n", "    ", 
       RowBox[{"\[Gamma]", " ", "=", " ", "0"}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Angle", " ", "between", " ", 
        SubscriptBox["q", "3"], " ", "and", " ", "subvector", " ", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["q", "3"], ",", 
          SubscriptBox["q", "4"]}], "}"}]}], " ", "*)"}], "\n", "  ", "}"}], 
     ",", "\n", "\n", "  ", 
     RowBox[{
      RowBox[{"\[Theta]", " ", "=", " ", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{"re", " ", "=!=", " ", "0"}], ",", " ", "\n", "        ", 
         RowBox[{"(*", " ", "Then", " ", "*)"}], " ", 
         RowBox[{"ArcTan", "[", " ", 
          RowBox[{"im", " ", "/", " ", "re"}], " ", "]"}], ",", "\n", 
         "        ", 
         RowBox[{"(*", " ", "Else", " ", "*)"}], " ", 
         RowBox[{"\[Pi]", "/", "2"}]}], "\n", "      ", "]"}]}], ";", "\n", 
      "\n", "  ", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"im", " ", "=!=", " ", "0"}], ",", "\n", "  ", 
        RowBox[{"(*", " ", "Then", " ", "*)"}], "\n", "     ", 
        RowBox[{
         RowBox[{"\[Phi]", " ", "=", " ", 
          RowBox[{"ArcCos", "[", " ", 
           RowBox[{
            RowBox[{"q", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "/", " ", "im"}], " ", 
           "]"}]}], ";", "\n", "     ", 
         RowBox[{"\[Gamma]", " ", "=", " ", 
          RowBox[{"If", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", "=!=", " ", "0"}], ",",
             "\n", "         ", 
            RowBox[{"(*", " ", "Then", " ", "*)"}], "\n", "            ", 
            RowBox[{
             RowBox[{"ArcCos", "[", " ", 
              RowBox[{
               RowBox[{"q", "[", 
                RowBox[{"[", "3", "]"}], "]"}], " ", "/", " ", 
               RowBox[{"(", " ", 
                RowBox[{"im", " ", 
                 RowBox[{"Sin", "[", "\[Phi]", "]"}]}], " ", ")"}]}], " ", 
              "]"}], " ", 
             RowBox[{"Sign", "[", " ", 
              RowBox[{"q", "[", 
               RowBox[{"[", "4", "]"}], "]"}], " ", "]"}]}], ",", "\n", 
            "            ", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{"\[Pi]", "/", "2"}], " ", ")"}], " ", 
             RowBox[{"Sign", "[", " ", 
              RowBox[{"q", "[", 
               RowBox[{"[", "4", "]"}], "]"}], " ", "]"}]}]}], "\n", 
           "         ", "]"}]}]}]}], "\n", "  ", "]"}], ";", "\n", "\n", "  ", 
      RowBox[{
       RowBox[{"\[ScriptCapitalQ]", "[", "\n", "     ", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Mu]", "n"], " ", 
          RowBox[{"Cos", "[", " ", 
           RowBox[{"n", " ", "\[Theta]"}], " ", "]"}]}], " ", ",", "\n", 
         "     ", 
         RowBox[{
          SuperscriptBox["\[Mu]", "n"], " ", 
          RowBox[{"Sin", "[", " ", 
           RowBox[{"n", " ", "\[Theta]"}], " ", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], " ", ",", "\n", "     ", 
         RowBox[{
          SuperscriptBox["\[Mu]", "n"], " ", 
          RowBox[{"Sin", "[", " ", 
           RowBox[{"n", " ", "\[Theta]"}], " ", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], ",", "\n", "     ", 
         RowBox[{
          SuperscriptBox["\[Mu]", "n"], " ", 
          RowBox[{"Sin", "[", " ", 
           RowBox[{"n", " ", "\[Theta]"}], " ", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], " ", "\n", "  ", "]"}], 
       "  ", "//", " ", "\[ScriptCapitalQ]Simplify"}]}]}], "\n", "\n", "]"}], 
   " ", "/;", " ", 
   RowBox[{
    RowBox[{"ScalarQ", "[", "n", "]"}], " ", "\[And]", " ", 
    RowBox[{"n", " ", ">", " ", "0"}]}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354975778125*^9}, {
   3.54354988634375*^9, 3.54354988715625*^9}, 3.543549947421875*^9, {
   3.543551598578125*^9, 3.543551628875*^9}, {3.54355194659375*^9, 
   3.543551951109375*^9}, {3.543552129421875*^9, 3.543552289015625*^9}, {
   3.5435524125*^9, 3.54355244784375*^9}, {3.543557250015625*^9, 
   3.543557251671875*^9}, 3.543557437078125*^9, {3.543557966125*^9, 
   3.543557966265625*^9}, {3.54356039828125*^9, 3.543560432375*^9}, {
   3.543560466234375*^9, 3.543560534796875*^9}, {3.54356072959375*^9, 
   3.543560938*^9}, {3.54356097896875*^9, 3.5435612781875*^9}, {
   3.543561500953125*^9, 3.543561530375*^9}, {3.543561579375*^9, 
   3.543561675328125*^9}, {3.54356171265625*^9, 3.543561767109375*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Power e^q", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354970815625*^9}, 
   3.543549861953125*^9, 3.543550067828125*^9, {3.54355110209375*^9, 
   3.543551104859375*^9}, {3.54355122759375*^9, 3.543551256*^9}, {
   3.543551319578125*^9, 3.543551320453125*^9}, {3.5435541044375*^9, 
   3.54355410490625*^9}, {3.54357614275*^9, 3.543576144265625*^9}, {
   3.543576182703125*^9, 3.543576183796875*^9}, {3.543576281234375*^9, 
   3.543576295359375*^9}, {3.543576335015625*^9, 3.543576336078125*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Power", "[", " ", 
   RowBox[{"E", ",", " ", 
    RowBox[{"q", ":", " ", 
     RowBox[{"\[ScriptCapitalQ]", "[", " ", 
      RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}]}], " ", "]"}], " ", ":=",
   "\n", "    ", 
  RowBox[{"Exp", "[", " ", "q", " ", "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.54354975865625*^9}, {
  3.543549887609375*^9, 3.543549888484375*^9}, {3.54355163828125*^9, 
  3.5435516526875*^9}, {3.5435519273125*^9, 3.54355192746875*^9}, {
  3.54355725215625*^9, 3.543557253046875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sqrt", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.54354970815625*^9}, 
   3.543549861953125*^9, 3.543550067828125*^9, {3.54355110209375*^9, 
   3.543551104859375*^9}, {3.54355122759375*^9, 3.543551256*^9}, {
   3.543551319578125*^9, 3.543551320453125*^9}, {3.5435541044375*^9, 
   3.54355410490625*^9}, {3.54357614275*^9, 3.543576144265625*^9}, {
   3.543576182703125*^9, 3.543576183796875*^9}, {3.543576277625*^9, 
   3.543576278515625*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Sqrt", "[", " ", 
   RowBox[{"q", ":", " ", 
    RowBox[{"\[ScriptCapitalQ]", "[", " ", 
     RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], " ", "]"}], " ", ":=",
   "\n", "    ", 
  RowBox[{"Power", "[", " ", 
   RowBox[{"q", ",", " ", 
    RowBox[{"1", "/", "2"}]}], " ", "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.543549761828125*^9}, {
   3.54354988903125*^9, 3.543549889578125*^9}, {3.543551655328125*^9, 
   3.5435516668125*^9}, {3.543557253875*^9, 3.54355725446875*^9}, 
   3.543561758390625*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Right Divide", "Subsubsection",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.543549751578125*^9}, 
   3.54354988303125*^9, {3.543551519078125*^9, 3.543551521046875*^9}, {
   3.543551897171875*^9, 3.543551914234375*^9}, {3.54355728096875*^9, 
   3.5435572816875*^9}}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"Divide", "[", " ", 
   RowBox[{
    RowBox[{"left", ":", " ", 
     RowBox[{"\[ScriptCapitalQ]", "[", " ", 
      RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], ",", " ", 
    RowBox[{"right", " ", ":", " ", 
     RowBox[{"\[ScriptCapitalQ]", "[", " ", 
      RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}]}], " ", "]"}], " ", ":=",
   "\n", "    ", 
  RowBox[{"left", " ", "**", " ", 
   RowBox[{"(", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Conjugate", "[", "right", "]"}], " ", "**", " ", "1"}], "/", 
     RowBox[{"SqNorm", "[", "right", "]"}]}], " ", ")"}]}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
  3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
  3.543549171984375*^9}, {3.543549630515625*^9, 3.54354976553125*^9}, {
  3.543549890625*^9, 3.54354989153125*^9}, {3.543551670578125*^9, 
  3.543551704515625*^9}, {3.543557255296875*^9, 3.543557255875*^9}, {
  3.543557302875*^9, 3.543557303828125*^9}, {3.5435617528125*^9, 
  3.543561754765625*^9}, {3.543816340265625*^9, 3.543816341078125*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simplification ", "Subsubsection",
 CellChangeTimes->{{3.5435495699375*^9, 3.5435495721875*^9}, {
   3.54355037371875*^9, 3.543550375203125*^9}, {3.54355174671875*^9, 
   3.543551748640625*^9}, 3.54355178290625*^9}],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalQ]", " ", "/:", " ", 
  RowBox[{"\[ScriptCapitalQ]Simplify", "[", " ", 
   RowBox[{"q", ":", " ", 
    RowBox[{"\[ScriptCapitalQ]", "[", " ", 
     RowBox[{"__", " ", "?", "ScalarQ"}], " ", "]"}]}], " ", "]"}], " ", ":=",
   "\n", "  ", 
  RowBox[{"Simplify", "[", " ", 
   RowBox[{"TrigExpand", " ", "/@", " ", "q"}], " ", "]"}]}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.543549766984375*^9}, 
   3.543549891953125*^9, {3.543549948640625*^9, 3.5435499498125*^9}, {
   3.54355172403125*^9, 3.543551739765625*^9}, {3.543557165625*^9, 
   3.543557167578125*^9}, {3.5440107928125*^9, 3.54401079353125*^9}, {
   3.54401087125*^9, 3.544010875859375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalQ]Simplify", "[", " ", "q_", " ", "]"}], " ", ":=", 
  " ", "q"}]], "Code",
 CellChangeTimes->{{3.5435489913125*^9, 3.543548996734375*^9}, {
   3.543549028484375*^9, 3.543549102*^9}, {3.54354913384375*^9, 
   3.543549171984375*^9}, {3.543549630515625*^9, 3.543549766984375*^9}, 
   3.543549891953125*^9, {3.543549948640625*^9, 3.5435499498125*^9}, {
   3.54355172403125*^9, 3.54355174425*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Pre", " ", "=", " ", "TimeIt"}], ";"}]], "Code"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Code"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Code"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{944, 762},
WindowMargins->{{17, Automatic}, {Automatic, 1}},
PrintingOptions->{"PrintingMargins"->{{54., 54.}, {42.5, 42.5}}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"UCA-Stylesheet.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 162, 2, 90, "Title"],
Cell[732, 26, 411, 5, 49, "Subtitle"],
Cell[1146, 33, 2352, 60, 193, "Code"],
Cell[CellGroupData[{
Cell[3523, 97, 32, 0, 79, "Section"],
Cell[3558, 99, 52, 1, 52, "Code"],
Cell[3613, 102, 168, 4, 52, "Code"],
Cell[3784, 108, 269, 6, 52, "Code"],
Cell[4056, 116, 356, 8, 73, "Code"],
Cell[CellGroupData[{
Cell[4437, 128, 38, 0, 43, "Subsection"],
Cell[4478, 130, 703, 12, 73, "Code"],
Cell[5184, 144, 630, 11, 73, "Code"],
Cell[5817, 157, 638, 11, 52, "Code"],
Cell[6458, 170, 602, 11, 52, "Code"],
Cell[7063, 183, 694, 12, 52, "Code"],
Cell[7760, 197, 698, 12, 52, "Code"],
Cell[8461, 211, 732, 13, 52, "Code"],
Cell[9196, 226, 608, 11, 52, "Code"],
Cell[9807, 239, 658, 11, 73, "Code"],
Cell[10468, 252, 707, 13, 52, "Code"],
Cell[11178, 267, 855, 16, 52, "Code"],
Cell[12036, 285, 323, 6, 52, "Code"],
Cell[12362, 293, 433, 7, 73, "Code"],
Cell[12798, 302, 445, 8, 73, "Code"],
Cell[13246, 312, 495, 9, 73, "Code"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13790, 327, 34, 0, 63, "Section"],
Cell[13827, 329, 150, 4, 36, "Code"],
Cell[CellGroupData[{
Cell[14002, 337, 92, 1, 45, "Subsection"],
Cell[14097, 340, 825, 17, 36, "Code"],
Cell[14925, 359, 505, 9, 36, "Code"],
Cell[15433, 370, 793, 15, 36, "Code"],
Cell[16229, 387, 546, 10, 36, "Code"],
Cell[16778, 399, 520, 9, 36, "Code"],
Cell[17301, 410, 570, 10, 36, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17908, 425, 39, 0, 45, "Subsection"],
Cell[CellGroupData[{
Cell[17972, 429, 56, 0, 35, "Subsubsection"],
Cell[18031, 431, 133, 3, 36, "Code"],
Cell[18167, 436, 2497, 56, 417, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20701, 497, 151, 2, 35, "Subsubsection"],
Cell[20855, 501, 4854, 105, 537, "Code"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25758, 612, 132, 2, 45, "Subsection"],
Cell[CellGroupData[{
Cell[25915, 618, 357, 5, 35, "Subsubsection"],
Cell[26275, 625, 1585, 32, 57, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27897, 662, 357, 5, 35, "Subsubsection"],
Cell[28257, 669, 838, 18, 77, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29132, 692, 541, 9, 35, "Subsubsection"],
Cell[29676, 703, 879, 19, 57, "Code"],
Cell[30558, 724, 5317, 117, 277, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35912, 846, 645, 9, 35, "Subsubsection"],
Cell[36560, 857, 1553, 32, 77, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38150, 894, 490, 7, 35, "Subsubsection"],
Cell[38643, 903, 738, 14, 36, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39418, 922, 579, 8, 35, "Subsubsection"],
Cell[40000, 932, 957, 18, 36, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40994, 955, 507, 7, 35, "Subsubsection"],
Cell[41504, 964, 1494, 32, 137, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43035, 1001, 491, 7, 35, "Subsubsection"],
Cell[43529, 1010, 921, 17, 36, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44487, 1032, 590, 8, 35, "Subsubsection"],
Cell[45080, 1042, 2472, 47, 297, "Code"],
Cell[47555, 1091, 1170, 21, 36, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48762, 1117, 636, 9, 35, "Subsubsection"],
Cell[49401, 1128, 2675, 61, 157, "Code"],
Cell[52079, 1191, 3006, 66, 178, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55122, 1262, 328, 5, 35, "Subsubsection"],
Cell[55453, 1269, 740, 15, 57, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56230, 1289, 376, 5, 35, "Subsubsection"],
Cell[56609, 1296, 926, 19, 57, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57572, 1320, 327, 5, 35, "Subsubsection"],
Cell[57902, 1327, 765, 14, 57, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58704, 1346, 324, 5, 35, "Subsubsection"],
Cell[59031, 1353, 830, 15, 57, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59898, 1373, 328, 5, 35, "Subsubsection"],
Cell[60229, 1380, 1724, 38, 177, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61990, 1423, 469, 7, 35, "Subsubsection"],
Cell[62462, 1432, 845, 16, 57, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63344, 1453, 527, 7, 35, "Subsubsection"],
Cell[63874, 1462, 1224, 24, 57, "Code"],
Cell[65101, 1488, 1003, 18, 57, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66141, 1511, 518, 7, 35, "Subsubsection"],
Cell[66662, 1520, 1086, 23, 57, "Code"],
Cell[67751, 1545, 759, 13, 36, "Code"],
Cell[68513, 1560, 2198, 45, 237, "Code"],
Cell[70714, 1607, 1042, 22, 67, "Code"],
Cell[71759, 1631, 728, 13, 57, "Code"],
Cell[72490, 1646, 1063, 21, 57, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73590, 1672, 164, 2, 35, "Subsubsection"],
Cell[73757, 1676, 1090, 22, 57, "Code"],
Cell[74850, 1700, 1000, 19, 57, "Code"],
Cell[75853, 1721, 880, 16, 57, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76770, 1742, 171, 2, 35, "Subsubsection"],
Cell[76944, 1746, 936, 18, 57, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77917, 1769, 257, 3, 35, "Subsubsection"],
Cell[78177, 1774, 1898, 40, 157, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80112, 1819, 362, 5, 35, "Subsubsection"],
Cell[80477, 1826, 548, 11, 57, "Code"],
Cell[81028, 1839, 637, 12, 36, "Code"],
Cell[81668, 1853, 631, 12, 36, "Code"],
Cell[82302, 1867, 934, 20, 57, "Code"],
Cell[83239, 1889, 937, 20, 57, "Code"],
Cell[84179, 1911, 1025, 21, 57, "Code"],
Cell[85207, 1934, 1038, 21, 57, "Code"],
Cell[86248, 1957, 1084, 25, 57, "Code"],
Cell[87335, 1984, 1146, 25, 57, "Code"],
Cell[88484, 2011, 1255, 31, 57, "Code"],
Cell[89742, 2044, 1039, 25, 57, "Code"],
Cell[90784, 2071, 339, 5, 36, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91160, 2081, 475, 7, 35, "Subsubsection"],
Cell[91638, 2090, 639, 14, 57, "Code"],
Cell[92280, 2106, 2514, 50, 377, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94831, 2161, 559, 8, 35, "Subsubsection"],
Cell[95393, 2171, 1181, 27, 77, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96611, 2203, 330, 5, 35, "Subsubsection"],
Cell[96944, 2210, 689, 13, 57, "Code"],
Cell[97636, 2225, 738, 14, 57, "Code"],
Cell[98377, 2241, 962, 19, 57, "Code"],
Cell[99342, 2262, 1042, 22, 57, "Code"],
Cell[100387, 2286, 971, 22, 57, "Code"],
Cell[101361, 2310, 6930, 157, 697, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108328, 2472, 657, 9, 35, "Subsubsection"],
Cell[108988, 2483, 731, 14, 57, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109756, 2502, 603, 9, 35, "Subsubsection"],
Cell[110362, 2513, 736, 15, 57, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111135, 2533, 408, 6, 35, "Subsubsection"],
Cell[111546, 2541, 1137, 23, 57, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112720, 2569, 221, 3, 35, "Subsubsection"],
Cell[112944, 2574, 838, 15, 57, "Code"],
Cell[113785, 2591, 443, 8, 36, "Code"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[114289, 2606, 30, 0, 63, "Section"],
Cell[114322, 2608, 84, 2, 36, "Code"],
Cell[114409, 2612, 68, 2, 36, "Code"],
Cell[114480, 2616, 75, 2, 36, "Code"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
